{"version":3,"sources":["../node_modules/core-js/library/modules/_global.js","../node_modules/core-js/library/modules/_core.js","../node_modules/core-js/library/modules/_a-function.js","../node_modules/core-js/library/modules/_ctx.js","../node_modules/core-js/library/modules/_is-object.js","../node_modules/core-js/library/modules/_an-object.js","../node_modules/core-js/library/modules/_fails.js","../node_modules/core-js/library/modules/_descriptors.js","../node_modules/core-js/library/modules/_dom-create.js","../node_modules/core-js/library/modules/_ie8-dom-define.js","../node_modules/core-js/library/modules/_to-primitive.js","../node_modules/core-js/library/modules/_object-dp.js","../node_modules/core-js/library/modules/_property-desc.js","../node_modules/core-js/library/modules/_hide.js","../node_modules/core-js/library/modules/_has.js","../node_modules/core-js/library/modules/_export.js","../node_modules/core-js/library/modules/_cof.js","../node_modules/core-js/library/modules/_is-array.js","../node_modules/core-js/library/modules/es6.array.is-array.js","../node_modules/core-js/library/fn/array/is-array.js","../node_modules/@babel/runtime-corejs2/core-js/array/is-array.js","../node_modules/core-js/library/modules/_iobject.js","../node_modules/core-js/library/modules/_defined.js","../node_modules/core-js/library/modules/_to-iobject.js","../node_modules/core-js/library/modules/_to-integer.js","../node_modules/core-js/library/modules/_to-length.js","../node_modules/core-js/library/modules/_to-absolute-index.js","../node_modules/core-js/library/modules/_array-includes.js","../node_modules/core-js/library/modules/_library.js","../node_modules/core-js/library/modules/_shared.js","../node_modules/core-js/library/modules/_uid.js","../node_modules/core-js/library/modules/_shared-key.js","../node_modules/core-js/library/modules/_object-keys-internal.js","../node_modules/core-js/library/modules/_enum-bug-keys.js","../node_modules/core-js/library/modules/_object-keys.js","../node_modules/core-js/library/modules/_object-dps.js","../node_modules/core-js/library/modules/_html.js","../node_modules/core-js/library/modules/_object-create.js","../node_modules/core-js/library/modules/es6.object.create.js","../node_modules/core-js/library/fn/object/create.js","../node_modules/@babel/runtime-corejs2/core-js/object/create.js","js/canvas-renderer-and-projector.js"],"names":["bgColor","THREE","SpriteCanvasMaterial","parameters","Material","call","type","color","Color","program","setValues","prototype","constructor","isSpriteCanvasMaterial","clone","material","copy","CanvasRenderer","console","log","REVISION","_this","_renderData","_elements","_lights","_projector","Projector","_canvas","canvas","undefined","document","createElement","_canvasWidth","width","_canvasHeight","height","_canvasWidthHalf","Math","floor","_canvasHeightHalf","_viewportX","_viewportY","_viewportWidth","_viewportHeight","_pixelRatio","_context","getContext","alpha","_clearColor","_clearAlpha","_contextGlobalAlpha","_contextGlobalCompositeOperation","_contextStrokeStyle","_contextFillStyle","_contextLineWidth","_contextLineCap","_contextLineJoin","_contextLineDash","_v1","_v2","_v3","_v1x","_v1y","_v2x","_v2y","_v3x","_v3y","_color","_diffuseColor","_emissiveColor","_lightColor","_patterns","_uvs","_uv1x","_uv1y","_uv2x","_uv2y","_uv3x","_uv3y","_clipBox","Box2","_clearBox","_elemBox","_ambientLight","_directionalLights","_pointLights","_vector3","Vector3","_centroid","_normal","_normalViewMatrix","Matrix3","setLineDash","domElement","autoClear","sortObjects","sortElements","info","render","vertices","faces","getContextAttributes","getPixelRatio","setPixelRatio","value","setSize","updateStyle","style","min","set","max","setViewport","x","y","setScissor","setScissorTest","setClearColor","setClearColorHex","hex","warn","getClearColor","getClearAlpha","getMaxAnisotropy","clear","isEmpty","intersect","expandByScalar","clearRect","setOpacity","setBlending","NormalBlending","setFillStyle","r","g","b","fillRect","makeEmpty","clearColor","clearDepth","clearStencil","scene","camera","isCamera","error","background","isColor","getStyle","setTransform","translate","projectScene","elements","lights","getNormalMatrix","matrixWorldInverse","calculateLights","e","el","length","element","opacity","RenderableSprite","renderSprite","RenderableLine","v1","v2","positionScreen","setFromPoints","intersectsBox","renderLine","RenderableFace","v3","z","overdraw","expand","renderFace3","union","setRGB","l","ll","light","lightColor","isAmbientLight","add","isDirectionalLight","isPointLight","calculateLight","position","normal","lightPosition","setFromMatrixPosition","matrixWorld","normalize","amount","dot","intensity","multiplyScalar","subVectors","distance","distanceTo","blending","scaleX","scale","scaleY","dist","sqrt","isSpriteMaterial","texture","map","pattern","id","version","textureToPattern","bitmap","image","ox","offset","oy","sx","repeat","sy","cx","cy","save","rotation","rotate","restore","setStrokeStyle","isPointsMaterial","size","beginPath","moveTo","lineTo","isLineBasicMaterial","setLineWidth","linewidth","setLineCap","linecap","setLineJoin","linejoin","vertexColors","VertexColors","colorStyle1","colorStyle2","grad","createLinearGradient","addColorStop","exception","isLineDashedMaterial","dashSize","gapSize","stroke","uv1","uv2","uv3","drawTriangle","isMeshLambertMaterial","isMeshPhongMaterial","isMeshStandardMaterial","emissive","FaceColors","multiply","positionWorld","divideScalar","normalModel","wireframe","strokePath","wireframeLinewidth","wireframeLinecap","wireframeLinejoin","fillPath","isMeshBasicMaterial","mapping","UVMapping","uvs","patternPath","envMap","SphericalReflectionMapping","vertexNormalsModel","applyMatrix3","isMeshNormalMaterial","addScalar","x0","y0","x1","y1","x2","y2","closePath","fill","CompressedTexture","DataTexture","complete","repeatX","wrapS","RepeatWrapping","MirroredRepeatWrapping","repeatY","wrapT","mirrorX","mirrorY","context","drawImage","createPattern","onUpdate","u0","v0","u1","u2","a","c","d","f","det","idet","offsetX","offsetY","transform","pixels","globalAlpha","globalCompositeOperation","AdditiveBlending","SubtractiveBlending","MultiplyBlending","lineWidth","lineCap","lineJoin","strokeStyle","fillStyle","RenderableObject","object","renderOrder","RenderableVertex","vertexNormalsLength","Vector2","Vector4","visible","vertex","_object","_objectCount","_objectPool","_objectPoolLength","_vertex","_vertexCount","_vertexPool","_vertexPoolLength","_face","_faceCount","_facePool","_facePoolLength","_line","_lineCount","_linePool","_linePoolLength","_sprite","_spriteCount","_spritePool","_spritePoolLength","objects","_vector4","Box3","_boundingBox","_points3","Array","_viewMatrix","Matrix4","_viewProjectionMatrix","_modelMatrix","_modelViewProjectionMatrix","_normalMatrix","_frustum","Frustum","_clippedVertex1PositionScreen","_clippedVertex2PositionScreen","projectVector","vector","project","unprojectVector","unproject","pickingRay","RenderList","normals","colors","normalMatrix","setObject","projectVertex","applyMatrix4","invW","w","pushVertex","getNextVertexInPool","pushNormal","push","pushColor","pushUv","checkTriangleVisibility","checkBackfaceCulling","pushLine","clipLine","getNextLineInPool","fromArray","pushTriangle","side","DoubleSide","getNextFaceInPool","i","arguments","uv","renderList","projectObject","Light","Mesh","Line","Points","frustumCulled","intersectsObject","addObject","Sprite","intersectsSprite","children","getNextObjectInPool","autoUpdate","updateMatrixWorld","parent","multiplyMatrices","projectionMatrix","setFromMatrix","sort","painterSort","o","ol","geometry","BufferGeometry","attributes","groups","positions","array","index","indices","group","start","count","Geometry","faceVertexUvs","isMultiMaterial","v","vl","morphTargets","morphInfluences","morphTargetInfluences","t","tl","influence","target","targetVertex","fl","face","materialIndex","FrontSide","BackSide","negate","faceVertexNormals","vertexNormals","n","nl","vertexUvs","u","step","LineSegments","pushPoint","getNextSpriteInPool","abs","line","sprite","s1","s2","alpha1","alpha2","bc1near","bc2near","bc1far","bc2far","lerp"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;;ACFA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACRA;AACA;AACA;AACA;AACA;;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC9DA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;;ACFA;;ACAA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;;;ACDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACZA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;;ACJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACbA;AACA;AACA;;ACFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzCA;AACA;AACA;AACA;;ACHA;AACA;AACA;AACA;AACA;AACA;;ACLA;;;;;;;;;;ACAA;AACA,IAAIA,OAAO,GAAG,QAAd;AACA;;;;AAIAC,KAAK,CAACC,oBAAN,GAA6B,UAAWC,UAAX,EAAwB;AAEpDF,EAAAA,KAAK,CAACG,QAAN,CAAeC,IAAf,CAAqB,IAArB;AAEA,OAAKC,IAAL,GAAY,sBAAZ;AAEA,OAAKC,KAAL,GAAa,IAAIN,KAAK,CAACO,KAAV,CAAiB,QAAjB,CAAb;;AACA,OAAKC,OAAL,GAAe,YAAY,CAAE,CAA7B;;AAEA,OAAKC,SAAL,CAAgBP,UAAhB;AAEA,CAXD;;AAaAF,KAAK,CAACC,oBAAN,CAA2BS,SAA3B,GAAuC,qBAAeV,KAAK,CAACG,QAAN,CAAeO,SAA9B,CAAvC;AACAV,KAAK,CAACC,oBAAN,CAA2BS,SAA3B,CAAqCC,WAArC,GAAmDX,KAAK,CAACC,oBAAzD;AACAD,KAAK,CAACC,oBAAN,CAA2BS,SAA3B,CAAqCE,sBAArC,GAA8D,IAA9D;;AAEAZ,KAAK,CAACC,oBAAN,CAA2BS,SAA3B,CAAqCG,KAArC,GAA6C,YAAY;AAExD,MAAIC,QAAQ,GAAG,IAAId,KAAK,CAACC,oBAAV,EAAf;AAEAa,EAAAA,QAAQ,CAACC,IAAT,CAAe,IAAf;AACAD,EAAAA,QAAQ,CAACR,KAAT,CAAeS,IAAf,CAAqB,KAAKT,KAA1B;AACAQ,EAAAA,QAAQ,CAACN,OAAT,GAAmB,KAAKA,OAAxB;AAEA,SAAOM,QAAP;AAEA,CAVD,EAYA;;;AAEAd,KAAK,CAACgB,cAAN,GAAuB,UAAWd,UAAX,EAAwB;AAE9Ce,EAAAA,OAAO,CAACC,GAAR,CAAa,sBAAb,EAAqClB,KAAK,CAACmB,QAA3C;AAEAjB,EAAAA,UAAU,GAAGA,UAAU,IAAI,EAA3B;;AAEA,MAAIkB,KAAK,GAAG,IAAZ;AAAA,MACCC,WADD;AAAA,MACcC,SADd;AAAA,MACyBC,OADzB;AAAA,MAECC,UAAU,GAAG,IAAIxB,KAAK,CAACyB,SAAV,EAFd;AAAA,MAICC,OAAO,GAAGxB,UAAU,CAACyB,MAAX,KAAsBC,SAAtB,GACL1B,UAAU,CAACyB,MADN,GAELE,QAAQ,CAACC,aAAT,CAAwB,QAAxB,CANN;AAAA,MAQCC,YAAY,GAAGL,OAAO,CAACM,KARxB;AAAA,MASCC,aAAa,GAAGP,OAAO,CAACQ,MATzB;AAAA,MAUCC,gBAAgB,GAAGC,IAAI,CAACC,KAAL,CAAYN,YAAY,GAAG,CAA3B,CAVpB;AAAA,MAWCO,iBAAiB,GAAGF,IAAI,CAACC,KAAL,CAAYJ,aAAa,GAAG,CAA5B,CAXrB;AAAA,MAaCM,UAAU,GAAG,CAbd;AAAA,MAcCC,UAAU,GAAG,CAdd;AAAA,MAeCC,cAAc,GAAGV,YAflB;AAAA,MAgBCW,eAAe,GAAGT,aAhBnB;AAAA,MAkBCU,WAAW,GAAG,CAlBf;AAAA,MAoBCC,QAAQ,GAAGlB,OAAO,CAACmB,UAAR,CAAoB,IAApB,EAA0B;AACpCC,IAAAA,KAAK,EAAE5C,UAAU,CAAC4C,KAAX,KAAqB;AADQ,GAA1B,CApBZ;AAAA,MAwBCC,WAAW,GAAG,IAAI/C,KAAK,CAACO,KAAV,CAAiBR,OAAjB,CAxBf;AAAA,MAyBCiD,WAAW,GAAG9C,UAAU,CAAC4C,KAAX,KAAqB,IAArB,GAA4B,CAA5B,GAAgC,CAzB/C;AAAA,MA2BCG,mBAAmB,GAAG,CA3BvB;AAAA,MA4BCC,gCAAgC,GAAG,CA5BpC;AAAA,MA6BCC,mBAAmB,GAAG,IA7BvB;AAAA,MA8BCC,iBAAiB,GAAG,IA9BrB;AAAA,MA+BCC,iBAAiB,GAAG,IA/BrB;AAAA,MAgCCC,eAAe,GAAG,IAhCnB;AAAA,MAiCCC,gBAAgB,GAAG,IAjCpB;AAAA,MAkCCC,gBAAgB,GAAG,EAlCpB;AAAA,MAoCCC,GApCD;AAAA,MAoCMC,GApCN;AAAA,MAoCWC,GApCX;AAAA,MAsCCC,IAtCD;AAAA,MAsCOC,IAtCP;AAAA,MAsCaC,IAtCb;AAAA,MAsCmBC,IAtCnB;AAAA,MAsCyBC,IAtCzB;AAAA,MAsC+BC,IAtC/B;AAAA,MAwCCC,MAAM,GAAG,IAAIlE,KAAK,CAACO,KAAV,EAxCV;AAAA,MA0CC4D,aAAa,GAAG,IAAInE,KAAK,CAACO,KAAV,EA1CjB;AAAA,MA2CC6D,cAAc,GAAG,IAAIpE,KAAK,CAACO,KAAV,EA3ClB;AAAA,MA6CC8D,WAAW,GAAG,IAAIrE,KAAK,CAACO,KAAV,EA7Cf;AAAA,MA+CC+D,SAAS,GAAG,EA/Cb;AAAA,MAiDCC,IAjDD;AAAA,MAkDCC,KAlDD;AAAA,MAkDQC,KAlDR;AAAA,MAkDeC,KAlDf;AAAA,MAkDsBC,KAlDtB;AAAA,MAkD6BC,KAlD7B;AAAA,MAkDoCC,KAlDpC;AAAA,MAoDCC,QAAQ,GAAG,IAAI9E,KAAK,CAAC+E,IAAV,EApDZ;AAAA,MAqDCC,SAAS,GAAG,IAAIhF,KAAK,CAAC+E,IAAV,EArDb;AAAA,MAsDCE,QAAQ,GAAG,IAAIjF,KAAK,CAAC+E,IAAV,EAtDZ;AAAA,MAwDCG,aAAa,GAAG,IAAIlF,KAAK,CAACO,KAAV,EAxDjB;AAAA,MAyDC4E,kBAAkB,GAAG,IAAInF,KAAK,CAACO,KAAV,EAzDtB;AAAA,MA0DC6E,YAAY,GAAG,IAAIpF,KAAK,CAACO,KAAV,EA1DhB;AAAA,MA4DC8E,QAAQ,GAAG,IAAIrF,KAAK,CAACsF,OAAV,EA5DZ;AAAA,MA4DiC;AAChCC,EAAAA,SAAS,GAAG,IAAIvF,KAAK,CAACsF,OAAV,EA7Db;AAAA,MA8DCE,OAAO,GAAG,IAAIxF,KAAK,CAACsF,OAAV,EA9DX;AAAA,MA+DCG,iBAAiB,GAAG,IAAIzF,KAAK,CAAC0F,OAAV,EA/DrB;AAiEA;;;;;;AAOA;;;AAEA,MAAK9C,QAAQ,CAAC+C,WAAT,KAAyB/D,SAA9B,EAA0C;AAEzCgB,IAAAA,QAAQ,CAAC+C,WAAT,GAAuB,YAAY,CAAE,CAArC;AAEA;;AAED,OAAKC,UAAL,GAAkBlE,OAAlB;AAEA,OAAKmE,SAAL,GAAiB,IAAjB;AACA,OAAKC,WAAL,GAAmB,IAAnB;AACA,OAAKC,YAAL,GAAoB,IAApB;AAEA,OAAKC,IAAL,GAAY;AAEXC,IAAAA,MAAM,EAAE;AAEPC,MAAAA,QAAQ,EAAE,CAFH;AAGPC,MAAAA,KAAK,EAAE;AAHA;AAFG,GAAZ,CA5F8C,CAuG9C;;AAEA,OAAKtD,UAAL,GAAkB,YAAY;AAE7B,WAAOD,QAAP;AAEA,GAJD;;AAMA,OAAKwD,oBAAL,GAA4B,YAAY;AAEvC,WAAOxD,QAAQ,CAACwD,oBAAT,EAAP;AAEA,GAJD;;AAMA,OAAKC,aAAL,GAAqB,YAAY;AAEhC,WAAO1D,WAAP;AAEA,GAJD;;AAMA,OAAK2D,aAAL,GAAqB,UAAWC,KAAX,EAAmB;AAEvC,QAAKA,KAAK,KAAK3E,SAAf,EAA2Be,WAAW,GAAG4D,KAAd;AAE3B,GAJD;;AAMA,OAAKC,OAAL,GAAe,UAAWxE,KAAX,EAAkBE,MAAlB,EAA0BuE,WAA1B,EAAwC;AAEtD1E,IAAAA,YAAY,GAAGC,KAAK,GAAGW,WAAvB;AACAV,IAAAA,aAAa,GAAGC,MAAM,GAAGS,WAAzB;AAEAjB,IAAAA,OAAO,CAACM,KAAR,GAAgBD,YAAhB;AACAL,IAAAA,OAAO,CAACQ,MAAR,GAAiBD,aAAjB;AAEAE,IAAAA,gBAAgB,GAAGC,IAAI,CAACC,KAAL,CAAYN,YAAY,GAAG,CAA3B,CAAnB;AACAO,IAAAA,iBAAiB,GAAGF,IAAI,CAACC,KAAL,CAAYJ,aAAa,GAAG,CAA5B,CAApB;;AAEA,QAAKwE,WAAW,KAAK,KAArB,EAA6B;AAE5B/E,MAAAA,OAAO,CAACgF,KAAR,CAAc1E,KAAd,GAAsBA,KAAK,GAAG,IAA9B;AACAN,MAAAA,OAAO,CAACgF,KAAR,CAAcxE,MAAd,GAAuBA,MAAM,GAAG,IAAhC;AAEA;;AAED4C,IAAAA,QAAQ,CAAC6B,GAAT,CAAaC,GAAb,CAAkB,CAAEzE,gBAApB,EAAsC,CAAEG,iBAAxC;;AACAwC,IAAAA,QAAQ,CAAC+B,GAAT,CAAaD,GAAb,CAAoBzE,gBAApB,EAAwCG,iBAAxC;;AAEA0C,IAAAA,SAAS,CAAC2B,GAAV,CAAcC,GAAd,CAAmB,CAAEzE,gBAArB,EAAuC,CAAEG,iBAAzC;;AACA0C,IAAAA,SAAS,CAAC6B,GAAV,CAAcD,GAAd,CAAqBzE,gBAArB,EAAyCG,iBAAzC;;AAEAW,IAAAA,mBAAmB,GAAG,CAAtB;AACAC,IAAAA,gCAAgC,GAAG,CAAnC;AACAC,IAAAA,mBAAmB,GAAG,IAAtB;AACAC,IAAAA,iBAAiB,GAAG,IAApB;AACAC,IAAAA,iBAAiB,GAAG,IAApB;AACAC,IAAAA,eAAe,GAAG,IAAlB;AACAC,IAAAA,gBAAgB,GAAG,IAAnB;AAEA,SAAKuD,WAAL,CAAkB,CAAlB,EAAqB,CAArB,EAAwB9E,KAAxB,EAA+BE,MAA/B;AAEA,GAlCD;;AAoCA,OAAK4E,WAAL,GAAmB,UAAWC,CAAX,EAAcC,CAAd,EAAiBhF,KAAjB,EAAwBE,MAAxB,EAAiC;AAEnDK,IAAAA,UAAU,GAAGwE,CAAC,GAAGpE,WAAjB;AACAH,IAAAA,UAAU,GAAGwE,CAAC,GAAGrE,WAAjB;AAEAF,IAAAA,cAAc,GAAGT,KAAK,GAAGW,WAAzB;AACAD,IAAAA,eAAe,GAAGR,MAAM,GAAGS,WAA3B;AAEA,GARD;;AAUA,OAAKsE,UAAL,GAAkB,YAAY,CAAE,CAAhC;;AACA,OAAKC,cAAL,GAAsB,YAAY,CAAE,CAApC;;AAEA,OAAKC,aAAL,GAAqB,UAAW7G,KAAX,EAAkBwC,KAAlB,EAA0B;AAE9CC,IAAAA,WAAW,CAAC6D,GAAZ,CAAiBtG,KAAjB;;AACA0C,IAAAA,WAAW,GAAGF,KAAK,KAAKlB,SAAV,GAAsBkB,KAAtB,GAA8B,CAA5C;;AAEAkC,IAAAA,SAAS,CAAC2B,GAAV,CAAcC,GAAd,CAAmB,CAAEzE,gBAArB,EAAuC,CAAEG,iBAAzC;;AACA0C,IAAAA,SAAS,CAAC6B,GAAV,CAAcD,GAAd,CAAqBzE,gBAArB,EAAyCG,iBAAzC;AAEA,GARD;;AAUA,OAAK8E,gBAAL,GAAwB,UAAWC,GAAX,EAAgBvE,KAAhB,EAAwB;AAE/C7B,IAAAA,OAAO,CAACqG,IAAR,CAAc,2FAAd;AACA,SAAKH,aAAL,CAAoBE,GAApB,EAAyBvE,KAAzB;AAEA,GALD;;AAOA,OAAKyE,aAAL,GAAqB,YAAY;AAEhC,WAAOxE,WAAP;AAEA,GAJD;;AAMA,OAAKyE,aAAL,GAAqB,YAAY;AAEhC,WAAOxE,WAAP;AAEA,GAJD;;AAMA,OAAKyE,gBAAL,GAAwB,YAAY;AAEnC,WAAO,CAAP;AAEA,GAJD;;AAMA,OAAKC,KAAL,GAAa,YAAY;AAExB,QAAK1C,SAAS,CAAC2C,OAAV,OAAwB,KAA7B,EAAqC;AAEpC3C,MAAAA,SAAS,CAAC4C,SAAV,CAAqB9C,QAArB;;AACAE,MAAAA,SAAS,CAAC6C,cAAV,CAA0B,CAA1B;;AAEA7C,MAAAA,SAAS,CAAC2B,GAAV,CAAcI,CAAd,GAAoB/B,SAAS,CAAC2B,GAAV,CAAcI,CAAd,GAAkB5E,gBAAtC;AACA6C,MAAAA,SAAS,CAAC2B,GAAV,CAAcK,CAAd,GAAkB,CAAEhC,SAAS,CAAC2B,GAAV,CAAcK,CAAhB,GAAoB1E,iBAAtC,CANoC,CAMsB;;AAC1D0C,MAAAA,SAAS,CAAC6B,GAAV,CAAcE,CAAd,GAAoB/B,SAAS,CAAC6B,GAAV,CAAcE,CAAd,GAAkB5E,gBAAtC;AACA6C,MAAAA,SAAS,CAAC6B,GAAV,CAAcG,CAAd,GAAkB,CAAEhC,SAAS,CAAC6B,GAAV,CAAcG,CAAhB,GAAoB1E,iBAAtC,CARoC,CAQsB;;AAE1D,UAAKU,WAAW,GAAG,CAAnB,EAAuB;AAEtBJ,QAAAA,QAAQ,CAACkF,SAAT,CACC9C,SAAS,CAAC2B,GAAV,CAAcI,CAAd,GAAkB,CADnB,EAEC/B,SAAS,CAAC6B,GAAV,CAAcG,CAAd,GAAkB,CAFnB,EAGGhC,SAAS,CAAC6B,GAAV,CAAcE,CAAd,GAAkB/B,SAAS,CAAC2B,GAAV,CAAcI,CAAlC,GAAwC,CAHzC,EAIG/B,SAAS,CAAC2B,GAAV,CAAcK,CAAd,GAAkBhC,SAAS,CAAC6B,GAAV,CAAcG,CAAlC,GAAwC,CAJzC;AAOA;;AAED,UAAKhE,WAAW,GAAG,CAAnB,EAAuB;AAEtB+E,QAAAA,UAAU,CAAE,CAAF,CAAV;AACAC,QAAAA,WAAW,CAAEhI,KAAK,CAACiI,cAAR,CAAX;AAEAC,QAAAA,YAAY,CAAE,UAAU9F,IAAI,CAACC,KAAL,CAAYU,WAAW,CAACoF,CAAZ,GAAgB,GAA5B,CAAV,GAA8C,GAA9C,GAAoD/F,IAAI,CAACC,KAAL,CAAYU,WAAW,CAACqF,CAAZ,GAAgB,GAA5B,CAApD,GAAwF,GAAxF,GAA8FhG,IAAI,CAACC,KAAL,CAAYU,WAAW,CAACsF,CAAZ,GAAgB,GAA5B,CAA9F,GAAkI,GAAlI,GAAwIrF,WAAxI,GAAsJ,GAAxJ,CAAZ;;AAEAJ,QAAAA,QAAQ,CAAC0F,QAAT,CACCtD,SAAS,CAAC2B,GAAV,CAAcI,CAAd,GAAkB,CADnB,EAEC/B,SAAS,CAAC6B,GAAV,CAAcG,CAAd,GAAkB,CAFnB,EAGGhC,SAAS,CAAC6B,GAAV,CAAcE,CAAd,GAAkB/B,SAAS,CAAC2B,GAAV,CAAcI,CAAlC,GAAwC,CAHzC,EAIG/B,SAAS,CAAC2B,GAAV,CAAcK,CAAd,GAAkBhC,SAAS,CAAC6B,GAAV,CAAcG,CAAlC,GAAwC,CAJzC;AAOA;;AAEDhC,MAAAA,SAAS,CAACuD,SAAV;AAEA;AAED,GA3CD,CArN8C,CAkQ9C;;;AAEA,OAAKC,UAAL,GAAkB,YAAY,CAAE,CAAhC;;AACA,OAAKC,UAAL,GAAkB,YAAY,CAAE,CAAhC;;AACA,OAAKC,YAAL,GAAoB,YAAY,CAAE,CAAlC;;AAEA,OAAKzC,MAAL,GAAc,UAAW0C,KAAX,EAAkBC,MAAlB,EAA2B;AAExC,QAAKA,MAAM,CAACC,QAAP,KAAoBjH,SAAzB,EAAqC;AAEpCX,MAAAA,OAAO,CAAC6H,KAAR,CAAe,yEAAf;AACA;AAEA;;AAED,QAAIC,UAAU,GAAGJ,KAAK,CAACI,UAAvB;;AAEA,QAAKA,UAAU,IAAIA,UAAU,CAACC,OAA9B,EAAwC;AAEvCjB,MAAAA,UAAU,CAAE,CAAF,CAAV;AACAC,MAAAA,WAAW,CAAEhI,KAAK,CAACiI,cAAR,CAAX;AAEAC,MAAAA,YAAY,CAAEa,UAAU,CAACE,QAAX,EAAF,CAAZ;;AACArG,MAAAA,QAAQ,CAAC0F,QAAT,CAAmB,CAAnB,EAAsB,CAAtB,EAAyBvG,YAAzB,EAAuCE,aAAvC;AAEA,KARD,MAQO,IAAK,KAAK4D,SAAL,KAAmB,IAAxB,EAA+B;AAErC,WAAK6B,KAAL;AAEA;;AAEDtG,IAAAA,KAAK,CAAC4E,IAAN,CAAWC,MAAX,CAAkBC,QAAlB,GAA6B,CAA7B;AACA9E,IAAAA,KAAK,CAAC4E,IAAN,CAAWC,MAAX,CAAkBE,KAAlB,GAA0B,CAA1B;;AAEAvD,IAAAA,QAAQ,CAACsG,YAAT,CAAuBzG,cAAc,GAAGV,YAAxC,EAAsD,CAAtD,EAAyD,CAAzD,EAA4D,CAAEW,eAAF,GAAoBT,aAAhF,EAA+FM,UAA/F,EAA2GN,aAAa,GAAGO,UAA3H;;AACAI,IAAAA,QAAQ,CAACuG,SAAT,CAAoBhH,gBAApB,EAAsCG,iBAAtC;;AAEAjB,IAAAA,WAAW,GAAGG,UAAU,CAAC4H,YAAX,CAAyBT,KAAzB,EAAgCC,MAAhC,EAAwC,KAAK9C,WAA7C,EAA0D,KAAKC,YAA/D,CAAd;AACAzE,IAAAA,SAAS,GAAGD,WAAW,CAACgI,QAAxB;AACA9H,IAAAA,OAAO,GAAGF,WAAW,CAACiI,MAAtB;;AAEA7D,IAAAA,iBAAiB,CAAC8D,eAAlB,CAAmCX,MAAM,CAACY,kBAA1C;AAEA;;;;;;AAKAC,IAAAA,eAAe;;AAEf,SAAM,IAAIC,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAGrI,SAAS,CAACsI,MAAhC,EAAwCF,CAAC,GAAGC,EAA5C,EAAgDD,CAAC,EAAjD,EAAuD;AAEtD,UAAIG,OAAO,GAAGvI,SAAS,CAAEoI,CAAF,CAAvB;AAEA,UAAI5I,QAAQ,GAAG+I,OAAO,CAAC/I,QAAvB;AAEA,UAAKA,QAAQ,KAAKc,SAAb,IAA0Bd,QAAQ,CAACgJ,OAAT,KAAqB,CAApD,EAAwD;;AAExD7E,MAAAA,QAAQ,CAACsD,SAAT;;AAEA,UAAKsB,OAAO,YAAY7J,KAAK,CAAC+J,gBAA9B,EAAiD;AAEhDtG,QAAAA,GAAG,GAAGoG,OAAN;AACApG,QAAAA,GAAG,CAACsD,CAAJ,IAAS5E,gBAAT;AAA2BsB,QAAAA,GAAG,CAACuD,CAAJ,IAAS1E,iBAAT;AAE3B0H,QAAAA,YAAY,CAAEvG,GAAF,EAAOoG,OAAP,EAAgB/I,QAAhB,CAAZ;AAEA,OAPD,MAOO,IAAK+I,OAAO,YAAY7J,KAAK,CAACiK,cAA9B,EAA+C;AAErDxG,QAAAA,GAAG,GAAGoG,OAAO,CAACK,EAAd;AAAkBxG,QAAAA,GAAG,GAAGmG,OAAO,CAACM,EAAd;AAElB1G,QAAAA,GAAG,CAAC2G,cAAJ,CAAmBrD,CAAnB,IAAwB5E,gBAAxB;AAA0CsB,QAAAA,GAAG,CAAC2G,cAAJ,CAAmBpD,CAAnB,IAAwB1E,iBAAxB;AAC1CoB,QAAAA,GAAG,CAAC0G,cAAJ,CAAmBrD,CAAnB,IAAwB5E,gBAAxB;AAA0CuB,QAAAA,GAAG,CAAC0G,cAAJ,CAAmBpD,CAAnB,IAAwB1E,iBAAxB;;AAE1C2C,QAAAA,QAAQ,CAACoF,aAAT,CAAwB,CACvB5G,GAAG,CAAC2G,cADmB,EAEvB1G,GAAG,CAAC0G,cAFmB,CAAxB;;AAKA,YAAKtF,QAAQ,CAACwF,aAAT,CAAwBrF,QAAxB,MAAuC,IAA5C,EAAmD;AAElDsF,UAAAA,UAAU,CAAE9G,GAAF,EAAOC,GAAP,EAAYmG,OAAZ,EAAqB/I,QAArB,CAAV;AAEA;AAED,OAlBM,MAkBA,IAAK+I,OAAO,YAAY7J,KAAK,CAACwK,cAA9B,EAA+C;AAErD/G,QAAAA,GAAG,GAAGoG,OAAO,CAACK,EAAd;AAAkBxG,QAAAA,GAAG,GAAGmG,OAAO,CAACM,EAAd;AAAkBxG,QAAAA,GAAG,GAAGkG,OAAO,CAACY,EAAd;AAEpC,YAAKhH,GAAG,CAAC2G,cAAJ,CAAmBM,CAAnB,GAAuB,CAAE,CAAzB,IAA8BjH,GAAG,CAAC2G,cAAJ,CAAmBM,CAAnB,GAAuB,CAA1D,EAA8D;AAC9D,YAAKhH,GAAG,CAAC0G,cAAJ,CAAmBM,CAAnB,GAAuB,CAAE,CAAzB,IAA8BhH,GAAG,CAAC0G,cAAJ,CAAmBM,CAAnB,GAAuB,CAA1D,EAA8D;AAC9D,YAAK/G,GAAG,CAACyG,cAAJ,CAAmBM,CAAnB,GAAuB,CAAE,CAAzB,IAA8B/G,GAAG,CAACyG,cAAJ,CAAmBM,CAAnB,GAAuB,CAA1D,EAA8D;AAE9DjH,QAAAA,GAAG,CAAC2G,cAAJ,CAAmBrD,CAAnB,IAAwB5E,gBAAxB;AAA0CsB,QAAAA,GAAG,CAAC2G,cAAJ,CAAmBpD,CAAnB,IAAwB1E,iBAAxB;AAC1CoB,QAAAA,GAAG,CAAC0G,cAAJ,CAAmBrD,CAAnB,IAAwB5E,gBAAxB;AAA0CuB,QAAAA,GAAG,CAAC0G,cAAJ,CAAmBpD,CAAnB,IAAwB1E,iBAAxB;AAC1CqB,QAAAA,GAAG,CAACyG,cAAJ,CAAmBrD,CAAnB,IAAwB5E,gBAAxB;AAA0CwB,QAAAA,GAAG,CAACyG,cAAJ,CAAmBpD,CAAnB,IAAwB1E,iBAAxB;;AAE1C,YAAKxB,QAAQ,CAAC6J,QAAT,GAAoB,CAAzB,EAA6B;AAE5BC,UAAAA,MAAM,CAAEnH,GAAG,CAAC2G,cAAN,EAAsB1G,GAAG,CAAC0G,cAA1B,EAA0CtJ,QAAQ,CAAC6J,QAAnD,CAAN;AACAC,UAAAA,MAAM,CAAElH,GAAG,CAAC0G,cAAN,EAAsBzG,GAAG,CAACyG,cAA1B,EAA0CtJ,QAAQ,CAAC6J,QAAnD,CAAN;AACAC,UAAAA,MAAM,CAAEjH,GAAG,CAACyG,cAAN,EAAsB3G,GAAG,CAAC2G,cAA1B,EAA0CtJ,QAAQ,CAAC6J,QAAnD,CAAN;AAEA;;AAED1F,QAAAA,QAAQ,CAACoF,aAAT,CAAwB,CACvB5G,GAAG,CAAC2G,cADmB,EAEvB1G,GAAG,CAAC0G,cAFmB,EAGvBzG,GAAG,CAACyG,cAHmB,CAAxB;;AAMA,YAAKtF,QAAQ,CAACwF,aAAT,CAAwBrF,QAAxB,MAAuC,IAA5C,EAAmD;AAElD4F,UAAAA,WAAW,CAAEpH,GAAF,EAAOC,GAAP,EAAYC,GAAZ,EAAiB,CAAjB,EAAoB,CAApB,EAAuB,CAAvB,EAA0BkG,OAA1B,EAAmC/I,QAAnC,CAAX;AAEA;AAED;AAED;;;;;;;AAMAkE,MAAAA,SAAS,CAAC8F,KAAV,CAAiB7F,QAAjB;AAEA;AAED;;;;;;;AAMArC,IAAAA,QAAQ,CAACsG,YAAT,CAAuB,CAAvB,EAA0B,CAA1B,EAA6B,CAA7B,EAAgC,CAAhC,EAAmC,CAAnC,EAAsC,CAAtC;AAEA,GAnID,CAxQ8C,CA6Y9C;;;AAEA,WAASO,eAAT,GAA2B;AAE1BvE,IAAAA,aAAa,CAAC6F,MAAd,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B;;AACA5F,IAAAA,kBAAkB,CAAC4F,MAAnB,CAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC;;AACA3F,IAAAA,YAAY,CAAC2F,MAAb,CAAqB,CAArB,EAAwB,CAAxB,EAA2B,CAA3B;;AAEA,SAAM,IAAIC,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAG1J,OAAO,CAACqI,MAA9B,EAAsCoB,CAAC,GAAGC,EAA1C,EAA8CD,CAAC,EAA/C,EAAqD;AAEpD,UAAIE,KAAK,GAAG3J,OAAO,CAAEyJ,CAAF,CAAnB;AACA,UAAIG,UAAU,GAAGD,KAAK,CAAC5K,KAAvB;;AAEA,UAAK4K,KAAK,CAACE,cAAX,EAA4B;AAE3BlG,QAAAA,aAAa,CAACmG,GAAd,CAAmBF,UAAnB;AAEA,OAJD,MAIO,IAAKD,KAAK,CAACI,kBAAX,EAAgC;AAEtC;AAEAnG,QAAAA,kBAAkB,CAACkG,GAAnB,CAAwBF,UAAxB;AAEA,OANM,MAMA,IAAKD,KAAK,CAACK,YAAX,EAA0B;AAEhC;AAEAnG,QAAAA,YAAY,CAACiG,GAAb,CAAkBF,UAAlB;AAEA;AAED;AAED;;AAED,WAASK,cAAT,CAAyBC,QAAzB,EAAmCC,MAAnC,EAA2CpL,KAA3C,EAAmD;AAElD,SAAM,IAAI0K,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAG1J,OAAO,CAACqI,MAA9B,EAAsCoB,CAAC,GAAGC,EAA1C,EAA8CD,CAAC,EAA/C,EAAqD;AAEpD,UAAIE,KAAK,GAAG3J,OAAO,CAAEyJ,CAAF,CAAnB;;AAEA3G,MAAAA,WAAW,CAACtD,IAAZ,CAAkBmK,KAAK,CAAC5K,KAAxB;;AAEA,UAAK4K,KAAK,CAACI,kBAAX,EAAgC;AAE/B,YAAIK,aAAa,GAAGtG,QAAQ,CAACuG,qBAAT,CAAgCV,KAAK,CAACW,WAAtC,EAAoDC,SAApD,EAApB;;AAEA,YAAIC,MAAM,GAAGL,MAAM,CAACM,GAAP,CAAYL,aAAZ,CAAb;AAEA,YAAKI,MAAM,IAAI,CAAf,EAAmB;AAEnBA,QAAAA,MAAM,IAAIb,KAAK,CAACe,SAAhB;AAEA3L,QAAAA,KAAK,CAAC+K,GAAN,CAAWhH,WAAW,CAAC6H,cAAZ,CAA4BH,MAA5B,CAAX;AAEA,OAZD,MAYO,IAAKb,KAAK,CAACK,YAAX,EAA0B;AAEhC,YAAII,aAAa,GAAGtG,QAAQ,CAACuG,qBAAT,CAAgCV,KAAK,CAACW,WAAtC,CAApB;;AAEA,YAAIE,MAAM,GAAGL,MAAM,CAACM,GAAP,CAAY3G,QAAQ,CAAC8G,UAAT,CAAqBR,aAArB,EAAoCF,QAApC,EAA+CK,SAA/C,EAAZ,CAAb;AAEA,YAAKC,MAAM,IAAI,CAAf,EAAmB;AAEnBA,QAAAA,MAAM,IAAIb,KAAK,CAACkB,QAAN,IAAkB,CAAlB,GAAsB,CAAtB,GAA0B,IAAIhK,IAAI,CAACuE,GAAL,CAAU8E,QAAQ,CAACY,UAAT,CAAqBV,aAArB,IAAuCT,KAAK,CAACkB,QAAvD,EAAiE,CAAjE,CAAxC;AAEA,YAAKL,MAAM,IAAI,CAAf,EAAmB;AAEnBA,QAAAA,MAAM,IAAIb,KAAK,CAACe,SAAhB;AAEA3L,QAAAA,KAAK,CAAC+K,GAAN,CAAWhH,WAAW,CAAC6H,cAAZ,CAA4BH,MAA5B,CAAX;AAEA;AAED;AAED;;AAED,WAAS/B,YAAT,CAAuBE,EAAvB,EAA2BL,OAA3B,EAAoC/I,QAApC,EAA+C;AAE9CiH,IAAAA,UAAU,CAAEjH,QAAQ,CAACgJ,OAAX,CAAV;AACA9B,IAAAA,WAAW,CAAElH,QAAQ,CAACwL,QAAX,CAAX;AAEA,QAAIC,MAAM,GAAG1C,OAAO,CAAC2C,KAAR,CAAczF,CAAd,GAAkB5E,gBAA/B;AACA,QAAIsK,MAAM,GAAG5C,OAAO,CAAC2C,KAAR,CAAcxF,CAAd,GAAkB1E,iBAA/B;AAEA,QAAIoK,IAAI,GAAGtK,IAAI,CAACuK,IAAL,CAAWJ,MAAM,GAAGA,MAAT,GAAkBE,MAAM,GAAGA,MAAtC,CAAX,CAR8C,CAQa;;AAC3DxH,IAAAA,QAAQ,CAAC0B,GAAT,CAAaC,GAAb,CAAkBsD,EAAE,CAACnD,CAAH,GAAO2F,IAAzB,EAA+BxC,EAAE,CAAClD,CAAH,GAAO0F,IAAtC;;AACAzH,IAAAA,QAAQ,CAAC4B,GAAT,CAAaD,GAAb,CAAkBsD,EAAE,CAACnD,CAAH,GAAO2F,IAAzB,EAA+BxC,EAAE,CAAClD,CAAH,GAAO0F,IAAtC;;AAEA,QAAK5L,QAAQ,CAAC8L,gBAAd,EAAiC;AAEhC,UAAIC,OAAO,GAAG/L,QAAQ,CAACgM,GAAvB;;AAEA,UAAKD,OAAO,KAAK,IAAjB,EAAwB;AAEvB,YAAIE,OAAO,GAAGzI,SAAS,CAAEuI,OAAO,CAACG,EAAV,CAAvB;;AAEA,YAAKD,OAAO,KAAKnL,SAAZ,IAAyBmL,OAAO,CAACE,OAAR,KAAoBJ,OAAO,CAACI,OAA1D,EAAoE;AAEnEF,UAAAA,OAAO,GAAGG,gBAAgB,CAAEL,OAAF,CAA1B;AACAvI,UAAAA,SAAS,CAAEuI,OAAO,CAACG,EAAV,CAAT,GAA0BD,OAA1B;AAEA;;AAED,YAAKA,OAAO,CAACpL,MAAR,KAAmBC,SAAxB,EAAoC;AAEnCsG,UAAAA,YAAY,CAAE6E,OAAO,CAACpL,MAAV,CAAZ;AAEA,cAAIwL,MAAM,GAAGN,OAAO,CAACO,KAArB;AAEA,cAAIC,EAAE,GAAGF,MAAM,CAACnL,KAAP,GAAe6K,OAAO,CAACS,MAAR,CAAevG,CAAvC;AACA,cAAIwG,EAAE,GAAGJ,MAAM,CAACjL,MAAP,GAAgB2K,OAAO,CAACS,MAAR,CAAetG,CAAxC;AAEA,cAAIwG,EAAE,GAAGL,MAAM,CAACnL,KAAP,GAAe6K,OAAO,CAACY,MAAR,CAAe1G,CAAvC;AACA,cAAI2G,EAAE,GAAGP,MAAM,CAACjL,MAAP,GAAgB2K,OAAO,CAACY,MAAR,CAAezG,CAAxC;AAEA,cAAI2G,EAAE,GAAGpB,MAAM,GAAGiB,EAAlB;AACA,cAAII,EAAE,GAAGnB,MAAM,GAAGiB,EAAlB;;AAEA9K,UAAAA,QAAQ,CAACiL,IAAT;;AACAjL,UAAAA,QAAQ,CAACuG,SAAT,CAAoBe,EAAE,CAACnD,CAAvB,EAA0BmD,EAAE,CAAClD,CAA7B;;AACA,cAAKlG,QAAQ,CAACgN,QAAT,KAAsB,CAA3B,EAA+BlL,QAAQ,CAACmL,MAAT,CAAiBjN,QAAQ,CAACgN,QAA1B;;AAC/BlL,UAAAA,QAAQ,CAACuG,SAAT,CAAoB,CAAEoD,MAAF,GAAW,CAA/B,EAAkC,CAAEE,MAAF,GAAW,CAA7C;;AACA7J,UAAAA,QAAQ,CAAC4J,KAAT,CAAgBmB,EAAhB,EAAoBC,EAApB;;AACAhL,UAAAA,QAAQ,CAACuG,SAAT,CAAoB,CAAEkE,EAAtB,EAA0B,CAAEE,EAA5B;;AACA3K,UAAAA,QAAQ,CAAC0F,QAAT,CAAmB+E,EAAnB,EAAuBE,EAAvB,EAA2BC,EAA3B,EAA+BE,EAA/B;;AACA9K,UAAAA,QAAQ,CAACoL,OAAT;AAEA;AAED,OArCD,MAqCO;AAEN;AAEA9F,QAAAA,YAAY,CAAEpH,QAAQ,CAACR,KAAT,CAAe2I,QAAf,EAAF,CAAZ;;AAEArG,QAAAA,QAAQ,CAACiL,IAAT;;AACAjL,QAAAA,QAAQ,CAACuG,SAAT,CAAoBe,EAAE,CAACnD,CAAvB,EAA0BmD,EAAE,CAAClD,CAA7B;;AACA,YAAKlG,QAAQ,CAACgN,QAAT,KAAsB,CAA3B,EAA+BlL,QAAQ,CAACmL,MAAT,CAAiBjN,QAAQ,CAACgN,QAA1B;;AAC/BlL,QAAAA,QAAQ,CAAC4J,KAAT,CAAgBD,MAAhB,EAAwB,CAAEE,MAA1B;;AACA7J,QAAAA,QAAQ,CAAC0F,QAAT,CAAmB,CAAE,GAArB,EAA0B,CAAE,GAA5B,EAAiC,CAAjC,EAAoC,CAApC;;AACA1F,QAAAA,QAAQ,CAACoL,OAAT;AAEA;AAED,KAxDD,MAwDO,IAAKlN,QAAQ,CAACF,sBAAd,EAAuC;AAE7CqN,MAAAA,cAAc,CAAEnN,QAAQ,CAACR,KAAT,CAAe2I,QAAf,EAAF,CAAd;AACAf,MAAAA,YAAY,CAAEpH,QAAQ,CAACR,KAAT,CAAe2I,QAAf,EAAF,CAAZ;;AAEArG,MAAAA,QAAQ,CAACiL,IAAT;;AACAjL,MAAAA,QAAQ,CAACuG,SAAT,CAAoBe,EAAE,CAACnD,CAAvB,EAA0BmD,EAAE,CAAClD,CAA7B;;AACA,UAAKlG,QAAQ,CAACgN,QAAT,KAAsB,CAA3B,EAA+BlL,QAAQ,CAACmL,MAAT,CAAiBjN,QAAQ,CAACgN,QAA1B;;AAC/BlL,MAAAA,QAAQ,CAAC4J,KAAT,CAAgBD,MAAhB,EAAwBE,MAAxB;;AAEA3L,MAAAA,QAAQ,CAACN,OAAT,CAAkBoC,QAAlB;;AAEAA,MAAAA,QAAQ,CAACoL,OAAT;AAEA,KAdM,MAcA,IAAKlN,QAAQ,CAACoN,gBAAd,EAAiC;AAEvChG,MAAAA,YAAY,CAAEpH,QAAQ,CAACR,KAAT,CAAe2I,QAAf,EAAF,CAAZ;;AAEArG,MAAAA,QAAQ,CAACiL,IAAT;;AACAjL,MAAAA,QAAQ,CAACuG,SAAT,CAAoBe,EAAE,CAACnD,CAAvB,EAA0BmD,EAAE,CAAClD,CAA7B;;AACA,UAAKlG,QAAQ,CAACgN,QAAT,KAAsB,CAA3B,EAA+BlL,QAAQ,CAACmL,MAAT,CAAiBjN,QAAQ,CAACgN,QAA1B;;AAC/BlL,MAAAA,QAAQ,CAAC4J,KAAT,CAAgBD,MAAM,GAAGzL,QAAQ,CAACqN,IAAlC,EAAwC,CAAE1B,MAAF,GAAW3L,QAAQ,CAACqN,IAA5D;;AACAvL,MAAAA,QAAQ,CAAC0F,QAAT,CAAmB,CAAE,GAArB,EAA0B,CAAE,GAA5B,EAAiC,CAAjC,EAAoC,CAApC;;AACA1F,MAAAA,QAAQ,CAACoL,OAAT;AAEA;AAED;;;;;;;;;;AAUA;;AAED,WAASzD,UAAT,CAAqBL,EAArB,EAAyBC,EAAzB,EAA6BN,OAA7B,EAAsC/I,QAAtC,EAAiD;AAEhDiH,IAAAA,UAAU,CAAEjH,QAAQ,CAACgJ,OAAX,CAAV;AACA9B,IAAAA,WAAW,CAAElH,QAAQ,CAACwL,QAAX,CAAX;;AAEA1J,IAAAA,QAAQ,CAACwL,SAAT;;AACAxL,IAAAA,QAAQ,CAACyL,MAAT,CAAiBnE,EAAE,CAACE,cAAH,CAAkBrD,CAAnC,EAAsCmD,EAAE,CAACE,cAAH,CAAkBpD,CAAxD;;AACApE,IAAAA,QAAQ,CAAC0L,MAAT,CAAiBnE,EAAE,CAACC,cAAH,CAAkBrD,CAAnC,EAAsCoD,EAAE,CAACC,cAAH,CAAkBpD,CAAxD;;AAEA,QAAKlG,QAAQ,CAACyN,mBAAd,EAAoC;AAEnCC,MAAAA,YAAY,CAAE1N,QAAQ,CAAC2N,SAAX,CAAZ;AACAC,MAAAA,UAAU,CAAE5N,QAAQ,CAAC6N,OAAX,CAAV;AACAC,MAAAA,WAAW,CAAE9N,QAAQ,CAAC+N,QAAX,CAAX;;AAEA,UAAK/N,QAAQ,CAACgO,YAAT,KAA0B9O,KAAK,CAAC+O,YAArC,EAAoD;AAEnDd,QAAAA,cAAc,CAAEnN,QAAQ,CAACR,KAAT,CAAe2I,QAAf,EAAF,CAAd;AAEA,OAJD,MAIO;AAEN,YAAI+F,WAAW,GAAGnF,OAAO,CAACiF,YAAR,CAAsB,CAAtB,EAA0B7F,QAA1B,EAAlB;AACA,YAAIgG,WAAW,GAAGpF,OAAO,CAACiF,YAAR,CAAsB,CAAtB,EAA0B7F,QAA1B,EAAlB;;AAEA,YAAK+F,WAAW,KAAKC,WAArB,EAAmC;AAElChB,UAAAA,cAAc,CAAEe,WAAF,CAAd;AAEA,SAJD,MAIO;AAEN,cAAI;AAEH,gBAAIE,IAAI,GAAGtM,QAAQ,CAACuM,oBAAT,CACVjF,EAAE,CAACE,cAAH,CAAkBrD,CADR,EAEVmD,EAAE,CAACE,cAAH,CAAkBpD,CAFR,EAGVmD,EAAE,CAACC,cAAH,CAAkBrD,CAHR,EAIVoD,EAAE,CAACC,cAAH,CAAkBpD,CAJR,CAAX;;AAMAkI,YAAAA,IAAI,CAACE,YAAL,CAAmB,CAAnB,EAAsBJ,WAAtB;AACAE,YAAAA,IAAI,CAACE,YAAL,CAAmB,CAAnB,EAAsBH,WAAtB;AAEA,WAXD,CAWE,OAAQI,SAAR,EAAoB;AAErBH,YAAAA,IAAI,GAAGF,WAAP;AAEA;;AAEDf,UAAAA,cAAc,CAAEiB,IAAF,CAAd;AAEA;AAED;;AAED,UAAKpO,QAAQ,CAACwO,oBAAd,EAAqC;AAEpC3J,QAAAA,WAAW,CAAE,CAAE7E,QAAQ,CAACyO,QAAX,EAAqBzO,QAAQ,CAAC0O,OAA9B,CAAF,CAAX;AAEA;;AAED5M,MAAAA,QAAQ,CAAC6M,MAAT;;AACAxK,MAAAA,QAAQ,CAAC4C,cAAT,CAAyB/G,QAAQ,CAAC2N,SAAT,GAAqB,CAA9C;;AAEA,UAAK3N,QAAQ,CAACwO,oBAAd,EAAqC;AAEpC3J,QAAAA,WAAW,CAAE,EAAF,CAAX;AAEA;AAED;AAED;;AAED,WAASkF,WAAT,CAAsBX,EAAtB,EAA0BC,EAA1B,EAA8BM,EAA9B,EAAkCiF,GAAlC,EAAuCC,GAAvC,EAA4CC,GAA5C,EAAiD/F,OAAjD,EAA0D/I,QAA1D,EAAqE;AAEpEM,IAAAA,KAAK,CAAC4E,IAAN,CAAWC,MAAX,CAAkBC,QAAlB,IAA8B,CAA9B;AACA9E,IAAAA,KAAK,CAAC4E,IAAN,CAAWC,MAAX,CAAkBE,KAAlB;AAEA4B,IAAAA,UAAU,CAAEjH,QAAQ,CAACgJ,OAAX,CAAV;AACA9B,IAAAA,WAAW,CAAElH,QAAQ,CAACwL,QAAX,CAAX;AAEA1I,IAAAA,IAAI,GAAGsG,EAAE,CAACE,cAAH,CAAkBrD,CAAzB;AAA4BlD,IAAAA,IAAI,GAAGqG,EAAE,CAACE,cAAH,CAAkBpD,CAAzB;AAC5BlD,IAAAA,IAAI,GAAGqG,EAAE,CAACC,cAAH,CAAkBrD,CAAzB;AAA4BhD,IAAAA,IAAI,GAAGoG,EAAE,CAACC,cAAH,CAAkBpD,CAAzB;AAC5BhD,IAAAA,IAAI,GAAGyG,EAAE,CAACL,cAAH,CAAkBrD,CAAzB;AAA4B9C,IAAAA,IAAI,GAAGwG,EAAE,CAACL,cAAH,CAAkBpD,CAAzB;AAE5B6I,IAAAA,YAAY,CAAEjM,IAAF,EAAQC,IAAR,EAAcC,IAAd,EAAoBC,IAApB,EAA0BC,IAA1B,EAAgCC,IAAhC,CAAZ;;AAEA,QAAK,CAAEnD,QAAQ,CAACgP,qBAAT,IAAkChP,QAAQ,CAACiP,mBAA3C,IAAkEjP,QAAQ,CAACkP,sBAA7E,KAAyGlP,QAAQ,CAACgM,GAAT,KAAiB,IAA/H,EAAsI;AAErI3I,MAAAA,aAAa,CAACpD,IAAd,CAAoBD,QAAQ,CAACR,KAA7B;;AACA8D,MAAAA,cAAc,CAACrD,IAAf,CAAqBD,QAAQ,CAACmP,QAA9B;;AAEA,UAAKnP,QAAQ,CAACgO,YAAT,KAA0B9O,KAAK,CAACkQ,UAArC,EAAkD;AAEjD/L,QAAAA,aAAa,CAACgM,QAAd,CAAwBtG,OAAO,CAACvJ,KAAhC;AAEA;;AAED4D,MAAAA,MAAM,CAACnD,IAAP,CAAamE,aAAb;;AAEAK,MAAAA,SAAS,CAACxE,IAAV,CAAgBmJ,EAAE,CAACkG,aAAnB,EAAmC/E,GAAnC,CAAwClB,EAAE,CAACiG,aAA3C,EAA2D/E,GAA3D,CAAgEZ,EAAE,CAAC2F,aAAnE,EAAmFC,YAAnF,CAAiG,CAAjG;;AAEA7E,MAAAA,cAAc,CAAEjG,SAAF,EAAasE,OAAO,CAACyG,WAArB,EAAkCpM,MAAlC,CAAd;;AAEAA,MAAAA,MAAM,CAACiM,QAAP,CAAiBhM,aAAjB,EAAiCkH,GAAjC,CAAsCjH,cAAtC;;AAEAtD,MAAAA,QAAQ,CAACyP,SAAT,KAAuB,IAAvB,GACIC,UAAU,CAAEtM,MAAF,EAAUpD,QAAQ,CAAC2P,kBAAnB,EAAuC3P,QAAQ,CAAC4P,gBAAhD,EAAkE5P,QAAQ,CAAC6P,iBAA3E,CADd,GAEIC,QAAQ,CAAE1M,MAAF,CAFZ;AAIA,KAvBD,MAuBO,IAAKpD,QAAQ,CAAC+P,mBAAT,IAAgC/P,QAAQ,CAACgP,qBAAzC,IAAkEhP,QAAQ,CAACiP,mBAA3E,IAAkGjP,QAAQ,CAACkP,sBAAhH,EAAyI;AAE/I,UAAKlP,QAAQ,CAACgM,GAAT,KAAiB,IAAtB,EAA6B;AAE5B,YAAIgE,OAAO,GAAGhQ,QAAQ,CAACgM,GAAT,CAAagE,OAA3B;;AAEA,YAAKA,OAAO,KAAK9Q,KAAK,CAAC+Q,SAAvB,EAAmC;AAElCxM,UAAAA,IAAI,GAAGsF,OAAO,CAACmH,GAAf;AACAC,UAAAA,WAAW,CAAErN,IAAF,EAAQC,IAAR,EAAcC,IAAd,EAAoBC,IAApB,EAA0BC,IAA1B,EAAgCC,IAAhC,EAAsCM,IAAI,CAAEmL,GAAF,CAAJ,CAAY3I,CAAlD,EAAqDxC,IAAI,CAAEmL,GAAF,CAAJ,CAAY1I,CAAjE,EAAoEzC,IAAI,CAAEoL,GAAF,CAAJ,CAAY5I,CAAhF,EAAmFxC,IAAI,CAAEoL,GAAF,CAAJ,CAAY3I,CAA/F,EAAkGzC,IAAI,CAAEqL,GAAF,CAAJ,CAAY7I,CAA9G,EAAiHxC,IAAI,CAAEqL,GAAF,CAAJ,CAAY5I,CAA7H,EAAgIlG,QAAQ,CAACgM,GAAzI,CAAX;AAEA;AAED,OAXD,MAWO,IAAKhM,QAAQ,CAACoQ,MAAT,KAAoB,IAAzB,EAAgC;AAEtC,YAAKpQ,QAAQ,CAACoQ,MAAT,CAAgBJ,OAAhB,KAA4B9Q,KAAK,CAACmR,0BAAvC,EAAoE;AAEnE3L,UAAAA,OAAO,CAACzE,IAAR,CAAc8I,OAAO,CAACuH,kBAAR,CAA4B1B,GAA5B,CAAd,EAAkD2B,YAAlD,CAAgE5L,iBAAhE;;AACAjB,UAAAA,KAAK,GAAG,MAAMgB,OAAO,CAACuB,CAAd,GAAkB,GAA1B;AACAtC,UAAAA,KAAK,GAAG,MAAMe,OAAO,CAACwB,CAAd,GAAkB,GAA1B;;AAEAxB,UAAAA,OAAO,CAACzE,IAAR,CAAc8I,OAAO,CAACuH,kBAAR,CAA4BzB,GAA5B,CAAd,EAAkD0B,YAAlD,CAAgE5L,iBAAhE;;AACAf,UAAAA,KAAK,GAAG,MAAMc,OAAO,CAACuB,CAAd,GAAkB,GAA1B;AACApC,UAAAA,KAAK,GAAG,MAAMa,OAAO,CAACwB,CAAd,GAAkB,GAA1B;;AAEAxB,UAAAA,OAAO,CAACzE,IAAR,CAAc8I,OAAO,CAACuH,kBAAR,CAA4BxB,GAA5B,CAAd,EAAkDyB,YAAlD,CAAgE5L,iBAAhE;;AACAb,UAAAA,KAAK,GAAG,MAAMY,OAAO,CAACuB,CAAd,GAAkB,GAA1B;AACAlC,UAAAA,KAAK,GAAG,MAAMW,OAAO,CAACwB,CAAd,GAAkB,GAA1B;AAEAiK,UAAAA,WAAW,CAAErN,IAAF,EAAQC,IAAR,EAAcC,IAAd,EAAoBC,IAApB,EAA0BC,IAA1B,EAAgCC,IAAhC,EAAsCO,KAAtC,EAA6CC,KAA7C,EAAoDC,KAApD,EAA2DC,KAA3D,EAAkEC,KAAlE,EAAyEC,KAAzE,EAAgF/D,QAAQ,CAACoQ,MAAzF,CAAX;AAEA;AAED,OApBM,MAoBA;AAENhN,QAAAA,MAAM,CAACnD,IAAP,CAAaD,QAAQ,CAACR,KAAtB;;AAEA,YAAKQ,QAAQ,CAACgO,YAAT,KAA0B9O,KAAK,CAACkQ,UAArC,EAAkD;AAEjDhM,UAAAA,MAAM,CAACiM,QAAP,CAAiBtG,OAAO,CAACvJ,KAAzB;AAEA;;AAEDQ,QAAAA,QAAQ,CAACyP,SAAT,KAAuB,IAAvB,GACIC,UAAU,CAAEtM,MAAF,EAAUpD,QAAQ,CAAC2P,kBAAnB,EAAuC3P,QAAQ,CAAC4P,gBAAhD,EAAkE5P,QAAQ,CAAC6P,iBAA3E,CADd,GAEIC,QAAQ,CAAE1M,MAAF,CAFZ;AAIA;AAED,KAjDM,MAiDA,IAAKpD,QAAQ,CAACwQ,oBAAd,EAAqC;AAE3C9L,MAAAA,OAAO,CAACzE,IAAR,CAAc8I,OAAO,CAACyG,WAAtB,EAAoCe,YAApC,CAAkD5L,iBAAlD;;AAEAvB,MAAAA,MAAM,CAAC6G,MAAP,CAAevF,OAAO,CAACuB,CAAvB,EAA0BvB,OAAO,CAACwB,CAAlC,EAAqCxB,OAAO,CAACkF,CAA7C,EAAiDwB,cAAjD,CAAiE,GAAjE,EAAuEqF,SAAvE,CAAkF,GAAlF;;AAEAzQ,MAAAA,QAAQ,CAACyP,SAAT,KAAuB,IAAvB,GACIC,UAAU,CAAEtM,MAAF,EAAUpD,QAAQ,CAAC2P,kBAAnB,EAAuC3P,QAAQ,CAAC4P,gBAAhD,EAAkE5P,QAAQ,CAAC6P,iBAA3E,CADd,GAEIC,QAAQ,CAAE1M,MAAF,CAFZ;AAIA,KAVM,MAUA;AAENA,MAAAA,MAAM,CAAC6G,MAAP,CAAe,CAAf,EAAkB,CAAlB,EAAqB,CAArB;;AAEAjK,MAAAA,QAAQ,CAACyP,SAAT,KAAuB,IAAvB,GACIC,UAAU,CAAEtM,MAAF,EAAUpD,QAAQ,CAAC2P,kBAAnB,EAAuC3P,QAAQ,CAAC4P,gBAAhD,EAAkE5P,QAAQ,CAAC6P,iBAA3E,CADd,GAEIC,QAAQ,CAAE1M,MAAF,CAFZ;AAIA;AAED,GAvvB6C,CAyvB9C;;;AAEA,WAAS2L,YAAT,CAAuB2B,EAAvB,EAA2BC,EAA3B,EAA+BC,EAA/B,EAAmCC,EAAnC,EAAuCC,EAAvC,EAA2CC,EAA3C,EAAgD;AAE/CjP,IAAAA,QAAQ,CAACwL,SAAT;;AACAxL,IAAAA,QAAQ,CAACyL,MAAT,CAAiBmD,EAAjB,EAAqBC,EAArB;;AACA7O,IAAAA,QAAQ,CAAC0L,MAAT,CAAiBoD,EAAjB,EAAqBC,EAArB;;AACA/O,IAAAA,QAAQ,CAAC0L,MAAT,CAAiBsD,EAAjB,EAAqBC,EAArB;;AACAjP,IAAAA,QAAQ,CAACkP,SAAT;AAEA;;AAED,WAAStB,UAAT,CAAqBlQ,KAArB,EAA4BmO,SAA5B,EAAuCE,OAAvC,EAAgDE,QAAhD,EAA2D;AAE1DL,IAAAA,YAAY,CAAEC,SAAF,CAAZ;AACAC,IAAAA,UAAU,CAAEC,OAAF,CAAV;AACAC,IAAAA,WAAW,CAAEC,QAAF,CAAX;AACAZ,IAAAA,cAAc,CAAE3N,KAAK,CAAC2I,QAAN,EAAF,CAAd;;AAEArG,IAAAA,QAAQ,CAAC6M,MAAT;;AAEAxK,IAAAA,QAAQ,CAAC4C,cAAT,CAAyB4G,SAAS,GAAG,CAArC;AAEA;;AAED,WAASmC,QAAT,CAAmBtQ,KAAnB,EAA2B;AAE1B4H,IAAAA,YAAY,CAAE5H,KAAK,CAAC2I,QAAN,EAAF,CAAZ;;AACArG,IAAAA,QAAQ,CAACmP,IAAT;AAEA;;AAED,WAAS7E,gBAAT,CAA2BL,OAA3B,EAAqC;AAEpC,QAAKA,OAAO,CAACI,OAAR,KAAoB,CAApB,IACJJ,OAAO,YAAY7M,KAAK,CAACgS,iBADrB,IAEJnF,OAAO,YAAY7M,KAAK,CAACiS,WAF1B,EAEwC;AAEvC,aAAO;AACNtQ,QAAAA,MAAM,EAAEC,SADF;AAENqL,QAAAA,OAAO,EAAEJ,OAAO,CAACI;AAFX,OAAP;AAKA;;AAED,QAAIG,KAAK,GAAGP,OAAO,CAACO,KAApB;;AAEA,QAAKA,KAAK,CAAC8E,QAAN,KAAmB,KAAxB,EAAgC;AAE/B,aAAO;AACNvQ,QAAAA,MAAM,EAAEC,SADF;AAENqL,QAAAA,OAAO,EAAE;AAFH,OAAP;AAKA;;AAED,QAAIkF,OAAO,GAAGtF,OAAO,CAACuF,KAAR,KAAkBpS,KAAK,CAACqS,cAAxB,IAA0CxF,OAAO,CAACuF,KAAR,KAAkBpS,KAAK,CAACsS,sBAAhF;AACA,QAAIC,OAAO,GAAG1F,OAAO,CAAC2F,KAAR,KAAkBxS,KAAK,CAACqS,cAAxB,IAA0CxF,OAAO,CAAC2F,KAAR,KAAkBxS,KAAK,CAACsS,sBAAhF;AAEA,QAAIG,OAAO,GAAG5F,OAAO,CAACuF,KAAR,KAAkBpS,KAAK,CAACsS,sBAAtC;AACA,QAAII,OAAO,GAAG7F,OAAO,CAAC2F,KAAR,KAAkBxS,KAAK,CAACsS,sBAAtC,CA5BoC,CA8BpC;;AAEA,QAAI3Q,MAAM,GAAGE,QAAQ,CAACC,aAAT,CAAwB,QAAxB,CAAb;AACAH,IAAAA,MAAM,CAACK,KAAP,GAAeoL,KAAK,CAACpL,KAAN,IAAgByQ,OAAO,GAAG,CAAH,GAAO,CAA9B,CAAf;AACA9Q,IAAAA,MAAM,CAACO,MAAP,GAAgBkL,KAAK,CAAClL,MAAN,IAAiBwQ,OAAO,GAAG,CAAH,GAAO,CAA/B,CAAhB;AAEA,QAAIC,OAAO,GAAGhR,MAAM,CAACkB,UAAP,CAAmB,IAAnB,CAAd;AACA8P,IAAAA,OAAO,CAACzJ,YAAR,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAAE,CAAjC,EAAoC,CAApC,EAAuCkE,KAAK,CAAClL,MAA7C;AACAyQ,IAAAA,OAAO,CAACC,SAAR,CAAmBxF,KAAnB,EAA0B,CAA1B,EAA6B,CAA7B;;AAEA,QAAKqF,OAAO,KAAK,IAAjB,EAAwB;AAEvBE,MAAAA,OAAO,CAACzJ,YAAR,CAAsB,CAAE,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAE,CAAnC,EAAsCkE,KAAK,CAACpL,KAA5C,EAAmDoL,KAAK,CAAClL,MAAzD;AACAyQ,MAAAA,OAAO,CAACC,SAAR,CAAmBxF,KAAnB,EAA0B,CAAEA,KAAK,CAACpL,KAAlC,EAAyC,CAAzC;AAEA;;AAED,QAAK0Q,OAAO,KAAK,IAAjB,EAAwB;AAEvBC,MAAAA,OAAO,CAACzJ,YAAR,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B,CAA5B,EAA+B,CAA/B,EAAkC,CAAlC,EAAqC,CAArC;AACAyJ,MAAAA,OAAO,CAACC,SAAR,CAAmBxF,KAAnB,EAA0B,CAA1B,EAA6BA,KAAK,CAAClL,MAAnC;AAEA;;AAED,QAAKuQ,OAAO,KAAK,IAAZ,IAAoBC,OAAO,KAAK,IAArC,EAA4C;AAE3CC,MAAAA,OAAO,CAACzJ,YAAR,CAAsB,CAAE,CAAxB,EAA2B,CAA3B,EAA8B,CAA9B,EAAiC,CAAjC,EAAoCkE,KAAK,CAACpL,KAA1C,EAAiD,CAAjD;AACA2Q,MAAAA,OAAO,CAACC,SAAR,CAAmBxF,KAAnB,EAA0B,CAAEA,KAAK,CAACpL,KAAlC,EAAyCoL,KAAK,CAAClL,MAA/C;AAEA;;AAED,QAAIuL,MAAM,GAAG,WAAb;;AAEA,QAAK0E,OAAO,KAAK,IAAZ,IAAoBI,OAAO,KAAK,IAArC,EAA4C;AAE3C9E,MAAAA,MAAM,GAAG,QAAT;AAEA,KAJD,MAIO,IAAK0E,OAAO,KAAK,IAAjB,EAAwB;AAE9B1E,MAAAA,MAAM,GAAG,UAAT;AAEA,KAJM,MAIA,IAAK8E,OAAO,KAAK,IAAjB,EAAwB;AAE9B9E,MAAAA,MAAM,GAAG,UAAT;AAEA;;AAED,QAAIV,OAAO,GAAGnK,QAAQ,CAACiQ,aAAT,CAAwBlR,MAAxB,EAAgC8L,MAAhC,CAAd;;AAEA,QAAKZ,OAAO,CAACiG,QAAb,EAAwBjG,OAAO,CAACiG,QAAR,CAAkBjG,OAAlB;AAExB,WAAO;AACNlL,MAAAA,MAAM,EAAEoL,OADF;AAENE,MAAAA,OAAO,EAAEJ,OAAO,CAACI;AAFX,KAAP;AAKA;;AAED,WAASgE,WAAT,CAAsBO,EAAtB,EAA0BC,EAA1B,EAA8BC,EAA9B,EAAkCC,EAAlC,EAAsCC,EAAtC,EAA0CC,EAA1C,EAA8CkB,EAA9C,EAAkDC,EAAlD,EAAsDC,EAAtD,EAA0D/I,EAA1D,EAA8DgJ,EAA9D,EAAkE/I,EAAlE,EAAsE0C,OAAtE,EAAgF;AAE/E,QAAIE,OAAO,GAAGzI,SAAS,CAAEuI,OAAO,CAACG,EAAV,CAAvB;;AAEA,QAAKD,OAAO,KAAKnL,SAAZ,IAAyBmL,OAAO,CAACE,OAAR,KAAoBJ,OAAO,CAACI,OAA1D,EAAoE;AAEnEF,MAAAA,OAAO,GAAGG,gBAAgB,CAAEL,OAAF,CAA1B;AACAvI,MAAAA,SAAS,CAAEuI,OAAO,CAACG,EAAV,CAAT,GAA0BD,OAA1B;AAEA;;AAED,QAAKA,OAAO,CAACpL,MAAR,KAAmBC,SAAxB,EAAoC;AAEnCsG,MAAAA,YAAY,CAAE6E,OAAO,CAACpL,MAAV,CAAZ;AAEA,KAJD,MAIO;AAENuG,MAAAA,YAAY,CAAE,mBAAF,CAAZ;;AACAtF,MAAAA,QAAQ,CAACmP,IAAT;;AACA;AAEA,KArB8E,CAuB/E;;;AAEA,QAAIoB,CAAJ;AAAA,QAAO9K,CAAP;AAAA,QAAU+K,CAAV;AAAA,QAAaC,CAAb;AAAA,QAAgB3J,CAAhB;AAAA,QAAmB4J,CAAnB;AAAA,QAAsBC,GAAtB;AAAA,QAA2BC,IAA3B;AAAA,QACCC,OAAO,GAAG5G,OAAO,CAACS,MAAR,CAAevG,CAAf,GAAmB8F,OAAO,CAACY,MAAR,CAAe1G,CAD7C;AAAA,QAEC2M,OAAO,GAAG7G,OAAO,CAACS,MAAR,CAAetG,CAAf,GAAmB6F,OAAO,CAACY,MAAR,CAAezG,CAF7C;AAAA,QAGChF,KAAK,GAAG6K,OAAO,CAACO,KAAR,CAAcpL,KAAd,GAAsB6K,OAAO,CAACY,MAAR,CAAe1G,CAH9C;AAAA,QAIC7E,MAAM,GAAG2K,OAAO,CAACO,KAAR,CAAclL,MAAd,GAAuB2K,OAAO,CAACY,MAAR,CAAezG,CAJhD;AAMA+L,IAAAA,EAAE,GAAG,CAAEA,EAAE,GAAGU,OAAP,IAAmBzR,KAAxB;AACAgR,IAAAA,EAAE,GAAG,CAAEA,EAAE,GAAGU,OAAP,IAAmBxR,MAAxB;AAEA+Q,IAAAA,EAAE,GAAG,CAAEA,EAAE,GAAGQ,OAAP,IAAmBzR,KAAxB;AACAkI,IAAAA,EAAE,GAAG,CAAEA,EAAE,GAAGwJ,OAAP,IAAmBxR,MAAxB;AAEAgR,IAAAA,EAAE,GAAG,CAAEA,EAAE,GAAGO,OAAP,IAAmBzR,KAAxB;AACAmI,IAAAA,EAAE,GAAG,CAAEA,EAAE,GAAGuJ,OAAP,IAAmBxR,MAAxB;AAEAwP,IAAAA,EAAE,IAAIF,EAAN;AAAUG,IAAAA,EAAE,IAAIF,EAAN;AACVG,IAAAA,EAAE,IAAIJ,EAAN;AAAUK,IAAAA,EAAE,IAAIJ,EAAN;AAEVwB,IAAAA,EAAE,IAAIF,EAAN;AAAU7I,IAAAA,EAAE,IAAI8I,EAAN;AACVE,IAAAA,EAAE,IAAIH,EAAN;AAAU5I,IAAAA,EAAE,IAAI6I,EAAN;AAEVO,IAAAA,GAAG,GAAGN,EAAE,GAAG9I,EAAL,GAAU+I,EAAE,GAAGhJ,EAArB;AAEA,QAAKqJ,GAAG,KAAK,CAAb,EAAiB;AAEjBC,IAAAA,IAAI,GAAG,IAAID,GAAX;AAEAJ,IAAAA,CAAC,GAAG,CAAEhJ,EAAE,GAAGuH,EAAL,GAAUxH,EAAE,GAAG0H,EAAjB,IAAwB4B,IAA5B;AACAnL,IAAAA,CAAC,GAAG,CAAE8B,EAAE,GAAGwH,EAAL,GAAUzH,EAAE,GAAG2H,EAAjB,IAAwB2B,IAA5B;AACAJ,IAAAA,CAAC,GAAG,CAAEH,EAAE,GAAGrB,EAAL,GAAUsB,EAAE,GAAGxB,EAAjB,IAAwB8B,IAA5B;AACAH,IAAAA,CAAC,GAAG,CAAEJ,EAAE,GAAGpB,EAAL,GAAUqB,EAAE,GAAGvB,EAAjB,IAAwB6B,IAA5B;AAEA9J,IAAAA,CAAC,GAAG8H,EAAE,GAAG2B,CAAC,GAAGJ,EAAT,GAAcK,CAAC,GAAGJ,EAAtB;AACAM,IAAAA,CAAC,GAAG7B,EAAE,GAAGpJ,CAAC,GAAG0K,EAAT,GAAcM,CAAC,GAAGL,EAAtB;;AAEApQ,IAAAA,QAAQ,CAACiL,IAAT;;AACAjL,IAAAA,QAAQ,CAAC+Q,SAAT,CAAoBR,CAApB,EAAuB9K,CAAvB,EAA0B+K,CAA1B,EAA6BC,CAA7B,EAAgC3J,CAAhC,EAAmC4J,CAAnC;;AACA1Q,IAAAA,QAAQ,CAACmP,IAAT;;AACAnP,IAAAA,QAAQ,CAACoL,OAAT;AAEA;AAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA;;;AAEA,WAASpD,MAAT,CAAiBV,EAAjB,EAAqBC,EAArB,EAAyByJ,MAAzB,EAAkC;AAEjC,QAAI7M,CAAC,GAAGoD,EAAE,CAACpD,CAAH,GAAOmD,EAAE,CAACnD,CAAlB;AAAA,QAAqBC,CAAC,GAAGmD,EAAE,CAACnD,CAAH,GAAOkD,EAAE,CAAClD,CAAnC;AAAA,QACCuM,GAAG,GAAGxM,CAAC,GAAGA,CAAJ,GAAQC,CAAC,GAAGA,CADnB;AAAA,QACsBwM,IADtB;AAGA,QAAKD,GAAG,KAAK,CAAb,EAAiB;AAEjBC,IAAAA,IAAI,GAAGI,MAAM,GAAGxR,IAAI,CAACuK,IAAL,CAAW4G,GAAX,CAAhB;AAEAxM,IAAAA,CAAC,IAAIyM,IAAL;AAAWxM,IAAAA,CAAC,IAAIwM,IAAL;AAEXrJ,IAAAA,EAAE,CAACpD,CAAH,IAAQA,CAAR;AAAWoD,IAAAA,EAAE,CAACnD,CAAH,IAAQA,CAAR;AACXkD,IAAAA,EAAE,CAACnD,CAAH,IAAQA,CAAR;AAAWmD,IAAAA,EAAE,CAAClD,CAAH,IAAQA,CAAR;AAEX,GA5+B6C,CA8+B9C;;;AAEA,WAASe,UAAT,CAAqBxB,KAArB,EAA6B;AAE5B,QAAKtD,mBAAmB,KAAKsD,KAA7B,EAAqC;AAEpC3D,MAAAA,QAAQ,CAACiR,WAAT,GAAuBtN,KAAvB;AACAtD,MAAAA,mBAAmB,GAAGsD,KAAtB;AAEA;AAED;;AAED,WAASyB,WAAT,CAAsBzB,KAAtB,EAA8B;AAE7B,QAAKrD,gCAAgC,KAAKqD,KAA1C,EAAkD;AAEjD,UAAKA,KAAK,KAAKvG,KAAK,CAACiI,cAArB,EAAsC;AAErCrF,QAAAA,QAAQ,CAACkR,wBAAT,GAAoC,aAApC;AAEA,OAJD,MAIO,IAAKvN,KAAK,KAAKvG,KAAK,CAAC+T,gBAArB,EAAwC;AAE9CnR,QAAAA,QAAQ,CAACkR,wBAAT,GAAoC,SAApC;AAEA,OAJM,MAIA,IAAKvN,KAAK,KAAKvG,KAAK,CAACgU,mBAArB,EAA2C;AAEjDpR,QAAAA,QAAQ,CAACkR,wBAAT,GAAoC,QAApC;AAEA,OAJM,MAIA,IAAKvN,KAAK,KAAKvG,KAAK,CAACiU,gBAArB,EAAwC;AAE9CrR,QAAAA,QAAQ,CAACkR,wBAAT,GAAoC,UAApC;AAEA;;AAED5Q,MAAAA,gCAAgC,GAAGqD,KAAnC;AAEA;AAED;;AAED,WAASiI,YAAT,CAAuBjI,KAAvB,EAA+B;AAE9B,QAAKlD,iBAAiB,KAAKkD,KAA3B,EAAmC;AAElC3D,MAAAA,QAAQ,CAACsR,SAAT,GAAqB3N,KAArB;AACAlD,MAAAA,iBAAiB,GAAGkD,KAApB;AAEA;AAED;;AAED,WAASmI,UAAT,CAAqBnI,KAArB,EAA6B;AAE5B;AAEA,QAAKjD,eAAe,KAAKiD,KAAzB,EAAiC;AAEhC3D,MAAAA,QAAQ,CAACuR,OAAT,GAAmB5N,KAAnB;AACAjD,MAAAA,eAAe,GAAGiD,KAAlB;AAEA;AAED;;AAED,WAASqI,WAAT,CAAsBrI,KAAtB,EAA8B;AAE7B;AAEA,QAAKhD,gBAAgB,KAAKgD,KAA1B,EAAkC;AAEjC3D,MAAAA,QAAQ,CAACwR,QAAT,GAAoB7N,KAApB;AACAhD,MAAAA,gBAAgB,GAAGgD,KAAnB;AAEA;AAED;;AAED,WAAS0H,cAAT,CAAyB1H,KAAzB,EAAiC;AAEhC,QAAKpD,mBAAmB,KAAKoD,KAA7B,EAAqC;AAEpC3D,MAAAA,QAAQ,CAACyR,WAAT,GAAuB9N,KAAvB;AACApD,MAAAA,mBAAmB,GAAGoD,KAAtB;AAEA;AAED;;AAED,WAAS2B,YAAT,CAAuB3B,KAAvB,EAA+B;AAE9B,QAAKnD,iBAAiB,KAAKmD,KAA3B,EAAmC;AAElC3D,MAAAA,QAAQ,CAAC0R,SAAT,GAAqB/N,KAArB;AACAnD,MAAAA,iBAAiB,GAAGmD,KAApB;AAEA;AAED;;AAED,WAASZ,WAAT,CAAsBY,KAAtB,EAA8B;AAE7B,QAAK/C,gBAAgB,CAACoG,MAAjB,KAA4BrD,KAAK,CAACqD,MAAvC,EAAgD;AAE/ChH,MAAAA,QAAQ,CAAC+C,WAAT,CAAsBY,KAAtB;;AACA/C,MAAAA,gBAAgB,GAAG+C,KAAnB;AAEA;AAED;AAED,CA7lCD;AAyoCA;;;;;;;AAMAvG,KAAK,CAACuU,gBAAN,GAAyB,YAAY;AAEpC,OAAKvH,EAAL,GAAU,CAAV;AAEA,OAAKwH,MAAL,GAAc,IAAd;AACA,OAAK9J,CAAL,GAAS,CAAT;AACA,OAAK+J,WAAL,GAAmB,CAAnB;AAEA,CARD,EAUA;;;AAEAzU,KAAK,CAACwK,cAAN,GAAuB,YAAY;AAElC,OAAKwC,EAAL,GAAU,CAAV;AAEA,OAAK9C,EAAL,GAAU,IAAIlK,KAAK,CAAC0U,gBAAV,EAAV;AACA,OAAKvK,EAAL,GAAU,IAAInK,KAAK,CAAC0U,gBAAV,EAAV;AACA,OAAKjK,EAAL,GAAU,IAAIzK,KAAK,CAAC0U,gBAAV,EAAV;AAEA,OAAKpE,WAAL,GAAmB,IAAItQ,KAAK,CAACsF,OAAV,EAAnB;AAEA,OAAK8L,kBAAL,GAA0B,CAAE,IAAIpR,KAAK,CAACsF,OAAV,EAAF,EAAuB,IAAItF,KAAK,CAACsF,OAAV,EAAvB,EAA4C,IAAItF,KAAK,CAACsF,OAAV,EAA5C,CAA1B;AACA,OAAKqP,mBAAL,GAA2B,CAA3B;AAEA,OAAKrU,KAAL,GAAa,IAAIN,KAAK,CAACO,KAAV,EAAb;AACA,OAAKO,QAAL,GAAgB,IAAhB;AACA,OAAKkQ,GAAL,GAAW,CAAE,IAAIhR,KAAK,CAAC4U,OAAV,EAAF,EAAuB,IAAI5U,KAAK,CAAC4U,OAAV,EAAvB,EAA4C,IAAI5U,KAAK,CAAC4U,OAAV,EAA5C,CAAX;AAEA,OAAKlK,CAAL,GAAS,CAAT;AACA,OAAK+J,WAAL,GAAmB,CAAnB;AAEA,CApBD,EAsBA;;;AAEAzU,KAAK,CAAC0U,gBAAN,GAAyB,YAAY;AAEpC,OAAKjJ,QAAL,GAAgB,IAAIzL,KAAK,CAACsF,OAAV,EAAhB;AACA,OAAK8K,aAAL,GAAqB,IAAIpQ,KAAK,CAACsF,OAAV,EAArB;AACA,OAAK8E,cAAL,GAAsB,IAAIpK,KAAK,CAAC6U,OAAV,EAAtB;AAEA,OAAKC,OAAL,GAAe,IAAf;AAEA,CARD;;AAUA9U,KAAK,CAAC0U,gBAAN,CAAuBhU,SAAvB,CAAiCK,IAAjC,GAAwC,UAAWgU,MAAX,EAAoB;AAE3D,OAAK3E,aAAL,CAAmBrP,IAAnB,CAAyBgU,MAAM,CAAC3E,aAAhC;AACA,OAAKhG,cAAL,CAAoBrJ,IAApB,CAA0BgU,MAAM,CAAC3K,cAAjC;AAEA,CALD,EAOA;;;AAEApK,KAAK,CAACiK,cAAN,GAAuB,YAAY;AAElC,OAAK+C,EAAL,GAAU,CAAV;AAEA,OAAK9C,EAAL,GAAU,IAAIlK,KAAK,CAAC0U,gBAAV,EAAV;AACA,OAAKvK,EAAL,GAAU,IAAInK,KAAK,CAAC0U,gBAAV,EAAV;AAEA,OAAK5F,YAAL,GAAoB,CAAE,IAAI9O,KAAK,CAACO,KAAV,EAAF,EAAqB,IAAIP,KAAK,CAACO,KAAV,EAArB,CAApB;AACA,OAAKO,QAAL,GAAgB,IAAhB;AAEA,OAAK4J,CAAL,GAAS,CAAT;AACA,OAAK+J,WAAL,GAAmB,CAAnB;AAEA,CAbD,EAeA;;;AAEAzU,KAAK,CAAC+J,gBAAN,GAAyB,YAAY;AAEpC,OAAKiD,EAAL,GAAU,CAAV;AAEA,OAAKwH,MAAL,GAAc,IAAd;AAEA,OAAKzN,CAAL,GAAS,CAAT;AACA,OAAKC,CAAL,GAAS,CAAT;AACA,OAAK0D,CAAL,GAAS,CAAT;AAEA,OAAKoD,QAAL,GAAgB,CAAhB;AACA,OAAKtB,KAAL,GAAa,IAAIxM,KAAK,CAAC4U,OAAV,EAAb;AAEA,OAAK9T,QAAL,GAAgB,IAAhB;AACA,OAAK2T,WAAL,GAAmB,CAAnB;AAEA,CAhBD,EAkBA;;;AAEAzU,KAAK,CAACyB,SAAN,GAAkB,YAAY;AAE7B,MAAIuT,OAAJ;AAAA,MAAaC,YAAb;AAAA,MAA2BC,WAAW,GAAG,EAAzC;AAAA,MAA6CC,iBAAiB,GAAG,CAAjE;AAAA,MACCC,OADD;AAAA,MACUC,YADV;AAAA,MACwBC,WAAW,GAAG,EADtC;AAAA,MAC0CC,iBAAiB,GAAG,CAD9D;AAAA,MAECC,KAFD;AAAA,MAEQC,UAFR;AAAA,MAEoBC,SAAS,GAAG,EAFhC;AAAA,MAEoCC,eAAe,GAAG,CAFtD;AAAA,MAGCC,KAHD;AAAA,MAGQC,UAHR;AAAA,MAGoBC,SAAS,GAAG,EAHhC;AAAA,MAGoCC,eAAe,GAAG,CAHtD;AAAA,MAICC,OAJD;AAAA,MAIUC,YAJV;AAAA,MAIwBC,WAAW,GAAG,EAJtC;AAAA,MAI0CC,iBAAiB,GAAG,CAJ9D;AAAA,MAMC9U,WAAW,GAAG;AAAE+U,IAAAA,OAAO,EAAE,EAAX;AAAe9M,IAAAA,MAAM,EAAE,EAAvB;AAA2BD,IAAAA,QAAQ,EAAE;AAArC,GANf;AAAA,MAQChE,QAAQ,GAAG,IAAIrF,KAAK,CAACsF,OAAV,EARZ;AAAA,MASC+Q,QAAQ,GAAG,IAAIrW,KAAK,CAAC6U,OAAV,EATZ;AAAA,MAWC/P,QAAQ,GAAG,IAAI9E,KAAK,CAACsW,IAAV,CAAgB,IAAItW,KAAK,CAACsF,OAAV,CAAmB,CAAE,CAArB,EAAwB,CAAE,CAA1B,EAA6B,CAAE,CAA/B,CAAhB,EAAoD,IAAItF,KAAK,CAACsF,OAAV,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,CAAzB,CAApD,CAXZ;AAAA,MAYCiR,YAAY,GAAG,IAAIvW,KAAK,CAACsW,IAAV,EAZhB;AAAA,MAaCE,QAAQ,GAAG,IAAIC,KAAJ,CAAW,CAAX,CAbZ;AAAA,MAeCC,WAAW,GAAG,IAAI1W,KAAK,CAAC2W,OAAV,EAff;AAAA,MAgBCC,qBAAqB,GAAG,IAAI5W,KAAK,CAAC2W,OAAV,EAhBzB;AAAA,MAkBCE,YAlBD;AAAA,MAmBCC,0BAA0B,GAAG,IAAI9W,KAAK,CAAC2W,OAAV,EAnB9B;AAAA,MAqBCI,aAAa,GAAG,IAAI/W,KAAK,CAAC0F,OAAV,EArBjB;AAAA,MAuBCsR,QAAQ,GAAG,IAAIhX,KAAK,CAACiX,OAAV,EAvBZ;AAAA,MAyBCC,6BAA6B,GAAG,IAAIlX,KAAK,CAAC6U,OAAV,EAzBjC;AAAA,MA0BCsC,6BAA6B,GAAG,IAAInX,KAAK,CAAC6U,OAAV,EA1BjC,CAF6B,CA8B7B;;;AAEA,OAAKuC,aAAL,GAAqB,UAAWC,MAAX,EAAmBzO,MAAnB,EAA4B;AAEhD3H,IAAAA,OAAO,CAACqG,IAAR,CAAc,4DAAd;AACA+P,IAAAA,MAAM,CAACC,OAAP,CAAgB1O,MAAhB;AAEA,GALD;;AAOA,OAAK2O,eAAL,GAAuB,UAAWF,MAAX,EAAmBzO,MAAnB,EAA4B;AAElD3H,IAAAA,OAAO,CAACqG,IAAR,CAAc,gEAAd;AACA+P,IAAAA,MAAM,CAACG,SAAP,CAAkB5O,MAAlB;AAEA,GALD;;AAOA,OAAK6O,UAAL,GAAkB,YAAY;AAE7BxW,IAAAA,OAAO,CAAC6H,KAAR,CAAe,kEAAf;AAEA,GAJD,CA9C6B,CAoD7B;;;AAEA,MAAI4O,UAAU,GAAG,SAAbA,UAAa,GAAY;AAE5B,QAAIC,OAAO,GAAG,EAAd;AACA,QAAIC,MAAM,GAAG,EAAb;AACA,QAAI5G,GAAG,GAAG,EAAV;AAEA,QAAIwD,MAAM,GAAG,IAAb;AACA,QAAI1T,QAAQ,GAAG,IAAf;AAEA,QAAI+W,YAAY,GAAG,IAAI7X,KAAK,CAAC0F,OAAV,EAAnB;;AAEA,aAASoS,SAAT,CAAoBvR,KAApB,EAA4B;AAE3BiO,MAAAA,MAAM,GAAGjO,KAAT;AACAzF,MAAAA,QAAQ,GAAG0T,MAAM,CAAC1T,QAAlB;AAEA+W,MAAAA,YAAY,CAACtO,eAAb,CAA8BiL,MAAM,CAAC3I,WAArC;AAEA8L,MAAAA,OAAO,CAAC/N,MAAR,GAAiB,CAAjB;AACAgO,MAAAA,MAAM,CAAChO,MAAP,GAAgB,CAAhB;AACAoH,MAAAA,GAAG,CAACpH,MAAJ,GAAa,CAAb;AAEA;;AAED,aAASmO,aAAT,CAAwBhD,MAAxB,EAAiC;AAEhC,UAAItJ,QAAQ,GAAGsJ,MAAM,CAACtJ,QAAtB;AACA,UAAI2E,aAAa,GAAG2E,MAAM,CAAC3E,aAA3B;AACA,UAAIhG,cAAc,GAAG2K,MAAM,CAAC3K,cAA5B;AAEAgG,MAAAA,aAAa,CAACrP,IAAd,CAAoB0K,QAApB,EAA+BuM,YAA/B,CAA6CnB,YAA7C;AACAzM,MAAAA,cAAc,CAACrJ,IAAf,CAAqBqP,aAArB,EAAqC4H,YAArC,CAAmDpB,qBAAnD;AAEA,UAAIqB,IAAI,GAAG,IAAI7N,cAAc,CAAC8N,CAA9B;AAEA9N,MAAAA,cAAc,CAACrD,CAAf,IAAoBkR,IAApB;AACA7N,MAAAA,cAAc,CAACpD,CAAf,IAAoBiR,IAApB;AACA7N,MAAAA,cAAc,CAACM,CAAf,IAAoBuN,IAApB;AAEAlD,MAAAA,MAAM,CAACD,OAAP,GAAiB1K,cAAc,CAACrD,CAAf,IAAoB,CAAE,CAAtB,IAA2BqD,cAAc,CAACrD,CAAf,IAAoB,CAA/C,IACdqD,cAAc,CAACpD,CAAf,IAAoB,CAAE,CADR,IACaoD,cAAc,CAACpD,CAAf,IAAoB,CADjC,IAEdoD,cAAc,CAACM,CAAf,IAAoB,CAAE,CAFR,IAEaN,cAAc,CAACM,CAAf,IAAoB,CAFlD;AAIA;;AAED,aAASyN,UAAT,CAAqBpR,CAArB,EAAwBC,CAAxB,EAA2B0D,CAA3B,EAA+B;AAE9B0K,MAAAA,OAAO,GAAGgD,mBAAmB,EAA7B;;AACAhD,MAAAA,OAAO,CAAC3J,QAAR,CAAiB7E,GAAjB,CAAsBG,CAAtB,EAAyBC,CAAzB,EAA4B0D,CAA5B;;AAEAqN,MAAAA,aAAa,CAAE3C,OAAF,CAAb;AAEA;;AAED,aAASiD,UAAT,CAAqBtR,CAArB,EAAwBC,CAAxB,EAA2B0D,CAA3B,EAA+B;AAE9BiN,MAAAA,OAAO,CAACW,IAAR,CAAcvR,CAAd,EAAiBC,CAAjB,EAAoB0D,CAApB;AAEA;;AAED,aAAS6N,SAAT,CAAoBpQ,CAApB,EAAuBC,CAAvB,EAA0BC,CAA1B,EAA8B;AAE7BuP,MAAAA,MAAM,CAACU,IAAP,CAAanQ,CAAb,EAAgBC,CAAhB,EAAmBC,CAAnB;AAEA;;AAED,aAASmQ,MAAT,CAAiBzR,CAAjB,EAAoBC,CAApB,EAAwB;AAEvBgK,MAAAA,GAAG,CAACsH,IAAJ,CAAUvR,CAAV,EAAaC,CAAb;AAEA;;AAED,aAASyR,uBAAT,CAAkCvO,EAAlC,EAAsCC,EAAtC,EAA0CM,EAA1C,EAA+C;AAE9C,UAAKP,EAAE,CAAC4K,OAAH,KAAe,IAAf,IAAuB3K,EAAE,CAAC2K,OAAH,KAAe,IAAtC,IAA8CrK,EAAE,CAACqK,OAAH,KAAe,IAAlE,EAAyE,OAAO,IAAP;AAEzE0B,MAAAA,QAAQ,CAAE,CAAF,CAAR,GAAgBtM,EAAE,CAACE,cAAnB;AACAoM,MAAAA,QAAQ,CAAE,CAAF,CAAR,GAAgBrM,EAAE,CAACC,cAAnB;AACAoM,MAAAA,QAAQ,CAAE,CAAF,CAAR,GAAgB/L,EAAE,CAACL,cAAnB;AAEA,aAAOtF,QAAQ,CAACwF,aAAT,CAAwBiM,YAAY,CAAClM,aAAb,CAA4BmM,QAA5B,CAAxB,CAAP;AAEA;;AAED,aAASkC,oBAAT,CAA+BxO,EAA/B,EAAmCC,EAAnC,EAAuCM,EAAvC,EAA4C;AAE3C,aAAS,CAAEA,EAAE,CAACL,cAAH,CAAkBrD,CAAlB,GAAsBmD,EAAE,CAACE,cAAH,CAAkBrD,CAA1C,KACFoD,EAAE,CAACC,cAAH,CAAkBpD,CAAlB,GAAsBkD,EAAE,CAACE,cAAH,CAAkBpD,CADtC,IAEJ,CAAEyD,EAAE,CAACL,cAAH,CAAkBpD,CAAlB,GAAsBkD,EAAE,CAACE,cAAH,CAAkBpD,CAA1C,KACEmD,EAAE,CAACC,cAAH,CAAkBrD,CAAlB,GAAsBmD,EAAE,CAACE,cAAH,CAAkBrD,CAD1C,CAFE,GAGgD,CAHvD;AAKA;;AAED,aAAS4R,QAAT,CAAmBxF,CAAnB,EAAsB9K,CAAtB,EAA0B;AAEzB,UAAI6B,EAAE,GAAGoL,WAAW,CAAEnC,CAAF,CAApB;AACA,UAAIhJ,EAAE,GAAGmL,WAAW,CAAEjN,CAAF,CAApB,CAHyB,CAKzB;;AAEA6B,MAAAA,EAAE,CAACE,cAAH,CAAkBrJ,IAAlB,CAAwBmJ,EAAE,CAACuB,QAA3B,EAAsCuM,YAAtC,CAAoDlB,0BAApD;AACA3M,MAAAA,EAAE,CAACC,cAAH,CAAkBrJ,IAAlB,CAAwBoJ,EAAE,CAACsB,QAA3B,EAAsCuM,YAAtC,CAAoDlB,0BAApD;;AAEA,UAAK8B,QAAQ,CAAE1O,EAAE,CAACE,cAAL,EAAqBD,EAAE,CAACC,cAAxB,CAAR,KAAqD,IAA1D,EAAiE;AAEhE;AACAF,QAAAA,EAAE,CAACE,cAAH,CAAkB8B,cAAlB,CAAkC,IAAIhC,EAAE,CAACE,cAAH,CAAkB8N,CAAxD;AACA/N,QAAAA,EAAE,CAACC,cAAH,CAAkB8B,cAAlB,CAAkC,IAAI/B,EAAE,CAACC,cAAH,CAAkB8N,CAAxD;AAEAtC,QAAAA,KAAK,GAAGiD,iBAAiB,EAAzB;AACAjD,QAAAA,KAAK,CAAC5I,EAAN,GAAWwH,MAAM,CAACxH,EAAlB;;AACA4I,QAAAA,KAAK,CAAC1L,EAAN,CAASnJ,IAAT,CAAemJ,EAAf;;AACA0L,QAAAA,KAAK,CAACzL,EAAN,CAASpJ,IAAT,CAAeoJ,EAAf;;AACAyL,QAAAA,KAAK,CAAClL,CAAN,GAAUtI,IAAI,CAACyE,GAAL,CAAUqD,EAAE,CAACE,cAAH,CAAkBM,CAA5B,EAA+BP,EAAE,CAACC,cAAH,CAAkBM,CAAjD,CAAV;AACAkL,QAAAA,KAAK,CAACnB,WAAN,GAAoBD,MAAM,CAACC,WAA3B;AAEAmB,QAAAA,KAAK,CAAC9U,QAAN,GAAiB0T,MAAM,CAAC1T,QAAxB;;AAEA,YAAK0T,MAAM,CAAC1T,QAAP,CAAgBgO,YAAhB,KAAiC9O,KAAK,CAAC+O,YAA5C,EAA2D;AAE1D6G,UAAAA,KAAK,CAAC9G,YAAN,CAAoB,CAApB,EAAwBgK,SAAxB,CAAmClB,MAAnC,EAA2CzE,CAAC,GAAG,CAA/C;;AACAyC,UAAAA,KAAK,CAAC9G,YAAN,CAAoB,CAApB,EAAwBgK,SAAxB,CAAmClB,MAAnC,EAA2CvP,CAAC,GAAG,CAA/C;AAEA;;AAEDhH,QAAAA,WAAW,CAACgI,QAAZ,CAAqBiP,IAArB,CAA2B1C,KAA3B;AAEA;AAED;;AAED,aAASmD,YAAT,CAAuB5F,CAAvB,EAA0B9K,CAA1B,EAA6B+K,CAA7B,EAAiC;AAEhC,UAAIlJ,EAAE,GAAGoL,WAAW,CAAEnC,CAAF,CAApB;AACA,UAAIhJ,EAAE,GAAGmL,WAAW,CAAEjN,CAAF,CAApB;AACA,UAAIoC,EAAE,GAAG6K,WAAW,CAAElC,CAAF,CAApB;AAEA,UAAKqF,uBAAuB,CAAEvO,EAAF,EAAMC,EAAN,EAAUM,EAAV,CAAvB,KAA0C,KAA/C,EAAuD;;AAEvD,UAAK3J,QAAQ,CAACkY,IAAT,KAAkBhZ,KAAK,CAACiZ,UAAxB,IAAsCP,oBAAoB,CAAExO,EAAF,EAAMC,EAAN,EAAUM,EAAV,CAApB,KAAuC,IAAlF,EAAyF;AAExF+K,QAAAA,KAAK,GAAG0D,iBAAiB,EAAzB;AAEA1D,QAAAA,KAAK,CAACxI,EAAN,GAAWwH,MAAM,CAACxH,EAAlB;;AACAwI,QAAAA,KAAK,CAACtL,EAAN,CAASnJ,IAAT,CAAemJ,EAAf;;AACAsL,QAAAA,KAAK,CAACrL,EAAN,CAASpJ,IAAT,CAAeoJ,EAAf;;AACAqL,QAAAA,KAAK,CAAC/K,EAAN,CAAS1J,IAAT,CAAe0J,EAAf;;AACA+K,QAAAA,KAAK,CAAC9K,CAAN,GAAU,CAAER,EAAE,CAACE,cAAH,CAAkBM,CAAlB,GAAsBP,EAAE,CAACC,cAAH,CAAkBM,CAAxC,GAA4CD,EAAE,CAACL,cAAH,CAAkBM,CAAhE,IAAsE,CAAhF;AACA8K,QAAAA,KAAK,CAACf,WAAN,GAAoBD,MAAM,CAACC,WAA3B,CATwF,CAWxF;;AAEAe,QAAAA,KAAK,CAAClF,WAAN,CAAkBwI,SAAlB,CAA6BnB,OAA7B,EAAsCxE,CAAC,GAAG,CAA1C;;AACAqC,QAAAA,KAAK,CAAClF,WAAN,CAAkBe,YAAlB,CAAgCwG,YAAhC,EAA+C/L,SAA/C;;AAEA,aAAM,IAAIqN,CAAC,GAAG,CAAd,EAAiBA,CAAC,GAAG,CAArB,EAAwBA,CAAC,EAAzB,EAA+B;AAE9B,cAAIzN,MAAM,GAAG8J,KAAK,CAACpE,kBAAN,CAA0B+H,CAA1B,CAAb;AACAzN,UAAAA,MAAM,CAACoN,SAAP,CAAkBnB,OAAlB,EAA2ByB,SAAS,CAAED,CAAF,CAAT,GAAiB,CAA5C;AACAzN,UAAAA,MAAM,CAAC2F,YAAP,CAAqBwG,YAArB,EAAoC/L,SAApC;AAEA,cAAIuN,EAAE,GAAG7D,KAAK,CAACxE,GAAN,CAAWmI,CAAX,CAAT;AACAE,UAAAA,EAAE,CAACP,SAAH,CAAc9H,GAAd,EAAmBoI,SAAS,CAAED,CAAF,CAAT,GAAiB,CAApC;AAEA;;AAED3D,QAAAA,KAAK,CAACb,mBAAN,GAA4B,CAA5B;AAEAa,QAAAA,KAAK,CAAC1U,QAAN,GAAiB0T,MAAM,CAAC1T,QAAxB;;AAEAO,QAAAA,WAAW,CAACgI,QAAZ,CAAqBiP,IAArB,CAA2B9C,KAA3B;AAEA;AAED;;AAED,WAAO;AACNsC,MAAAA,SAAS,EAAEA,SADL;AAENC,MAAAA,aAAa,EAAEA,aAFT;AAGNU,MAAAA,uBAAuB,EAAEA,uBAHnB;AAINC,MAAAA,oBAAoB,EAAEA,oBAJhB;AAKNP,MAAAA,UAAU,EAAEA,UALN;AAMNE,MAAAA,UAAU,EAAEA,UANN;AAONE,MAAAA,SAAS,EAAEA,SAPL;AAQNC,MAAAA,MAAM,EAAEA,MARF;AASNG,MAAAA,QAAQ,EAAEA,QATJ;AAUNI,MAAAA,YAAY,EAAEA;AAVR,KAAP;AAaA,GA7LD;;AA+LA,MAAIO,UAAU,GAAG,IAAI5B,UAAJ,EAAjB;;AAEA,WAAS6B,aAAT,CAAwB/E,MAAxB,EAAiC;AAEhC,QAAKA,MAAM,CAACM,OAAP,KAAmB,KAAxB,EAAgC;;AAEhC,QAAKN,MAAM,YAAYxU,KAAK,CAACwZ,KAA7B,EAAqC;AAEpCnY,MAAAA,WAAW,CAACiI,MAAZ,CAAmBgP,IAAnB,CAAyB9D,MAAzB;AAEA,KAJD,MAIO,IAAKA,MAAM,YAAYxU,KAAK,CAACyZ,IAAxB,IAAgCjF,MAAM,YAAYxU,KAAK,CAAC0Z,IAAxD,IAAgElF,MAAM,YAAYxU,KAAK,CAAC2Z,MAA7F,EAAsG;AAE5G,UAAKnF,MAAM,CAAC1T,QAAP,CAAgBgU,OAAhB,KAA4B,KAAjC,EAAyC;AACzC,UAAKN,MAAM,CAACoF,aAAP,KAAyB,IAAzB,IAAiC5C,QAAQ,CAAC6C,gBAAT,CAA2BrF,MAA3B,MAAwC,KAA9E,EAAsF;AAEtFsF,MAAAA,SAAS,CAAEtF,MAAF,CAAT;AAEA,KAPM,MAOA,IAAKA,MAAM,YAAYxU,KAAK,CAAC+Z,MAA7B,EAAsC;AAE5C,UAAKvF,MAAM,CAAC1T,QAAP,CAAgBgU,OAAhB,KAA4B,KAAjC,EAAyC;AACzC,UAAKN,MAAM,CAACoF,aAAP,KAAyB,IAAzB,IAAiC5C,QAAQ,CAACgD,gBAAT,CAA2BxF,MAA3B,MAAwC,KAA9E,EAAsF;AAEtFsF,MAAAA,SAAS,CAAEtF,MAAF,CAAT;AAEA;;AAED,QAAIyF,QAAQ,GAAGzF,MAAM,CAACyF,QAAtB;;AAEA,SAAM,IAAId,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAGiP,QAAQ,CAACrQ,MAA9B,EAAsCuP,CAAC,GAAGnO,CAA1C,EAA6CmO,CAAC,EAA9C,EAAoD;AAEnDI,MAAAA,aAAa,CAAEU,QAAQ,CAAEd,CAAF,CAAV,CAAb;AAEA;AAED;;AAED,WAASW,SAAT,CAAoBtF,MAApB,EAA6B;AAE5BQ,IAAAA,OAAO,GAAGkF,mBAAmB,EAA7B;AACAlF,IAAAA,OAAO,CAAChI,EAAR,GAAawH,MAAM,CAACxH,EAApB;AACAgI,IAAAA,OAAO,CAACR,MAAR,GAAiBA,MAAjB;;AAEAnP,IAAAA,QAAQ,CAACuG,qBAAT,CAAgC4I,MAAM,CAAC3I,WAAvC;;AACAxG,IAAAA,QAAQ,CAAC2S,YAAT,CAAuBpB,qBAAvB;;AACA5B,IAAAA,OAAO,CAACtK,CAAR,GAAYrF,QAAQ,CAACqF,CAArB;AACAsK,IAAAA,OAAO,CAACP,WAAR,GAAsBD,MAAM,CAACC,WAA7B;;AAEApT,IAAAA,WAAW,CAAC+U,OAAZ,CAAoBkC,IAApB,CAA0BtD,OAA1B;AAEA;;AAED,OAAK5L,YAAL,GAAoB,UAAWT,KAAX,EAAkBC,MAAlB,EAA0B9C,WAA1B,EAAuCC,YAAvC,EAAsD;AAEzE0P,IAAAA,UAAU,GAAG,CAAb;AACAI,IAAAA,UAAU,GAAG,CAAb;AACAI,IAAAA,YAAY,GAAG,CAAf;AAEA5U,IAAAA,WAAW,CAACgI,QAAZ,CAAqBO,MAArB,GAA8B,CAA9B;AAEA,QAAKjB,KAAK,CAACwR,UAAN,KAAqB,IAA1B,EAAiCxR,KAAK,CAACyR,iBAAN;AACjC,QAAKxR,MAAM,CAACyR,MAAP,KAAkB,IAAvB,EAA8BzR,MAAM,CAACwR,iBAAP;;AAE9B1D,IAAAA,WAAW,CAAC3V,IAAZ,CAAkB6H,MAAM,CAACY,kBAAzB;;AACAoN,IAAAA,qBAAqB,CAAC0D,gBAAtB,CAAwC1R,MAAM,CAAC2R,gBAA/C,EAAiE7D,WAAjE;;AAEAM,IAAAA,QAAQ,CAACwD,aAAT,CAAwB5D,qBAAxB,EAdyE,CAgBzE;;;AAEA3B,IAAAA,YAAY,GAAG,CAAf;AAEA5T,IAAAA,WAAW,CAAC+U,OAAZ,CAAoBxM,MAApB,GAA6B,CAA7B;AACAvI,IAAAA,WAAW,CAACiI,MAAZ,CAAmBM,MAAnB,GAA4B,CAA5B;AAEA2P,IAAAA,aAAa,CAAE5Q,KAAF,CAAb;;AAEA,QAAK7C,WAAW,KAAK,IAArB,EAA4B;AAE3BzE,MAAAA,WAAW,CAAC+U,OAAZ,CAAoBqE,IAApB,CAA0BC,WAA1B;AAEA,KA7BwE,CA+BzE;;;AAEA,QAAItE,OAAO,GAAG/U,WAAW,CAAC+U,OAA1B;;AAEA,SAAM,IAAIuE,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAGxE,OAAO,CAACxM,MAA9B,EAAsC+Q,CAAC,GAAGC,EAA1C,EAA8CD,CAAC,EAA/C,EAAqD;AAEpD,UAAInG,MAAM,GAAG4B,OAAO,CAAEuE,CAAF,CAAP,CAAanG,MAA1B;AACA,UAAIqG,QAAQ,GAAGrG,MAAM,CAACqG,QAAtB;AAEAvB,MAAAA,UAAU,CAACxB,SAAX,CAAsBtD,MAAtB;AAEAqC,MAAAA,YAAY,GAAGrC,MAAM,CAAC3I,WAAtB;AAEAwJ,MAAAA,YAAY,GAAG,CAAf;;AAEA,UAAKb,MAAM,YAAYxU,KAAK,CAACyZ,IAA7B,EAAoC;AAEnC,YAAKoB,QAAQ,YAAY7a,KAAK,CAAC8a,cAA/B,EAAgD;AAE/C,cAAIC,UAAU,GAAGF,QAAQ,CAACE,UAA1B;AACA,cAAIC,MAAM,GAAGH,QAAQ,CAACG,MAAtB;AAEA,cAAKD,UAAU,CAACtP,QAAX,KAAwB7J,SAA7B,EAAyC;AAEzC,cAAIqZ,SAAS,GAAGF,UAAU,CAACtP,QAAX,CAAoByP,KAApC;;AAEA,eAAM,IAAI/B,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAGiQ,SAAS,CAACrR,MAA/B,EAAuCuP,CAAC,GAAGnO,CAA3C,EAA8CmO,CAAC,IAAI,CAAnD,EAAuD;AAEtDG,YAAAA,UAAU,CAACnB,UAAX,CAAuB8C,SAAS,CAAE9B,CAAF,CAAhC,EAAuC8B,SAAS,CAAE9B,CAAC,GAAG,CAAN,CAAhD,EAA2D8B,SAAS,CAAE9B,CAAC,GAAG,CAAN,CAApE;AAEA;;AAED,cAAK4B,UAAU,CAACrP,MAAX,KAAsB9J,SAA3B,EAAuC;AAEtC,gBAAI+V,OAAO,GAAGoD,UAAU,CAACrP,MAAX,CAAkBwP,KAAhC;;AAEA,iBAAM,IAAI/B,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAG2M,OAAO,CAAC/N,MAA7B,EAAqCuP,CAAC,GAAGnO,CAAzC,EAA4CmO,CAAC,IAAI,CAAjD,EAAqD;AAEpDG,cAAAA,UAAU,CAACjB,UAAX,CAAuBV,OAAO,CAAEwB,CAAF,CAA9B,EAAqCxB,OAAO,CAAEwB,CAAC,GAAG,CAAN,CAA5C,EAAuDxB,OAAO,CAAEwB,CAAC,GAAG,CAAN,CAA9D;AAEA;AAED;;AAED,cAAK4B,UAAU,CAAC1B,EAAX,KAAkBzX,SAAvB,EAAmC;AAElC,gBAAIoP,GAAG,GAAG+J,UAAU,CAAC1B,EAAX,CAAc6B,KAAxB;;AAEA,iBAAM,IAAI/B,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAGgG,GAAG,CAACpH,MAAzB,EAAiCuP,CAAC,GAAGnO,CAArC,EAAwCmO,CAAC,IAAI,CAA7C,EAAiD;AAEhDG,cAAAA,UAAU,CAACd,MAAX,CAAmBxH,GAAG,CAAEmI,CAAF,CAAtB,EAA6BnI,GAAG,CAAEmI,CAAC,GAAG,CAAN,CAAhC;AAEA;AAED;;AAED,cAAK0B,QAAQ,CAACM,KAAT,KAAmB,IAAxB,EAA+B;AAE9B,gBAAIC,OAAO,GAAGP,QAAQ,CAACM,KAAT,CAAeD,KAA7B;;AAEA,gBAAKF,MAAM,CAACpR,MAAP,GAAgB,CAArB,EAAyB;AAExB,mBAAM,IAAIxB,CAAC,GAAG,CAAd,EAAiBA,CAAC,GAAG4S,MAAM,CAACpR,MAA5B,EAAoCxB,CAAC,EAArC,EAA2C;AAE1C,oBAAIiT,KAAK,GAAGL,MAAM,CAAE5S,CAAF,CAAlB;;AAEA,qBAAM,IAAI+Q,CAAC,GAAGkC,KAAK,CAACC,KAAd,EAAqBtQ,CAAC,GAAGqQ,KAAK,CAACC,KAAN,GAAcD,KAAK,CAACE,KAAnD,EAA0DpC,CAAC,GAAGnO,CAA9D,EAAiEmO,CAAC,IAAI,CAAtE,EAA0E;AAEzEG,kBAAAA,UAAU,CAACP,YAAX,CAAyBqC,OAAO,CAAEjC,CAAF,CAAhC,EAAuCiC,OAAO,CAAEjC,CAAC,GAAG,CAAN,CAA9C,EAAyDiC,OAAO,CAAEjC,CAAC,GAAG,CAAN,CAAhE;AAEA;AAED;AAED,aAdD,MAcO;AAEN,mBAAM,IAAIA,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAGoQ,OAAO,CAACxR,MAA7B,EAAqCuP,CAAC,GAAGnO,CAAzC,EAA4CmO,CAAC,IAAI,CAAjD,EAAqD;AAEpDG,gBAAAA,UAAU,CAACP,YAAX,CAAyBqC,OAAO,CAAEjC,CAAF,CAAhC,EAAuCiC,OAAO,CAAEjC,CAAC,GAAG,CAAN,CAA9C,EAAyDiC,OAAO,CAAEjC,CAAC,GAAG,CAAN,CAAhE;AAEA;AAED;AAED,WA5BD,MA4BO;AAEN,iBAAM,IAAIA,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAGiQ,SAAS,CAACrR,MAAV,GAAmB,CAAxC,EAA2CuP,CAAC,GAAGnO,CAA/C,EAAkDmO,CAAC,IAAI,CAAvD,EAA2D;AAE1DG,cAAAA,UAAU,CAACP,YAAX,CAAyBI,CAAzB,EAA4BA,CAAC,GAAG,CAAhC,EAAmCA,CAAC,GAAG,CAAvC;AAEA;AAED;AAED,SA7ED,MA6EO,IAAK0B,QAAQ,YAAY7a,KAAK,CAACwb,QAA/B,EAA0C;AAEhD,cAAItV,QAAQ,GAAG2U,QAAQ,CAAC3U,QAAxB;AACA,cAAIC,KAAK,GAAG0U,QAAQ,CAAC1U,KAArB;AACA,cAAIsV,aAAa,GAAGZ,QAAQ,CAACY,aAAT,CAAwB,CAAxB,CAApB;;AAEA1E,UAAAA,aAAa,CAACxN,eAAd,CAA+BsN,YAA/B;;AAEA,cAAI/V,QAAQ,GAAG0T,MAAM,CAAC1T,QAAtB;AAEA,cAAI4a,eAAe,GAAG,sBAAe5a,QAAf,CAAtB;;AAEA,eAAM,IAAI6a,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAG1V,QAAQ,CAAC0D,MAA/B,EAAuC+R,CAAC,GAAGC,EAA3C,EAA+CD,CAAC,EAAhD,EAAsD;AAErD,gBAAI5G,MAAM,GAAG7O,QAAQ,CAAEyV,CAAF,CAArB;;AAEAtW,YAAAA,QAAQ,CAACtE,IAAT,CAAegU,MAAf;;AAEA,gBAAKjU,QAAQ,CAAC+a,YAAT,KAA0B,IAA/B,EAAsC;AAErC,kBAAIA,YAAY,GAAGhB,QAAQ,CAACgB,YAA5B;AACA,kBAAIC,eAAe,GAAGtH,MAAM,CAACuH,qBAA7B;;AAEA,mBAAM,IAAIC,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAGJ,YAAY,CAACjS,MAAnC,EAA2CoS,CAAC,GAAGC,EAA/C,EAAmDD,CAAC,EAApD,EAA0D;AAEzD,oBAAIE,SAAS,GAAGJ,eAAe,CAAEE,CAAF,CAA/B;AAEA,oBAAKE,SAAS,KAAK,CAAnB,EAAuB;AAEvB,oBAAIC,MAAM,GAAGN,YAAY,CAAEG,CAAF,CAAzB;AACA,oBAAII,YAAY,GAAGD,MAAM,CAACjW,QAAP,CAAiByV,CAAjB,CAAnB;AAEAtW,gBAAAA,QAAQ,CAAC0B,CAAT,IAAc,CAAEqV,YAAY,CAACrV,CAAb,GAAiBgO,MAAM,CAAChO,CAA1B,IAAgCmV,SAA9C;AACA7W,gBAAAA,QAAQ,CAAC2B,CAAT,IAAc,CAAEoV,YAAY,CAACpV,CAAb,GAAiB+N,MAAM,CAAC/N,CAA1B,IAAgCkV,SAA9C;AACA7W,gBAAAA,QAAQ,CAACqF,CAAT,IAAc,CAAE0R,YAAY,CAAC1R,CAAb,GAAiBqK,MAAM,CAACrK,CAA1B,IAAgCwR,SAA9C;AAEA;AAED;;AAED5C,YAAAA,UAAU,CAACnB,UAAX,CAAuB9S,QAAQ,CAAC0B,CAAhC,EAAmC1B,QAAQ,CAAC2B,CAA5C,EAA+C3B,QAAQ,CAACqF,CAAxD;AAEA;;AAED,eAAM,IAAI4I,CAAC,GAAG,CAAR,EAAW+I,EAAE,GAAGlW,KAAK,CAACyD,MAA5B,EAAoC0J,CAAC,GAAG+I,EAAxC,EAA4C/I,CAAC,EAA7C,EAAmD;AAElD,gBAAIgJ,IAAI,GAAGnW,KAAK,CAAEmN,CAAF,CAAhB;AAEAxS,YAAAA,QAAQ,GAAG4a,eAAe,KAAK,IAApB,GACPlH,MAAM,CAAC1T,QAAP,CAAiBwb,IAAI,CAACC,aAAtB,CADO,GAEP/H,MAAM,CAAC1T,QAFX;AAIA,gBAAKA,QAAQ,KAAKc,SAAlB,EAA8B;AAE9B,gBAAIoX,IAAI,GAAGlY,QAAQ,CAACkY,IAApB;AAEA,gBAAI9O,EAAE,GAAGoL,WAAW,CAAEgH,IAAI,CAACnJ,CAAP,CAApB;AACA,gBAAIhJ,EAAE,GAAGmL,WAAW,CAAEgH,IAAI,CAACjU,CAAP,CAApB;AACA,gBAAIoC,EAAE,GAAG6K,WAAW,CAAEgH,IAAI,CAAClJ,CAAP,CAApB;AAEA,gBAAKkG,UAAU,CAACb,uBAAX,CAAoCvO,EAApC,EAAwCC,EAAxC,EAA4CM,EAA5C,MAAqD,KAA1D,EAAkE;AAElE,gBAAIqK,OAAO,GAAGwE,UAAU,CAACZ,oBAAX,CAAiCxO,EAAjC,EAAqCC,EAArC,EAAyCM,EAAzC,CAAd;;AAEA,gBAAKuO,IAAI,KAAKhZ,KAAK,CAACiZ,UAApB,EAAiC;AAEhC,kBAAKD,IAAI,KAAKhZ,KAAK,CAACwc,SAAf,IAA4B1H,OAAO,KAAK,KAA7C,EAAqD;AACrD,kBAAKkE,IAAI,KAAKhZ,KAAK,CAACyc,QAAf,IAA2B3H,OAAO,KAAK,IAA5C,EAAmD;AAEnD;;AAEDU,YAAAA,KAAK,GAAG0D,iBAAiB,EAAzB;AAEA1D,YAAAA,KAAK,CAACxI,EAAN,GAAWwH,MAAM,CAACxH,EAAlB;;AACAwI,YAAAA,KAAK,CAACtL,EAAN,CAASnJ,IAAT,CAAemJ,EAAf;;AACAsL,YAAAA,KAAK,CAACrL,EAAN,CAASpJ,IAAT,CAAeoJ,EAAf;;AACAqL,YAAAA,KAAK,CAAC/K,EAAN,CAAS1J,IAAT,CAAe0J,EAAf;;AAEA+K,YAAAA,KAAK,CAAClF,WAAN,CAAkBvP,IAAlB,CAAwBub,IAAI,CAAC5Q,MAA7B;;AAEA,gBAAKoJ,OAAO,KAAK,KAAZ,KAAuBkE,IAAI,KAAKhZ,KAAK,CAACyc,QAAf,IAA2BzD,IAAI,KAAKhZ,KAAK,CAACiZ,UAAjE,CAAL,EAAqF;AAEpFzD,cAAAA,KAAK,CAAClF,WAAN,CAAkBoM,MAAlB;AAEA;;AAEDlH,YAAAA,KAAK,CAAClF,WAAN,CAAkBe,YAAlB,CAAgC0F,aAAhC,EAAgDjL,SAAhD;;AAEA,gBAAI6Q,iBAAiB,GAAGL,IAAI,CAACM,aAA7B;;AAEA,iBAAM,IAAIC,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAG1a,IAAI,CAACuE,GAAL,CAAUgW,iBAAiB,CAAC/S,MAA5B,EAAoC,CAApC,CAAtB,EAA+DiT,CAAC,GAAGC,EAAnE,EAAuED,CAAC,EAAxE,EAA8E;AAE7E,kBAAIvM,WAAW,GAAGkF,KAAK,CAACpE,kBAAN,CAA0ByL,CAA1B,CAAlB;AACAvM,cAAAA,WAAW,CAACvP,IAAZ,CAAkB4b,iBAAiB,CAAEE,CAAF,CAAnC;;AAEA,kBAAK/H,OAAO,KAAK,KAAZ,KAAuBkE,IAAI,KAAKhZ,KAAK,CAACyc,QAAf,IAA2BzD,IAAI,KAAKhZ,KAAK,CAACiZ,UAAjE,CAAL,EAAqF;AAEpF3I,gBAAAA,WAAW,CAACoM,MAAZ;AAEA;;AAEDpM,cAAAA,WAAW,CAACe,YAAZ,CAA0B0F,aAA1B,EAA0CjL,SAA1C;AAEA;;AAED0J,YAAAA,KAAK,CAACb,mBAAN,GAA4BgI,iBAAiB,CAAC/S,MAA9C;AAEA,gBAAImT,SAAS,GAAGtB,aAAa,CAAEnI,CAAF,CAA7B;;AAEA,gBAAKyJ,SAAS,KAAKnb,SAAnB,EAA+B;AAE9B,mBAAM,IAAIob,CAAC,GAAG,CAAd,EAAiBA,CAAC,GAAG,CAArB,EAAwBA,CAAC,EAAzB,EAA+B;AAE9BxH,gBAAAA,KAAK,CAACxE,GAAN,CAAWgM,CAAX,EAAejc,IAAf,CAAqBgc,SAAS,CAAEC,CAAF,CAA9B;AAEA;AAED;;AAEDxH,YAAAA,KAAK,CAAClV,KAAN,GAAcgc,IAAI,CAAChc,KAAnB;AACAkV,YAAAA,KAAK,CAAC1U,QAAN,GAAiBA,QAAjB;AAEA0U,YAAAA,KAAK,CAAC9K,CAAN,GAAU,CAAER,EAAE,CAACE,cAAH,CAAkBM,CAAlB,GAAsBP,EAAE,CAACC,cAAH,CAAkBM,CAAxC,GAA4CD,EAAE,CAACL,cAAH,CAAkBM,CAAhE,IAAsE,CAAhF;AACA8K,YAAAA,KAAK,CAACf,WAAN,GAAoBD,MAAM,CAACC,WAA3B;;AAEApT,YAAAA,WAAW,CAACgI,QAAZ,CAAqBiP,IAArB,CAA2B9C,KAA3B;AAEA;AAED;AAED,OAlND,MAkNO,IAAKhB,MAAM,YAAYxU,KAAK,CAAC0Z,IAA7B,EAAoC;AAE1C5C,QAAAA,0BAA0B,CAACwD,gBAA3B,CAA6C1D,qBAA7C,EAAoEC,YAApE;;AAEA,YAAKgE,QAAQ,YAAY7a,KAAK,CAAC8a,cAA/B,EAAgD;AAE/C,cAAIC,UAAU,GAAGF,QAAQ,CAACE,UAA1B;;AAEA,cAAKA,UAAU,CAACtP,QAAX,KAAwB7J,SAA7B,EAAyC;AAExC,gBAAIqZ,SAAS,GAAGF,UAAU,CAACtP,QAAX,CAAoByP,KAApC;;AAEA,iBAAM,IAAI/B,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAGiQ,SAAS,CAACrR,MAA/B,EAAuCuP,CAAC,GAAGnO,CAA3C,EAA8CmO,CAAC,IAAI,CAAnD,EAAuD;AAEtDG,cAAAA,UAAU,CAACnB,UAAX,CAAuB8C,SAAS,CAAE9B,CAAF,CAAhC,EAAuC8B,SAAS,CAAE9B,CAAC,GAAG,CAAN,CAAhD,EAA2D8B,SAAS,CAAE9B,CAAC,GAAG,CAAN,CAApE;AAEA;;AAED,gBAAK4B,UAAU,CAACza,KAAX,KAAqBsB,SAA1B,EAAsC;AAErC,kBAAIgW,MAAM,GAAGmD,UAAU,CAACza,KAAX,CAAiB4a,KAA9B;;AAEA,mBAAM,IAAI/B,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAG4M,MAAM,CAAChO,MAA5B,EAAoCuP,CAAC,GAAGnO,CAAxC,EAA2CmO,CAAC,IAAI,CAAhD,EAAoD;AAEnDG,gBAAAA,UAAU,CAACf,SAAX,CAAsBX,MAAM,CAAEuB,CAAF,CAA5B,EAAmCvB,MAAM,CAAEuB,CAAC,GAAG,CAAN,CAAzC,EAAoDvB,MAAM,CAAEuB,CAAC,GAAG,CAAN,CAA1D;AAEA;AAED;;AAED,gBAAK0B,QAAQ,CAACM,KAAT,KAAmB,IAAxB,EAA+B;AAE9B,kBAAIC,OAAO,GAAGP,QAAQ,CAACM,KAAT,CAAeD,KAA7B;;AAEA,mBAAM,IAAI/B,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAGoQ,OAAO,CAACxR,MAA7B,EAAqCuP,CAAC,GAAGnO,CAAzC,EAA4CmO,CAAC,IAAI,CAAjD,EAAqD;AAEpDG,gBAAAA,UAAU,CAACX,QAAX,CAAqByC,OAAO,CAAEjC,CAAF,CAA5B,EAAmCiC,OAAO,CAAEjC,CAAC,GAAG,CAAN,CAA1C;AAEA;AAED,aAVD,MAUO;AAEN,kBAAI8D,IAAI,GAAGzI,MAAM,YAAYxU,KAAK,CAACkd,YAAxB,GAAuC,CAAvC,GAA2C,CAAtD;;AAEA,mBAAM,IAAI/D,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAKiQ,SAAS,CAACrR,MAAV,GAAmB,CAArB,GAA2B,CAAhD,EAAmDuP,CAAC,GAAGnO,CAAvD,EAA0DmO,CAAC,IAAI8D,IAA/D,EAAsE;AAErE3D,gBAAAA,UAAU,CAACX,QAAX,CAAqBQ,CAArB,EAAwBA,CAAC,GAAG,CAA5B;AAEA;AAED;AAED;AAED,SAlDD,MAkDO,IAAK0B,QAAQ,YAAY7a,KAAK,CAACwb,QAA/B,EAA0C;AAEhD,cAAItV,QAAQ,GAAGsO,MAAM,CAACqG,QAAP,CAAgB3U,QAA/B;AAEA,cAAKA,QAAQ,CAAC0D,MAAT,KAAoB,CAAzB,EAA6B;AAE7BM,UAAAA,EAAE,GAAGkO,mBAAmB,EAAxB;AACAlO,UAAAA,EAAE,CAACE,cAAH,CAAkBrJ,IAAlB,CAAwBmF,QAAQ,CAAE,CAAF,CAAhC,EAAwC8R,YAAxC,CAAsDlB,0BAAtD;AAEA,cAAImG,IAAI,GAAGzI,MAAM,YAAYxU,KAAK,CAACkd,YAAxB,GAAuC,CAAvC,GAA2C,CAAtD;;AAEA,eAAM,IAAIvB,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAG1V,QAAQ,CAAC0D,MAA/B,EAAuC+R,CAAC,GAAGC,EAA3C,EAA+CD,CAAC,EAAhD,EAAsD;AAErDzR,YAAAA,EAAE,GAAGkO,mBAAmB,EAAxB;AACAlO,YAAAA,EAAE,CAACE,cAAH,CAAkBrJ,IAAlB,CAAwBmF,QAAQ,CAAEyV,CAAF,CAAhC,EAAwC3D,YAAxC,CAAsDlB,0BAAtD;AAEA,gBAAK,CAAE6E,CAAC,GAAG,CAAN,IAAYsB,IAAZ,GAAmB,CAAxB,EAA4B;AAE5B9S,YAAAA,EAAE,GAAGmL,WAAW,CAAED,YAAY,GAAG,CAAjB,CAAhB;;AAEA6B,YAAAA,6BAA6B,CAACnW,IAA9B,CAAoCmJ,EAAE,CAACE,cAAvC;;AACA+M,YAAAA,6BAA6B,CAACpW,IAA9B,CAAoCoJ,EAAE,CAACC,cAAvC;;AAEA,gBAAKwO,QAAQ,CAAE1B,6BAAF,EAAiCC,6BAAjC,CAAR,KAA6E,IAAlF,EAAyF;AAExF;AACAD,cAAAA,6BAA6B,CAAChL,cAA9B,CAA8C,IAAIgL,6BAA6B,CAACgB,CAAhF;;AACAf,cAAAA,6BAA6B,CAACjL,cAA9B,CAA8C,IAAIiL,6BAA6B,CAACe,CAAhF;;AAEAtC,cAAAA,KAAK,GAAGiD,iBAAiB,EAAzB;AAEAjD,cAAAA,KAAK,CAAC5I,EAAN,GAAWwH,MAAM,CAACxH,EAAlB;;AACA4I,cAAAA,KAAK,CAAC1L,EAAN,CAASE,cAAT,CAAwBrJ,IAAxB,CAA8BmW,6BAA9B;;AACAtB,cAAAA,KAAK,CAACzL,EAAN,CAASC,cAAT,CAAwBrJ,IAAxB,CAA8BoW,6BAA9B;;AAEAvB,cAAAA,KAAK,CAAClL,CAAN,GAAUtI,IAAI,CAACyE,GAAL,CAAUqQ,6BAA6B,CAACxM,CAAxC,EAA2CyM,6BAA6B,CAACzM,CAAzE,CAAV;AACAkL,cAAAA,KAAK,CAACnB,WAAN,GAAoBD,MAAM,CAACC,WAA3B;AAEAmB,cAAAA,KAAK,CAAC9U,QAAN,GAAiB0T,MAAM,CAAC1T,QAAxB;;AAEA,kBAAK0T,MAAM,CAAC1T,QAAP,CAAgBgO,YAAhB,KAAiC9O,KAAK,CAAC+O,YAA5C,EAA2D;AAE1D6G,gBAAAA,KAAK,CAAC9G,YAAN,CAAoB,CAApB,EAAwB/N,IAAxB,CAA8ByT,MAAM,CAACqG,QAAP,CAAgBjD,MAAhB,CAAwB+D,CAAxB,CAA9B;;AACA/F,gBAAAA,KAAK,CAAC9G,YAAN,CAAoB,CAApB,EAAwB/N,IAAxB,CAA8ByT,MAAM,CAACqG,QAAP,CAAgBjD,MAAhB,CAAwB+D,CAAC,GAAG,CAA5B,CAA9B;AAEA;;AAEDta,cAAAA,WAAW,CAACgI,QAAZ,CAAqBiP,IAArB,CAA2B1C,KAA3B;AAEA;AAED;AAED;AAED,OA7GM,MA6GA,IAAKpB,MAAM,YAAYxU,KAAK,CAAC2Z,MAA7B,EAAsC;AAE5C7C,QAAAA,0BAA0B,CAACwD,gBAA3B,CAA6C1D,qBAA7C,EAAoEC,YAApE;;AAEA,YAAKgE,QAAQ,YAAY7a,KAAK,CAACwb,QAA/B,EAA0C;AAEzC,cAAItV,QAAQ,GAAGsO,MAAM,CAACqG,QAAP,CAAgB3U,QAA/B;;AAEA,eAAM,IAAIyV,CAAC,GAAG,CAAR,EAAWC,EAAE,GAAG1V,QAAQ,CAAC0D,MAA/B,EAAuC+R,CAAC,GAAGC,EAA3C,EAA+CD,CAAC,EAAhD,EAAsD;AAErD,gBAAI5G,MAAM,GAAG7O,QAAQ,CAAEyV,CAAF,CAArB;;AAEAtF,YAAAA,QAAQ,CAACzP,GAAT,CAAcmO,MAAM,CAAChO,CAArB,EAAwBgO,MAAM,CAAC/N,CAA/B,EAAkC+N,MAAM,CAACrK,CAAzC,EAA4C,CAA5C;;AACA2L,YAAAA,QAAQ,CAAC2B,YAAT,CAAuBlB,0BAAvB;;AAEAqG,YAAAA,SAAS,CAAE9G,QAAF,EAAY7B,MAAZ,EAAoB5L,MAApB,CAAT;AAEA;AAED,SAfD,MAeO,IAAKiS,QAAQ,YAAY7a,KAAK,CAAC8a,cAA/B,EAAgD;AAEtD,cAAIC,UAAU,GAAGF,QAAQ,CAACE,UAA1B;;AAEA,cAAKA,UAAU,CAACtP,QAAX,KAAwB7J,SAA7B,EAAyC;AAExC,gBAAIqZ,SAAS,GAAGF,UAAU,CAACtP,QAAX,CAAoByP,KAApC;;AAEA,iBAAM,IAAI/B,CAAC,GAAG,CAAR,EAAWnO,CAAC,GAAGiQ,SAAS,CAACrR,MAA/B,EAAuCuP,CAAC,GAAGnO,CAA3C,EAA8CmO,CAAC,IAAI,CAAnD,EAAuD;AAEtD9C,cAAAA,QAAQ,CAACzP,GAAT,CAAcqU,SAAS,CAAE9B,CAAF,CAAvB,EAA8B8B,SAAS,CAAE9B,CAAC,GAAG,CAAN,CAAvC,EAAkD8B,SAAS,CAAE9B,CAAC,GAAG,CAAN,CAA3D,EAAsE,CAAtE;;AACA9C,cAAAA,QAAQ,CAAC2B,YAAT,CAAuBlB,0BAAvB;;AAEAqG,cAAAA,SAAS,CAAE9G,QAAF,EAAY7B,MAAZ,EAAoB5L,MAApB,CAAT;AAEA;AAED;AAED;AAED,OAxCM,MAwCA,IAAK4L,MAAM,YAAYxU,KAAK,CAAC+Z,MAA7B,EAAsC;AAE5C1D,QAAAA,QAAQ,CAACzP,GAAT,CAAciQ,YAAY,CAACxN,QAAb,CAAuB,EAAvB,CAAd,EAA2CwN,YAAY,CAACxN,QAAb,CAAuB,EAAvB,CAA3C,EAAwEwN,YAAY,CAACxN,QAAb,CAAuB,EAAvB,CAAxE,EAAqG,CAArG;;AACAgN,QAAAA,QAAQ,CAAC2B,YAAT,CAAuBpB,qBAAvB;;AAEAuG,QAAAA,SAAS,CAAE9G,QAAF,EAAY7B,MAAZ,EAAoB5L,MAApB,CAAT;AAEA;AAED;;AAED,QAAK7C,YAAY,KAAK,IAAtB,EAA6B;AAE5B1E,MAAAA,WAAW,CAACgI,QAAZ,CAAqBoR,IAArB,CAA2BC,WAA3B;AAEA;;AAED,WAAOrZ,WAAP;AAEA,GAxaD;;AA0aA,WAAS8b,SAAT,CAAoB9G,QAApB,EAA8B7B,MAA9B,EAAsC5L,MAAtC,EAA+C;AAE9C,QAAIqP,IAAI,GAAG,IAAI5B,QAAQ,CAAC6B,CAAxB;AAEA7B,IAAAA,QAAQ,CAAC3L,CAAT,IAAcuN,IAAd;;AAEA,QAAK5B,QAAQ,CAAC3L,CAAT,IAAc,CAAE,CAAhB,IAAqB2L,QAAQ,CAAC3L,CAAT,IAAc,CAAxC,EAA4C;AAE3CsL,MAAAA,OAAO,GAAGoH,mBAAmB,EAA7B;AACApH,MAAAA,OAAO,CAAChJ,EAAR,GAAawH,MAAM,CAACxH,EAApB;AACAgJ,MAAAA,OAAO,CAACjP,CAAR,GAAYsP,QAAQ,CAACtP,CAAT,GAAakR,IAAzB;AACAjC,MAAAA,OAAO,CAAChP,CAAR,GAAYqP,QAAQ,CAACrP,CAAT,GAAaiR,IAAzB;AACAjC,MAAAA,OAAO,CAACtL,CAAR,GAAY2L,QAAQ,CAAC3L,CAArB;AACAsL,MAAAA,OAAO,CAACvB,WAAR,GAAsBD,MAAM,CAACC,WAA7B;AACAuB,MAAAA,OAAO,CAACxB,MAAR,GAAiBA,MAAjB;AAEAwB,MAAAA,OAAO,CAAClI,QAAR,GAAmB0G,MAAM,CAAC1G,QAA1B;AAEAkI,MAAAA,OAAO,CAACxJ,KAAR,CAAczF,CAAd,GAAkByN,MAAM,CAAChI,KAAP,CAAazF,CAAb,GAAiB3E,IAAI,CAACib,GAAL,CAAUrH,OAAO,CAACjP,CAAR,GAAY,CAAEsP,QAAQ,CAACtP,CAAT,GAAa6B,MAAM,CAAC2R,gBAAP,CAAwBlR,QAAxB,CAAkC,CAAlC,CAAf,KAA2DgN,QAAQ,CAAC6B,CAAT,GAAatP,MAAM,CAAC2R,gBAAP,CAAwBlR,QAAxB,CAAkC,EAAlC,CAAxE,CAAtB,CAAnC;AACA2M,MAAAA,OAAO,CAACxJ,KAAR,CAAcxF,CAAd,GAAkBwN,MAAM,CAAChI,KAAP,CAAaxF,CAAb,GAAiB5E,IAAI,CAACib,GAAL,CAAUrH,OAAO,CAAChP,CAAR,GAAY,CAAEqP,QAAQ,CAACrP,CAAT,GAAa4B,MAAM,CAAC2R,gBAAP,CAAwBlR,QAAxB,CAAkC,CAAlC,CAAf,KAA2DgN,QAAQ,CAAC6B,CAAT,GAAatP,MAAM,CAAC2R,gBAAP,CAAwBlR,QAAxB,CAAkC,EAAlC,CAAxE,CAAtB,CAAnC;AAEA2M,MAAAA,OAAO,CAAClV,QAAR,GAAmB0T,MAAM,CAAC1T,QAA1B;;AAEAO,MAAAA,WAAW,CAACgI,QAAZ,CAAqBiP,IAArB,CAA2BtC,OAA3B;AAEA;AAED,GA7uB4B,CA+uB7B;;;AAEA,WAASkE,mBAAT,GAA+B;AAE9B,QAAKjF,YAAY,KAAKE,iBAAtB,EAA0C;AAEzC,UAAIX,MAAM,GAAG,IAAIxU,KAAK,CAACuU,gBAAV,EAAb;;AACAW,MAAAA,WAAW,CAACoD,IAAZ,CAAkB9D,MAAlB;;AACAW,MAAAA,iBAAiB;AACjBF,MAAAA,YAAY;AACZ,aAAOT,MAAP;AAEA;;AAED,WAAOU,WAAW,CAAED,YAAY,EAAd,CAAlB;AAEA;;AAED,WAASmD,mBAAT,GAA+B;AAE9B,QAAK/C,YAAY,KAAKE,iBAAtB,EAA0C;AAEzC,UAAIR,MAAM,GAAG,IAAI/U,KAAK,CAAC0U,gBAAV,EAAb;;AACAY,MAAAA,WAAW,CAACgD,IAAZ,CAAkBvD,MAAlB;;AACAQ,MAAAA,iBAAiB;AACjBF,MAAAA,YAAY;AACZ,aAAON,MAAP;AAEA;;AAED,WAAOO,WAAW,CAAED,YAAY,EAAd,CAAlB;AAEA;;AAED,WAAS6D,iBAAT,GAA6B;AAE5B,QAAKzD,UAAU,KAAKE,eAApB,EAAsC;AAErC,UAAI2G,IAAI,GAAG,IAAItc,KAAK,CAACwK,cAAV,EAAX;;AACAkL,MAAAA,SAAS,CAAC4C,IAAV,CAAgBgE,IAAhB;;AACA3G,MAAAA,eAAe;AACfF,MAAAA,UAAU;AACV,aAAO6G,IAAP;AAEA;;AAED,WAAO5G,SAAS,CAAED,UAAU,EAAZ,CAAhB;AAGA;;AAED,WAASoD,iBAAT,GAA6B;AAE5B,QAAKhD,UAAU,KAAKE,eAApB,EAAsC;AAErC,UAAIuH,IAAI,GAAG,IAAItd,KAAK,CAACiK,cAAV,EAAX;;AACA6L,MAAAA,SAAS,CAACwC,IAAV,CAAgBgF,IAAhB;;AACAvH,MAAAA,eAAe;AACfF,MAAAA,UAAU;AACV,aAAOyH,IAAP;AAEA;;AAED,WAAOxH,SAAS,CAAED,UAAU,EAAZ,CAAhB;AAEA;;AAED,WAASuH,mBAAT,GAA+B;AAE9B,QAAKnH,YAAY,KAAKE,iBAAtB,EAA0C;AAEzC,UAAIoH,MAAM,GAAG,IAAIvd,KAAK,CAAC+J,gBAAV,EAAb;;AACAmM,MAAAA,WAAW,CAACoC,IAAZ,CAAkBiF,MAAlB;;AACApH,MAAAA,iBAAiB;AACjBF,MAAAA,YAAY;AACZ,aAAOsH,MAAP;AAEA;;AAED,WAAOrH,WAAW,CAAED,YAAY,EAAd,CAAlB;AAEA,GAh0B4B,CAk0B7B;;;AAEA,WAASyE,WAAT,CAAsBvH,CAAtB,EAAyB9K,CAAzB,EAA6B;AAE5B,QAAK8K,CAAC,CAACsB,WAAF,KAAkBpM,CAAC,CAACoM,WAAzB,EAAuC;AAEtC,aAAOtB,CAAC,CAACsB,WAAF,GAAgBpM,CAAC,CAACoM,WAAzB;AAEA,KAJD,MAIO,IAAKtB,CAAC,CAACzI,CAAF,KAAQrC,CAAC,CAACqC,CAAf,EAAmB;AAEzB,aAAOrC,CAAC,CAACqC,CAAF,GAAMyI,CAAC,CAACzI,CAAf;AAEA,KAJM,MAIA,IAAKyI,CAAC,CAACnG,EAAF,KAAS3E,CAAC,CAAC2E,EAAhB,EAAqB;AAE3B,aAAOmG,CAAC,CAACnG,EAAF,GAAO3E,CAAC,CAAC2E,EAAhB;AAEA,KAJM,MAIA;AAEN,aAAO,CAAP;AAEA;AAED;;AAED,WAAS4L,QAAT,CAAmB4E,EAAnB,EAAuBC,EAAvB,EAA4B;AAE3B,QAAIC,MAAM,GAAG,CAAb;AAAA,QAAgBC,MAAM,GAAG,CAAzB;AAAA,QAEA;AACA;AAECC,IAAAA,OAAO,GAAGJ,EAAE,CAAC9S,CAAH,GAAO8S,EAAE,CAACtF,CALrB;AAAA,QAMC2F,OAAO,GAAGJ,EAAE,CAAC/S,CAAH,GAAO+S,EAAE,CAACvF,CANrB;AAAA,QAOC4F,MAAM,GAAG,CAAEN,EAAE,CAAC9S,CAAL,GAAS8S,EAAE,CAACtF,CAPtB;AAAA,QAQC6F,MAAM,GAAG,CAAEN,EAAE,CAAC/S,CAAL,GAAS+S,EAAE,CAACvF,CARtB;;AAUA,QAAK0F,OAAO,IAAI,CAAX,IAAgBC,OAAO,IAAI,CAA3B,IAAgCC,MAAM,IAAI,CAA1C,IAA+CC,MAAM,IAAI,CAA9D,EAAkE;AAEjE;AACA,aAAO,IAAP;AAEA,KALD,MAKO,IAAOH,OAAO,GAAG,CAAV,IAAeC,OAAO,GAAG,CAA3B,IAAoCC,MAAM,GAAG,CAAT,IAAcC,MAAM,GAAG,CAAhE,EAAsE;AAE5E;AACA,aAAO,KAAP;AAEA,KALM,MAKA;AAEN;AAEA,UAAKH,OAAO,GAAG,CAAf,EAAmB;AAElB;AACAF,QAAAA,MAAM,GAAGtb,IAAI,CAACyE,GAAL,CAAU6W,MAAV,EAAkBE,OAAO,IAAKA,OAAO,GAAGC,OAAf,CAAzB,CAAT;AAEA,OALD,MAKO,IAAKA,OAAO,GAAG,CAAf,EAAmB;AAEzB;AACAF,QAAAA,MAAM,GAAGvb,IAAI,CAACuE,GAAL,CAAUgX,MAAV,EAAkBC,OAAO,IAAKA,OAAO,GAAGC,OAAf,CAAzB,CAAT;AAEA;;AAED,UAAKC,MAAM,GAAG,CAAd,EAAkB;AAEjB;AACAJ,QAAAA,MAAM,GAAGtb,IAAI,CAACyE,GAAL,CAAU6W,MAAV,EAAkBI,MAAM,IAAKA,MAAM,GAAGC,MAAd,CAAxB,CAAT;AAEA,OALD,MAKO,IAAKA,MAAM,GAAG,CAAd,EAAkB;AAExB;AACAJ,QAAAA,MAAM,GAAGvb,IAAI,CAACuE,GAAL,CAAUgX,MAAV,EAAkBG,MAAM,IAAKA,MAAM,GAAGC,MAAd,CAAxB,CAAT;AAEA;;AAED,UAAKJ,MAAM,GAAGD,MAAd,EAAuB;AAEtB;AACA;AACA;AACA,eAAO,KAAP;AAEA,OAPD,MAOO;AAEN;AACAF,QAAAA,EAAE,CAACQ,IAAH,CAASP,EAAT,EAAaC,MAAb;AACAD,QAAAA,EAAE,CAACO,IAAH,CAASR,EAAT,EAAa,IAAIG,MAAjB;AAEA,eAAO,IAAP;AAEA;AAED;AAED;AAED,CAj6BD","file":"canvas-renderer-and-projector.js","sourceRoot":"../src","sourcesContent":["// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n","var core = module.exports = { version: '2.6.9' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","var global = require('./_global');\nvar core = require('./_core');\nvar ctx = require('./_ctx');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var IS_WRAP = type & $export.W;\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE];\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];\n  var key, own, out;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if (own && has(exports, key)) continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function (C) {\n      var F = function (a, b, c) {\n        if (this instanceof C) {\n          switch (arguments.length) {\n            case 0: return new C();\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if (IS_PROTO) {\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n","// 22.1.2.2 / 15.4.3.2 Array.isArray(arg)\nvar $export = require('./_export');\n\n$export($export.S, 'Array', { isArray: require('./_is-array') });\n","require('../../modules/es6.array.is-array');\nmodule.exports = require('../../modules/_core').Array.isArray;\n","module.exports = require(\"core-js/library/fn/array/is-array\");","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n","module.exports = true;\n","var core = require('./_core');\nvar global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: core.version,\n  mode: require('./_library') ? 'pure' : 'global',\n  copyright: ' 2019 Denis Pushkarev (zloirock.ru)'\n});\n","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n","var dP = require('./_object-dp');\nvar anObject = require('./_an-object');\nvar getKeys = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n","var document = require('./_global').document;\nmodule.exports = document && document.documentElement;\n","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = require('./_an-object');\nvar dPs = require('./_object-dps');\nvar enumBugKeys = require('./_enum-bug-keys');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n","var $export = require('./_export');\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', { create: require('./_object-create') });\n","require('../../modules/es6.object.create');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function create(P, D) {\n  return $Object.create(P, D);\n};\n","module.exports = require(\"core-js/library/fn/object/create\");","// minOnSave: true, minifier: uglify-js\nvar bgColor = 0xffffff\n/**\n * @author mrdoob / http://mrdoob.com/\n */\n\nTHREE.SpriteCanvasMaterial = function ( parameters ) {\n\n\tTHREE.Material.call( this );\n\n\tthis.type = 'SpriteCanvasMaterial';\n\n\tthis.color = new THREE.Color( 0xffffff );\n\tthis.program = function () {};\n\n\tthis.setValues( parameters );\n\n};\n\nTHREE.SpriteCanvasMaterial.prototype = Object.create( THREE.Material.prototype );\nTHREE.SpriteCanvasMaterial.prototype.constructor = THREE.SpriteCanvasMaterial;\nTHREE.SpriteCanvasMaterial.prototype.isSpriteCanvasMaterial = true;\n\nTHREE.SpriteCanvasMaterial.prototype.clone = function () {\n\n\tvar material = new THREE.SpriteCanvasMaterial();\n\n\tmaterial.copy( this );\n\tmaterial.color.copy( this.color );\n\tmaterial.program = this.program;\n\n\treturn material;\n\n};\n\n//\n\nTHREE.CanvasRenderer = function ( parameters ) {\n\n\tconsole.log( 'THREE.CanvasRenderer', THREE.REVISION );\n\n\tparameters = parameters || {};\n\n\tvar _this = this,\n\t\t_renderData, _elements, _lights,\n\t\t_projector = new THREE.Projector(),\n\n\t\t_canvas = parameters.canvas !== undefined\n\t\t\t\t ? parameters.canvas\n\t\t\t\t : document.createElement( 'canvas' ),\n\n\t\t_canvasWidth = _canvas.width,\n\t\t_canvasHeight = _canvas.height,\n\t\t_canvasWidthHalf = Math.floor( _canvasWidth / 2 ),\n\t\t_canvasHeightHalf = Math.floor( _canvasHeight / 2 ),\n\n\t\t_viewportX = 0,\n\t\t_viewportY = 0,\n\t\t_viewportWidth = _canvasWidth,\n\t\t_viewportHeight = _canvasHeight,\n\n\t\t_pixelRatio = 1,\n\n\t\t_context = _canvas.getContext( '2d', {\n\t\t\talpha: parameters.alpha === true\n\t\t} ),\n\n\t\t_clearColor = new THREE.Color( bgColor ),\n\t\t_clearAlpha = parameters.alpha === true ? 0 : 1,\n\n\t\t_contextGlobalAlpha = 1,\n\t\t_contextGlobalCompositeOperation = 0,\n\t\t_contextStrokeStyle = null,\n\t\t_contextFillStyle = null,\n\t\t_contextLineWidth = null,\n\t\t_contextLineCap = null,\n\t\t_contextLineJoin = null,\n\t\t_contextLineDash = [],\n\n\t\t_v1, _v2, _v3,\n\n\t\t_v1x, _v1y, _v2x, _v2y, _v3x, _v3y,\n\n\t\t_color = new THREE.Color(),\n\n\t\t_diffuseColor = new THREE.Color(),\n\t\t_emissiveColor = new THREE.Color(),\n\n\t\t_lightColor = new THREE.Color(),\n\n\t\t_patterns = {},\n\n\t\t_uvs,\n\t\t_uv1x, _uv1y, _uv2x, _uv2y, _uv3x, _uv3y,\n\n\t\t_clipBox = new THREE.Box2(),\n\t\t_clearBox = new THREE.Box2(),\n\t\t_elemBox = new THREE.Box2(),\n\n\t\t_ambientLight = new THREE.Color(),\n\t\t_directionalLights = new THREE.Color(),\n\t\t_pointLights = new THREE.Color(),\n\n\t\t_vector3 = new THREE.Vector3(), // Needed for PointLight\n\t\t_centroid = new THREE.Vector3(),\n\t\t_normal = new THREE.Vector3(),\n\t\t_normalViewMatrix = new THREE.Matrix3();\n\n\t/* TODO\n\t_canvas.mozImageSmoothingEnabled = false;\n\t_canvas.webkitImageSmoothingEnabled = false;\n\t_canvas.msImageSmoothingEnabled = false;\n\t_canvas.imageSmoothingEnabled = false;\n\t*/\n\n\t// dash+gap fallbacks for Firefox and everything else\n\n\tif ( _context.setLineDash === undefined ) {\n\n\t\t_context.setLineDash = function () {};\n\n\t}\n\n\tthis.domElement = _canvas;\n\n\tthis.autoClear = true;\n\tthis.sortObjects = true;\n\tthis.sortElements = true;\n\n\tthis.info = {\n\n\t\trender: {\n\n\t\t\tvertices: 0,\n\t\t\tfaces: 0\n\n\t\t}\n\n\t};\n\n\t// API\n\n\tthis.getContext = function () {\n\n\t\treturn _context;\n\n\t};\n\n\tthis.getContextAttributes = function () {\n\n\t\treturn _context.getContextAttributes();\n\n\t};\n\n\tthis.getPixelRatio = function () {\n\n\t\treturn _pixelRatio;\n\n\t};\n\n\tthis.setPixelRatio = function ( value ) {\n\n\t\tif ( value !== undefined ) _pixelRatio = value;\n\n\t};\n\n\tthis.setSize = function ( width, height, updateStyle ) {\n\n\t\t_canvasWidth = width * _pixelRatio;\n\t\t_canvasHeight = height * _pixelRatio;\n\n\t\t_canvas.width = _canvasWidth;\n\t\t_canvas.height = _canvasHeight;\n\n\t\t_canvasWidthHalf = Math.floor( _canvasWidth / 2 );\n\t\t_canvasHeightHalf = Math.floor( _canvasHeight / 2 );\n\n\t\tif ( updateStyle !== false ) {\n\n\t\t\t_canvas.style.width = width + 'px';\n\t\t\t_canvas.style.height = height + 'px';\n\n\t\t}\n\n\t\t_clipBox.min.set( - _canvasWidthHalf, - _canvasHeightHalf );\n\t\t_clipBox.max.set(   _canvasWidthHalf,   _canvasHeightHalf );\n\n\t\t_clearBox.min.set( - _canvasWidthHalf, - _canvasHeightHalf );\n\t\t_clearBox.max.set(   _canvasWidthHalf,   _canvasHeightHalf );\n\n\t\t_contextGlobalAlpha = 1;\n\t\t_contextGlobalCompositeOperation = 0;\n\t\t_contextStrokeStyle = null;\n\t\t_contextFillStyle = null;\n\t\t_contextLineWidth = null;\n\t\t_contextLineCap = null;\n\t\t_contextLineJoin = null;\n\n\t\tthis.setViewport( 0, 0, width, height );\n\n\t};\n\n\tthis.setViewport = function ( x, y, width, height ) {\n\n\t\t_viewportX = x * _pixelRatio;\n\t\t_viewportY = y * _pixelRatio;\n\n\t\t_viewportWidth = width * _pixelRatio;\n\t\t_viewportHeight = height * _pixelRatio;\n\n\t};\n\n\tthis.setScissor = function () {};\n\tthis.setScissorTest = function () {};\n\n\tthis.setClearColor = function ( color, alpha ) {\n\n\t\t_clearColor.set( color );\n\t\t_clearAlpha = alpha !== undefined ? alpha : 1;\n\n\t\t_clearBox.min.set( - _canvasWidthHalf, - _canvasHeightHalf );\n\t\t_clearBox.max.set(   _canvasWidthHalf,   _canvasHeightHalf );\n\n\t};\n\n\tthis.setClearColorHex = function ( hex, alpha ) {\n\n\t\tconsole.warn( 'THREE.CanvasRenderer: .setClearColorHex() is being removed. Use .setClearColor() instead.' );\n\t\tthis.setClearColor( hex, alpha );\n\n\t};\n\n\tthis.getClearColor = function () {\n\n\t\treturn _clearColor;\n\n\t};\n\n\tthis.getClearAlpha = function () {\n\n\t\treturn _clearAlpha;\n\n\t};\n\n\tthis.getMaxAnisotropy = function () {\n\n\t\treturn 0;\n\n\t};\n\n\tthis.clear = function () {\n\n\t\tif ( _clearBox.isEmpty() === false ) {\n\n\t\t\t_clearBox.intersect( _clipBox );\n\t\t\t_clearBox.expandByScalar( 2 );\n\n\t\t\t_clearBox.min.x =   _clearBox.min.x + _canvasWidthHalf;\n\t\t\t_clearBox.min.y = - _clearBox.min.y + _canvasHeightHalf;\t\t// higher y value !\n\t\t\t_clearBox.max.x =   _clearBox.max.x + _canvasWidthHalf;\n\t\t\t_clearBox.max.y = - _clearBox.max.y + _canvasHeightHalf;\t\t// lower y value !\n\n\t\t\tif ( _clearAlpha < 1 ) {\n\n\t\t\t\t_context.clearRect(\n\t\t\t\t\t_clearBox.min.x | 0,\n\t\t\t\t\t_clearBox.max.y | 0,\n\t\t\t\t\t( _clearBox.max.x - _clearBox.min.x ) | 0,\n\t\t\t\t\t( _clearBox.min.y - _clearBox.max.y ) | 0\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\tif ( _clearAlpha > 0 ) {\n\n\t\t\t\tsetOpacity( 1 );\n\t\t\t\tsetBlending( THREE.NormalBlending );\n\n\t\t\t\tsetFillStyle( 'rgba(' + Math.floor( _clearColor.r * 255 ) + ',' + Math.floor( _clearColor.g * 255 ) + ',' + Math.floor( _clearColor.b * 255 ) + ',' + _clearAlpha + ')' );\n\n\t\t\t\t_context.fillRect(\n\t\t\t\t\t_clearBox.min.x | 0,\n\t\t\t\t\t_clearBox.max.y | 0,\n\t\t\t\t\t( _clearBox.max.x - _clearBox.min.x ) | 0,\n\t\t\t\t\t( _clearBox.min.y - _clearBox.max.y ) | 0\n\t\t\t\t);\n\n\t\t\t}\n\n\t\t\t_clearBox.makeEmpty();\n\n\t\t}\n\n\t};\n\n\t// compatibility\n\n\tthis.clearColor = function () {};\n\tthis.clearDepth = function () {};\n\tthis.clearStencil = function () {};\n\n\tthis.render = function ( scene, camera ) {\n\n\t\tif ( camera.isCamera === undefined ) {\n\n\t\t\tconsole.error( 'THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tvar background = scene.background;\n\n\t\tif ( background && background.isColor ) {\n\n\t\t\tsetOpacity( 1 );\n\t\t\tsetBlending( THREE.NormalBlending );\n\n\t\t\tsetFillStyle( background.getStyle() );\n\t\t\t_context.fillRect( 0, 0, _canvasWidth, _canvasHeight );\n\n\t\t} else if ( this.autoClear === true ) {\n\n\t\t\tthis.clear();\n\n\t\t}\n\n\t\t_this.info.render.vertices = 0;\n\t\t_this.info.render.faces = 0;\n\n\t\t_context.setTransform( _viewportWidth / _canvasWidth, 0, 0, - _viewportHeight / _canvasHeight, _viewportX, _canvasHeight - _viewportY );\n\t\t_context.translate( _canvasWidthHalf, _canvasHeightHalf );\n\n\t\t_renderData = _projector.projectScene( scene, camera, this.sortObjects, this.sortElements );\n\t\t_elements = _renderData.elements;\n\t\t_lights = _renderData.lights;\n\n\t\t_normalViewMatrix.getNormalMatrix( camera.matrixWorldInverse );\n\n\t\t/* DEBUG\n\t\tsetFillStyle( 'rgba( 0, 255, 255, 0.5 )' );\n\t\t_context.fillRect( _clipBox.min.x, _clipBox.min.y, _clipBox.max.x - _clipBox.min.x, _clipBox.max.y - _clipBox.min.y );\n\t\t*/\n\n\t\tcalculateLights();\n\n\t\tfor ( var e = 0, el = _elements.length; e < el; e ++ ) {\n\n\t\t\tvar element = _elements[ e ];\n\n\t\t\tvar material = element.material;\n\n\t\t\tif ( material === undefined || material.opacity === 0 ) continue;\n\n\t\t\t_elemBox.makeEmpty();\n\n\t\t\tif ( element instanceof THREE.RenderableSprite ) {\n\n\t\t\t\t_v1 = element;\n\t\t\t\t_v1.x *= _canvasWidthHalf; _v1.y *= _canvasHeightHalf;\n\n\t\t\t\trenderSprite( _v1, element, material );\n\n\t\t\t} else if ( element instanceof THREE.RenderableLine ) {\n\n\t\t\t\t_v1 = element.v1; _v2 = element.v2;\n\n\t\t\t\t_v1.positionScreen.x *= _canvasWidthHalf; _v1.positionScreen.y *= _canvasHeightHalf;\n\t\t\t\t_v2.positionScreen.x *= _canvasWidthHalf; _v2.positionScreen.y *= _canvasHeightHalf;\n\n\t\t\t\t_elemBox.setFromPoints( [\n\t\t\t\t\t_v1.positionScreen,\n\t\t\t\t\t_v2.positionScreen\n\t\t\t\t] );\n\n\t\t\t\tif ( _clipBox.intersectsBox( _elemBox ) === true ) {\n\n\t\t\t\t\trenderLine( _v1, _v2, element, material );\n\n\t\t\t\t}\n\n\t\t\t} else if ( element instanceof THREE.RenderableFace ) {\n\n\t\t\t\t_v1 = element.v1; _v2 = element.v2; _v3 = element.v3;\n\n\t\t\t\tif ( _v1.positionScreen.z < - 1 || _v1.positionScreen.z > 1 ) continue;\n\t\t\t\tif ( _v2.positionScreen.z < - 1 || _v2.positionScreen.z > 1 ) continue;\n\t\t\t\tif ( _v3.positionScreen.z < - 1 || _v3.positionScreen.z > 1 ) continue;\n\n\t\t\t\t_v1.positionScreen.x *= _canvasWidthHalf; _v1.positionScreen.y *= _canvasHeightHalf;\n\t\t\t\t_v2.positionScreen.x *= _canvasWidthHalf; _v2.positionScreen.y *= _canvasHeightHalf;\n\t\t\t\t_v3.positionScreen.x *= _canvasWidthHalf; _v3.positionScreen.y *= _canvasHeightHalf;\n\n\t\t\t\tif ( material.overdraw > 0 ) {\n\n\t\t\t\t\texpand( _v1.positionScreen, _v2.positionScreen, material.overdraw );\n\t\t\t\t\texpand( _v2.positionScreen, _v3.positionScreen, material.overdraw );\n\t\t\t\t\texpand( _v3.positionScreen, _v1.positionScreen, material.overdraw );\n\n\t\t\t\t}\n\n\t\t\t\t_elemBox.setFromPoints( [\n\t\t\t\t\t_v1.positionScreen,\n\t\t\t\t\t_v2.positionScreen,\n\t\t\t\t\t_v3.positionScreen\n\t\t\t\t] );\n\n\t\t\t\tif ( _clipBox.intersectsBox( _elemBox ) === true ) {\n\n\t\t\t\t\trenderFace3( _v1, _v2, _v3, 0, 1, 2, element, material );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t/* DEBUG\n\t\t\tsetLineWidth( 1 );\n\t\t\tsetStrokeStyle( 'rgba( 0, 255, 0, 0.5 )' );\n\t\t\t_context.strokeRect( _elemBox.min.x, _elemBox.min.y, _elemBox.max.x - _elemBox.min.x, _elemBox.max.y - _elemBox.min.y );\n\t\t\t*/\n\n\t\t\t_clearBox.union( _elemBox );\n\n\t\t}\n\n\t\t/* DEBUG\n\t\tsetLineWidth( 1 );\n\t\tsetStrokeStyle( 'rgba( 255, 0, 0, 0.5 )' );\n\t\t_context.strokeRect( _clearBox.min.x, _clearBox.min.y, _clearBox.max.x - _clearBox.min.x, _clearBox.max.y - _clearBox.min.y );\n\t\t*/\n\n\t\t_context.setTransform( 1, 0, 0, 1, 0, 0 );\n\n\t};\n\n\t//\n\n\tfunction calculateLights() {\n\n\t\t_ambientLight.setRGB( 0, 0, 0 );\n\t\t_directionalLights.setRGB( 0, 0, 0 );\n\t\t_pointLights.setRGB( 0, 0, 0 );\n\n\t\tfor ( var l = 0, ll = _lights.length; l < ll; l ++ ) {\n\n\t\t\tvar light = _lights[ l ];\n\t\t\tvar lightColor = light.color;\n\n\t\t\tif ( light.isAmbientLight ) {\n\n\t\t\t\t_ambientLight.add( lightColor );\n\n\t\t\t} else if ( light.isDirectionalLight ) {\n\n\t\t\t\t// for sprites\n\n\t\t\t\t_directionalLights.add( lightColor );\n\n\t\t\t} else if ( light.isPointLight ) {\n\n\t\t\t\t// for sprites\n\n\t\t\t\t_pointLights.add( lightColor );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction calculateLight( position, normal, color ) {\n\n\t\tfor ( var l = 0, ll = _lights.length; l < ll; l ++ ) {\n\n\t\t\tvar light = _lights[ l ];\n\n\t\t\t_lightColor.copy( light.color );\n\n\t\t\tif ( light.isDirectionalLight ) {\n\n\t\t\t\tvar lightPosition = _vector3.setFromMatrixPosition( light.matrixWorld ).normalize();\n\n\t\t\t\tvar amount = normal.dot( lightPosition );\n\n\t\t\t\tif ( amount <= 0 ) continue;\n\n\t\t\t\tamount *= light.intensity;\n\n\t\t\t\tcolor.add( _lightColor.multiplyScalar( amount ) );\n\n\t\t\t} else if ( light.isPointLight ) {\n\n\t\t\t\tvar lightPosition = _vector3.setFromMatrixPosition( light.matrixWorld );\n\n\t\t\t\tvar amount = normal.dot( _vector3.subVectors( lightPosition, position ).normalize() );\n\n\t\t\t\tif ( amount <= 0 ) continue;\n\n\t\t\t\tamount *= light.distance == 0 ? 1 : 1 - Math.min( position.distanceTo( lightPosition ) / light.distance, 1 );\n\n\t\t\t\tif ( amount == 0 ) continue;\n\n\t\t\t\tamount *= light.intensity;\n\n\t\t\t\tcolor.add( _lightColor.multiplyScalar( amount ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction renderSprite( v1, element, material ) {\n\n\t\tsetOpacity( material.opacity );\n\t\tsetBlending( material.blending );\n\n\t\tvar scaleX = element.scale.x * _canvasWidthHalf;\n\t\tvar scaleY = element.scale.y * _canvasHeightHalf;\n\n\t\tvar dist = Math.sqrt( scaleX * scaleX + scaleY * scaleY ); // allow for rotated sprite\n\t\t_elemBox.min.set( v1.x - dist, v1.y - dist );\n\t\t_elemBox.max.set( v1.x + dist, v1.y + dist );\n\n\t\tif ( material.isSpriteMaterial ) {\n\n\t\t\tvar texture = material.map;\n\n\t\t\tif ( texture !== null ) {\n\n\t\t\t\tvar pattern = _patterns[ texture.id ];\n\n\t\t\t\tif ( pattern === undefined || pattern.version !== texture.version ) {\n\n\t\t\t\t\tpattern = textureToPattern( texture );\n\t\t\t\t\t_patterns[ texture.id ] = pattern;\n\n\t\t\t\t}\n\n\t\t\t\tif ( pattern.canvas !== undefined ) {\n\n\t\t\t\t\tsetFillStyle( pattern.canvas );\n\n\t\t\t\t\tvar bitmap = texture.image;\n\n\t\t\t\t\tvar ox = bitmap.width * texture.offset.x;\n\t\t\t\t\tvar oy = bitmap.height * texture.offset.y;\n\n\t\t\t\t\tvar sx = bitmap.width * texture.repeat.x;\n\t\t\t\t\tvar sy = bitmap.height * texture.repeat.y;\n\n\t\t\t\t\tvar cx = scaleX / sx;\n\t\t\t\t\tvar cy = scaleY / sy;\n\n\t\t\t\t\t_context.save();\n\t\t\t\t\t_context.translate( v1.x, v1.y );\n\t\t\t\t\tif ( material.rotation !== 0 ) _context.rotate( material.rotation );\n\t\t\t\t\t_context.translate( - scaleX / 2, - scaleY / 2 );\n\t\t\t\t\t_context.scale( cx, cy );\n\t\t\t\t\t_context.translate( - ox, - oy );\n\t\t\t\t\t_context.fillRect( ox, oy, sx, sy );\n\t\t\t\t\t_context.restore();\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t// no texture\n\n\t\t\t\tsetFillStyle( material.color.getStyle() );\n\n\t\t\t\t_context.save();\n\t\t\t\t_context.translate( v1.x, v1.y );\n\t\t\t\tif ( material.rotation !== 0 ) _context.rotate( material.rotation );\n\t\t\t\t_context.scale( scaleX, - scaleY );\n\t\t\t\t_context.fillRect( - 0.5, - 0.5, 1, 1 );\n\t\t\t\t_context.restore();\n\n\t\t\t}\n\n\t\t} else if ( material.isSpriteCanvasMaterial ) {\n\n\t\t\tsetStrokeStyle( material.color.getStyle() );\n\t\t\tsetFillStyle( material.color.getStyle() );\n\n\t\t\t_context.save();\n\t\t\t_context.translate( v1.x, v1.y );\n\t\t\tif ( material.rotation !== 0 ) _context.rotate( material.rotation );\n\t\t\t_context.scale( scaleX, scaleY );\n\n\t\t\tmaterial.program( _context );\n\n\t\t\t_context.restore();\n\n\t\t} else if ( material.isPointsMaterial ) {\n\n\t\t\tsetFillStyle( material.color.getStyle() );\n\n\t\t\t_context.save();\n\t\t\t_context.translate( v1.x, v1.y );\n\t\t\tif ( material.rotation !== 0 ) _context.rotate( material.rotation );\n\t\t\t_context.scale( scaleX * material.size, - scaleY * material.size );\n\t\t\t_context.fillRect( - 0.5, - 0.5, 1, 1 );\n\t\t\t_context.restore();\n\n\t\t}\n\n\t\t/* DEBUG\n\t\tsetStrokeStyle( 'rgb(255,255,0)' );\n\t\t_context.beginPath();\n\t\t_context.moveTo( v1.x - 10, v1.y );\n\t\t_context.lineTo( v1.x + 10, v1.y );\n\t\t_context.moveTo( v1.x, v1.y - 10 );\n\t\t_context.lineTo( v1.x, v1.y + 10 );\n\t\t_context.stroke();\n\t\t*/\n\n\t}\n\n\tfunction renderLine( v1, v2, element, material ) {\n\n\t\tsetOpacity( material.opacity );\n\t\tsetBlending( material.blending );\n\n\t\t_context.beginPath();\n\t\t_context.moveTo( v1.positionScreen.x, v1.positionScreen.y );\n\t\t_context.lineTo( v2.positionScreen.x, v2.positionScreen.y );\n\n\t\tif ( material.isLineBasicMaterial ) {\n\n\t\t\tsetLineWidth( material.linewidth );\n\t\t\tsetLineCap( material.linecap );\n\t\t\tsetLineJoin( material.linejoin );\n\n\t\t\tif ( material.vertexColors !== THREE.VertexColors ) {\n\n\t\t\t\tsetStrokeStyle( material.color.getStyle() );\n\n\t\t\t} else {\n\n\t\t\t\tvar colorStyle1 = element.vertexColors[ 0 ].getStyle();\n\t\t\t\tvar colorStyle2 = element.vertexColors[ 1 ].getStyle();\n\n\t\t\t\tif ( colorStyle1 === colorStyle2 ) {\n\n\t\t\t\t\tsetStrokeStyle( colorStyle1 );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttry {\n\n\t\t\t\t\t\tvar grad = _context.createLinearGradient(\n\t\t\t\t\t\t\tv1.positionScreen.x,\n\t\t\t\t\t\t\tv1.positionScreen.y,\n\t\t\t\t\t\t\tv2.positionScreen.x,\n\t\t\t\t\t\t\tv2.positionScreen.y\n\t\t\t\t\t\t);\n\t\t\t\t\t\tgrad.addColorStop( 0, colorStyle1 );\n\t\t\t\t\t\tgrad.addColorStop( 1, colorStyle2 );\n\n\t\t\t\t\t} catch ( exception ) {\n\n\t\t\t\t\t\tgrad = colorStyle1;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tsetStrokeStyle( grad );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( material.isLineDashedMaterial ) {\n\n\t\t\t\tsetLineDash( [ material.dashSize, material.gapSize ] );\n\n\t\t\t}\n\n\t\t\t_context.stroke();\n\t\t\t_elemBox.expandByScalar( material.linewidth * 2 );\n\n\t\t\tif ( material.isLineDashedMaterial ) {\n\n\t\t\t\tsetLineDash( [] );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tfunction renderFace3( v1, v2, v3, uv1, uv2, uv3, element, material ) {\n\n\t\t_this.info.render.vertices += 3;\n\t\t_this.info.render.faces ++;\n\n\t\tsetOpacity( material.opacity );\n\t\tsetBlending( material.blending );\n\n\t\t_v1x = v1.positionScreen.x; _v1y = v1.positionScreen.y;\n\t\t_v2x = v2.positionScreen.x; _v2y = v2.positionScreen.y;\n\t\t_v3x = v3.positionScreen.x; _v3y = v3.positionScreen.y;\n\n\t\tdrawTriangle( _v1x, _v1y, _v2x, _v2y, _v3x, _v3y );\n\n\t\tif ( ( material.isMeshLambertMaterial || material.isMeshPhongMaterial || material.isMeshStandardMaterial ) && material.map === null ) {\n\n\t\t\t_diffuseColor.copy( material.color );\n\t\t\t_emissiveColor.copy( material.emissive );\n\n\t\t\tif ( material.vertexColors === THREE.FaceColors ) {\n\n\t\t\t\t_diffuseColor.multiply( element.color );\n\n\t\t\t}\n\n\t\t\t_color.copy( _ambientLight );\n\n\t\t\t_centroid.copy( v1.positionWorld ).add( v2.positionWorld ).add( v3.positionWorld ).divideScalar( 3 );\n\n\t\t\tcalculateLight( _centroid, element.normalModel, _color );\n\n\t\t\t_color.multiply( _diffuseColor ).add( _emissiveColor );\n\n\t\t\tmaterial.wireframe === true\n\t\t\t\t ? strokePath( _color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin )\n\t\t\t\t : fillPath( _color );\n\n\t\t} else if ( material.isMeshBasicMaterial || material.isMeshLambertMaterial || material.isMeshPhongMaterial || material.isMeshStandardMaterial ) {\n\n\t\t\tif ( material.map !== null ) {\n\n\t\t\t\tvar mapping = material.map.mapping;\n\n\t\t\t\tif ( mapping === THREE.UVMapping ) {\n\n\t\t\t\t\t_uvs = element.uvs;\n\t\t\t\t\tpatternPath( _v1x, _v1y, _v2x, _v2y, _v3x, _v3y, _uvs[ uv1 ].x, _uvs[ uv1 ].y, _uvs[ uv2 ].x, _uvs[ uv2 ].y, _uvs[ uv3 ].x, _uvs[ uv3 ].y, material.map );\n\n\t\t\t\t}\n\n\t\t\t} else if ( material.envMap !== null ) {\n\n\t\t\t\tif ( material.envMap.mapping === THREE.SphericalReflectionMapping ) {\n\n\t\t\t\t\t_normal.copy( element.vertexNormalsModel[ uv1 ] ).applyMatrix3( _normalViewMatrix );\n\t\t\t\t\t_uv1x = 0.5 * _normal.x + 0.5;\n\t\t\t\t\t_uv1y = 0.5 * _normal.y + 0.5;\n\n\t\t\t\t\t_normal.copy( element.vertexNormalsModel[ uv2 ] ).applyMatrix3( _normalViewMatrix );\n\t\t\t\t\t_uv2x = 0.5 * _normal.x + 0.5;\n\t\t\t\t\t_uv2y = 0.5 * _normal.y + 0.5;\n\n\t\t\t\t\t_normal.copy( element.vertexNormalsModel[ uv3 ] ).applyMatrix3( _normalViewMatrix );\n\t\t\t\t\t_uv3x = 0.5 * _normal.x + 0.5;\n\t\t\t\t\t_uv3y = 0.5 * _normal.y + 0.5;\n\n\t\t\t\t\tpatternPath( _v1x, _v1y, _v2x, _v2y, _v3x, _v3y, _uv1x, _uv1y, _uv2x, _uv2y, _uv3x, _uv3y, material.envMap );\n\n\t\t\t\t}\n\n\t\t\t} else {\n\n\t\t\t\t_color.copy( material.color );\n\n\t\t\t\tif ( material.vertexColors === THREE.FaceColors ) {\n\n\t\t\t\t\t_color.multiply( element.color );\n\n\t\t\t\t}\n\n\t\t\t\tmaterial.wireframe === true\n\t\t\t\t\t ? strokePath( _color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin )\n\t\t\t\t\t : fillPath( _color );\n\n\t\t\t}\n\n\t\t} else if ( material.isMeshNormalMaterial ) {\n\n\t\t\t_normal.copy( element.normalModel ).applyMatrix3( _normalViewMatrix );\n\n\t\t\t_color.setRGB( _normal.x, _normal.y, _normal.z ).multiplyScalar( 0.5 ).addScalar( 0.5 );\n\n\t\t\tmaterial.wireframe === true\n\t\t\t\t ? strokePath( _color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin )\n\t\t\t\t : fillPath( _color );\n\n\t\t} else {\n\n\t\t\t_color.setRGB( 1, 1, 1 );\n\n\t\t\tmaterial.wireframe === true\n\t\t\t\t ? strokePath( _color, material.wireframeLinewidth, material.wireframeLinecap, material.wireframeLinejoin )\n\t\t\t\t : fillPath( _color );\n\n\t\t}\n\n\t}\n\n\t//\n\n\tfunction drawTriangle( x0, y0, x1, y1, x2, y2 ) {\n\n\t\t_context.beginPath();\n\t\t_context.moveTo( x0, y0 );\n\t\t_context.lineTo( x1, y1 );\n\t\t_context.lineTo( x2, y2 );\n\t\t_context.closePath();\n\n\t}\n\n\tfunction strokePath( color, linewidth, linecap, linejoin ) {\n\n\t\tsetLineWidth( linewidth );\n\t\tsetLineCap( linecap );\n\t\tsetLineJoin( linejoin );\n\t\tsetStrokeStyle( color.getStyle() );\n\n\t\t_context.stroke();\n\n\t\t_elemBox.expandByScalar( linewidth * 2 );\n\n\t}\n\n\tfunction fillPath( color ) {\n\n\t\tsetFillStyle( color.getStyle() );\n\t\t_context.fill();\n\n\t}\n\n\tfunction textureToPattern( texture ) {\n\n\t\tif ( texture.version === 0 ||\n\t\t\ttexture instanceof THREE.CompressedTexture ||\n\t\t\ttexture instanceof THREE.DataTexture ) {\n\n\t\t\treturn {\n\t\t\t\tcanvas: undefined,\n\t\t\t\tversion: texture.version\n\t\t\t};\n\n\t\t}\n\n\t\tvar image = texture.image;\n\n\t\tif ( image.complete === false ) {\n\n\t\t\treturn {\n\t\t\t\tcanvas: undefined,\n\t\t\t\tversion: 0\n\t\t\t};\n\n\t\t}\n\n\t\tvar repeatX = texture.wrapS === THREE.RepeatWrapping || texture.wrapS === THREE.MirroredRepeatWrapping;\n\t\tvar repeatY = texture.wrapT === THREE.RepeatWrapping || texture.wrapT === THREE.MirroredRepeatWrapping;\n\n\t\tvar mirrorX = texture.wrapS === THREE.MirroredRepeatWrapping;\n\t\tvar mirrorY = texture.wrapT === THREE.MirroredRepeatWrapping;\n\n\t\t//\n\n\t\tvar canvas = document.createElement( 'canvas' );\n\t\tcanvas.width = image.width * ( mirrorX ? 2 : 1 );\n\t\tcanvas.height = image.height * ( mirrorY ? 2 : 1 );\n\n\t\tvar context = canvas.getContext( '2d' );\n\t\tcontext.setTransform( 1, 0, 0, - 1, 0, image.height );\n\t\tcontext.drawImage( image, 0, 0 );\n\n\t\tif ( mirrorX === true ) {\n\n\t\t\tcontext.setTransform( - 1, 0, 0, - 1, image.width, image.height );\n\t\t\tcontext.drawImage( image, - image.width, 0 );\n\n\t\t}\n\n\t\tif ( mirrorY === true ) {\n\n\t\t\tcontext.setTransform( 1, 0, 0, 1, 0, 0 );\n\t\t\tcontext.drawImage( image, 0, image.height );\n\n\t\t}\n\n\t\tif ( mirrorX === true && mirrorY === true ) {\n\n\t\t\tcontext.setTransform( - 1, 0, 0, 1, image.width, 0 );\n\t\t\tcontext.drawImage( image, - image.width, image.height );\n\n\t\t}\n\n\t\tvar repeat = 'no-repeat';\n\n\t\tif ( repeatX === true && repeatY === true ) {\n\n\t\t\trepeat = 'repeat';\n\n\t\t} else if ( repeatX === true ) {\n\n\t\t\trepeat = 'repeat-x';\n\n\t\t} else if ( repeatY === true ) {\n\n\t\t\trepeat = 'repeat-y';\n\n\t\t}\n\n\t\tvar pattern = _context.createPattern( canvas, repeat );\n\n\t\tif ( texture.onUpdate ) texture.onUpdate( texture );\n\n\t\treturn {\n\t\t\tcanvas: pattern,\n\t\t\tversion: texture.version\n\t\t};\n\n\t}\n\n\tfunction patternPath( x0, y0, x1, y1, x2, y2, u0, v0, u1, v1, u2, v2, texture ) {\n\n\t\tvar pattern = _patterns[ texture.id ];\n\n\t\tif ( pattern === undefined || pattern.version !== texture.version ) {\n\n\t\t\tpattern = textureToPattern( texture );\n\t\t\t_patterns[ texture.id ] = pattern;\n\n\t\t}\n\n\t\tif ( pattern.canvas !== undefined ) {\n\n\t\t\tsetFillStyle( pattern.canvas );\n\n\t\t} else {\n\n\t\t\tsetFillStyle( 'rgba( 0, 0, 0, 1)' );\n\t\t\t_context.fill();\n\t\t\treturn;\n\n\t\t}\n\n\t\t// http://extremelysatisfactorytotalitarianism.com/blog/?p=2120\n\n\t\tvar a, b, c, d, e, f, det, idet,\n\t\t\toffsetX = texture.offset.x / texture.repeat.x,\n\t\t\toffsetY = texture.offset.y / texture.repeat.y,\n\t\t\twidth = texture.image.width * texture.repeat.x,\n\t\t\theight = texture.image.height * texture.repeat.y;\n\n\t\tu0 = ( u0 + offsetX ) * width;\n\t\tv0 = ( v0 + offsetY ) * height;\n\n\t\tu1 = ( u1 + offsetX ) * width;\n\t\tv1 = ( v1 + offsetY ) * height;\n\n\t\tu2 = ( u2 + offsetX ) * width;\n\t\tv2 = ( v2 + offsetY ) * height;\n\n\t\tx1 -= x0; y1 -= y0;\n\t\tx2 -= x0; y2 -= y0;\n\n\t\tu1 -= u0; v1 -= v0;\n\t\tu2 -= u0; v2 -= v0;\n\n\t\tdet = u1 * v2 - u2 * v1;\n\n\t\tif ( det === 0 ) return;\n\n\t\tidet = 1 / det;\n\n\t\ta = ( v2 * x1 - v1 * x2 ) * idet;\n\t\tb = ( v2 * y1 - v1 * y2 ) * idet;\n\t\tc = ( u1 * x2 - u2 * x1 ) * idet;\n\t\td = ( u1 * y2 - u2 * y1 ) * idet;\n\n\t\te = x0 - a * u0 - c * v0;\n\t\tf = y0 - b * u0 - d * v0;\n\n\t\t_context.save();\n\t\t_context.transform( a, b, c, d, e, f );\n\t\t_context.fill();\n\t\t_context.restore();\n\n\t}\n\n\t/*\n\tfunction clipImage( x0, y0, x1, y1, x2, y2, u0, v0, u1, v1, u2, v2, image ) {\n\n\t\t// http://extremelysatisfactorytotalitarianism.com/blog/?p=2120\n\n\t\tvar a, b, c, d, e, f, det, idet,\n\t\twidth = image.width - 1,\n\t\theight = image.height - 1;\n\n\t\tu0 *= width; v0 *= height;\n\t\tu1 *= width; v1 *= height;\n\t\tu2 *= width; v2 *= height;\n\n\t\tx1 -= x0; y1 -= y0;\n\t\tx2 -= x0; y2 -= y0;\n\n\t\tu1 -= u0; v1 -= v0;\n\t\tu2 -= u0; v2 -= v0;\n\n\t\tdet = u1 * v2 - u2 * v1;\n\n\t\tidet = 1 / det;\n\n\t\ta = ( v2 * x1 - v1 * x2 ) * idet;\n\t\tb = ( v2 * y1 - v1 * y2 ) * idet;\n\t\tc = ( u1 * x2 - u2 * x1 ) * idet;\n\t\td = ( u1 * y2 - u2 * y1 ) * idet;\n\n\t\te = x0 - a * u0 - c * v0;\n\t\tf = y0 - b * u0 - d * v0;\n\n\t\t_context.save();\n\t\t_context.transform( a, b, c, d, e, f );\n\t\t_context.clip();\n\t\t_context.drawImage( image, 0, 0 );\n\t\t_context.restore();\n\n\t}\n\t*/\n\n\t// Hide anti-alias gaps\n\n\tfunction expand( v1, v2, pixels ) {\n\n\t\tvar x = v2.x - v1.x, y = v2.y - v1.y,\n\t\t\tdet = x * x + y * y, idet;\n\n\t\tif ( det === 0 ) return;\n\n\t\tidet = pixels / Math.sqrt( det );\n\n\t\tx *= idet; y *= idet;\n\n\t\tv2.x += x; v2.y += y;\n\t\tv1.x -= x; v1.y -= y;\n\n\t}\n\n\t// Context cached methods.\n\n\tfunction setOpacity( value ) {\n\n\t\tif ( _contextGlobalAlpha !== value ) {\n\n\t\t\t_context.globalAlpha = value;\n\t\t\t_contextGlobalAlpha = value;\n\n\t\t}\n\n\t}\n\n\tfunction setBlending( value ) {\n\n\t\tif ( _contextGlobalCompositeOperation !== value ) {\n\n\t\t\tif ( value === THREE.NormalBlending ) {\n\n\t\t\t\t_context.globalCompositeOperation = 'source-over';\n\n\t\t\t} else if ( value === THREE.AdditiveBlending ) {\n\n\t\t\t\t_context.globalCompositeOperation = 'lighter';\n\n\t\t\t} else if ( value === THREE.SubtractiveBlending ) {\n\n\t\t\t\t_context.globalCompositeOperation = 'darker';\n\n\t\t\t} else if ( value === THREE.MultiplyBlending ) {\n\n\t\t\t\t_context.globalCompositeOperation = 'multiply';\n\n\t\t\t}\n\n\t\t\t_contextGlobalCompositeOperation = value;\n\n\t\t}\n\n\t}\n\n\tfunction setLineWidth( value ) {\n\n\t\tif ( _contextLineWidth !== value ) {\n\n\t\t\t_context.lineWidth = value;\n\t\t\t_contextLineWidth = value;\n\n\t\t}\n\n\t}\n\n\tfunction setLineCap( value ) {\n\n\t\t// \"butt\", \"round\", \"square\"\n\n\t\tif ( _contextLineCap !== value ) {\n\n\t\t\t_context.lineCap = value;\n\t\t\t_contextLineCap = value;\n\n\t\t}\n\n\t}\n\n\tfunction setLineJoin( value ) {\n\n\t\t// \"round\", \"bevel\", \"miter\"\n\n\t\tif ( _contextLineJoin !== value ) {\n\n\t\t\t_context.lineJoin = value;\n\t\t\t_contextLineJoin = value;\n\n\t\t}\n\n\t}\n\n\tfunction setStrokeStyle( value ) {\n\n\t\tif ( _contextStrokeStyle !== value ) {\n\n\t\t\t_context.strokeStyle = value;\n\t\t\t_contextStrokeStyle = value;\n\n\t\t}\n\n\t}\n\n\tfunction setFillStyle( value ) {\n\n\t\tif ( _contextFillStyle !== value ) {\n\n\t\t\t_context.fillStyle = value;\n\t\t\t_contextFillStyle = value;\n\n\t\t}\n\n\t}\n\n\tfunction setLineDash( value ) {\n\n\t\tif ( _contextLineDash.length !== value.length ) {\n\n\t\t\t_context.setLineDash( value );\n\t\t\t_contextLineDash = value;\n\n\t\t}\n\n\t}\n\n};\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/**\n * @author mrdoob / http://mrdoob.com/\n * @author supereggbert / http://www.paulbrunt.co.uk/\n * @author julianwa / https://github.com/julianwa\n */\n\nTHREE.RenderableObject = function () {\n\n\tthis.id = 0;\n\n\tthis.object = null;\n\tthis.z = 0;\n\tthis.renderOrder = 0;\n\n};\n\n//\n\nTHREE.RenderableFace = function () {\n\n\tthis.id = 0;\n\n\tthis.v1 = new THREE.RenderableVertex();\n\tthis.v2 = new THREE.RenderableVertex();\n\tthis.v3 = new THREE.RenderableVertex();\n\n\tthis.normalModel = new THREE.Vector3();\n\n\tthis.vertexNormalsModel = [ new THREE.Vector3(), new THREE.Vector3(), new THREE.Vector3() ];\n\tthis.vertexNormalsLength = 0;\n\n\tthis.color = new THREE.Color();\n\tthis.material = null;\n\tthis.uvs = [ new THREE.Vector2(), new THREE.Vector2(), new THREE.Vector2() ];\n\n\tthis.z = 0;\n\tthis.renderOrder = 0;\n\n};\n\n//\n\nTHREE.RenderableVertex = function () {\n\n\tthis.position = new THREE.Vector3();\n\tthis.positionWorld = new THREE.Vector3();\n\tthis.positionScreen = new THREE.Vector4();\n\n\tthis.visible = true;\n\n};\n\nTHREE.RenderableVertex.prototype.copy = function ( vertex ) {\n\n\tthis.positionWorld.copy( vertex.positionWorld );\n\tthis.positionScreen.copy( vertex.positionScreen );\n\n};\n\n//\n\nTHREE.RenderableLine = function () {\n\n\tthis.id = 0;\n\n\tthis.v1 = new THREE.RenderableVertex();\n\tthis.v2 = new THREE.RenderableVertex();\n\n\tthis.vertexColors = [ new THREE.Color(), new THREE.Color() ];\n\tthis.material = null;\n\n\tthis.z = 0;\n\tthis.renderOrder = 0;\n\n};\n\n//\n\nTHREE.RenderableSprite = function () {\n\n\tthis.id = 0;\n\n\tthis.object = null;\n\n\tthis.x = 0;\n\tthis.y = 0;\n\tthis.z = 0;\n\n\tthis.rotation = 0;\n\tthis.scale = new THREE.Vector2();\n\n\tthis.material = null;\n\tthis.renderOrder = 0;\n\n};\n\n//\n\nTHREE.Projector = function () {\n\n\tvar _object, _objectCount, _objectPool = [], _objectPoolLength = 0,\n\t\t_vertex, _vertexCount, _vertexPool = [], _vertexPoolLength = 0,\n\t\t_face, _faceCount, _facePool = [], _facePoolLength = 0,\n\t\t_line, _lineCount, _linePool = [], _linePoolLength = 0,\n\t\t_sprite, _spriteCount, _spritePool = [], _spritePoolLength = 0,\n\n\t\t_renderData = { objects: [], lights: [], elements: [] },\n\n\t\t_vector3 = new THREE.Vector3(),\n\t\t_vector4 = new THREE.Vector4(),\n\n\t\t_clipBox = new THREE.Box3( new THREE.Vector3( - 1, - 1, - 1 ), new THREE.Vector3( 1, 1, 1 ) ),\n\t\t_boundingBox = new THREE.Box3(),\n\t\t_points3 = new Array( 3 ),\n\n\t\t_viewMatrix = new THREE.Matrix4(),\n\t\t_viewProjectionMatrix = new THREE.Matrix4(),\n\n\t\t_modelMatrix,\n\t\t_modelViewProjectionMatrix = new THREE.Matrix4(),\n\n\t\t_normalMatrix = new THREE.Matrix3(),\n\n\t\t_frustum = new THREE.Frustum(),\n\n\t\t_clippedVertex1PositionScreen = new THREE.Vector4(),\n\t\t_clippedVertex2PositionScreen = new THREE.Vector4();\n\n\t//\n\n\tthis.projectVector = function ( vector, camera ) {\n\n\t\tconsole.warn( 'THREE.Projector: .projectVector() is now vector.project().' );\n\t\tvector.project( camera );\n\n\t};\n\n\tthis.unprojectVector = function ( vector, camera ) {\n\n\t\tconsole.warn( 'THREE.Projector: .unprojectVector() is now vector.unproject().' );\n\t\tvector.unproject( camera );\n\n\t};\n\n\tthis.pickingRay = function () {\n\n\t\tconsole.error( 'THREE.Projector: .pickingRay() is now raycaster.setFromCamera().' );\n\n\t};\n\n\t//\n\n\tvar RenderList = function () {\n\n\t\tvar normals = [];\n\t\tvar colors = [];\n\t\tvar uvs = [];\n\n\t\tvar object = null;\n\t\tvar material = null;\n\n\t\tvar normalMatrix = new THREE.Matrix3();\n\n\t\tfunction setObject( value ) {\n\n\t\t\tobject = value;\n\t\t\tmaterial = object.material;\n\n\t\t\tnormalMatrix.getNormalMatrix( object.matrixWorld );\n\n\t\t\tnormals.length = 0;\n\t\t\tcolors.length = 0;\n\t\t\tuvs.length = 0;\n\n\t\t}\n\n\t\tfunction projectVertex( vertex ) {\n\n\t\t\tvar position = vertex.position;\n\t\t\tvar positionWorld = vertex.positionWorld;\n\t\t\tvar positionScreen = vertex.positionScreen;\n\n\t\t\tpositionWorld.copy( position ).applyMatrix4( _modelMatrix );\n\t\t\tpositionScreen.copy( positionWorld ).applyMatrix4( _viewProjectionMatrix );\n\n\t\t\tvar invW = 1 / positionScreen.w;\n\n\t\t\tpositionScreen.x *= invW;\n\t\t\tpositionScreen.y *= invW;\n\t\t\tpositionScreen.z *= invW;\n\n\t\t\tvertex.visible = positionScreen.x >= - 1 && positionScreen.x <= 1 &&\n\t\t\t\t\t positionScreen.y >= - 1 && positionScreen.y <= 1 &&\n\t\t\t\t\t positionScreen.z >= - 1 && positionScreen.z <= 1;\n\n\t\t}\n\n\t\tfunction pushVertex( x, y, z ) {\n\n\t\t\t_vertex = getNextVertexInPool();\n\t\t\t_vertex.position.set( x, y, z );\n\n\t\t\tprojectVertex( _vertex );\n\n\t\t}\n\n\t\tfunction pushNormal( x, y, z ) {\n\n\t\t\tnormals.push( x, y, z );\n\n\t\t}\n\n\t\tfunction pushColor( r, g, b ) {\n\n\t\t\tcolors.push( r, g, b );\n\n\t\t}\n\n\t\tfunction pushUv( x, y ) {\n\n\t\t\tuvs.push( x, y );\n\n\t\t}\n\n\t\tfunction checkTriangleVisibility( v1, v2, v3 ) {\n\n\t\t\tif ( v1.visible === true || v2.visible === true || v3.visible === true ) return true;\n\n\t\t\t_points3[ 0 ] = v1.positionScreen;\n\t\t\t_points3[ 1 ] = v2.positionScreen;\n\t\t\t_points3[ 2 ] = v3.positionScreen;\n\n\t\t\treturn _clipBox.intersectsBox( _boundingBox.setFromPoints( _points3 ) );\n\n\t\t}\n\n\t\tfunction checkBackfaceCulling( v1, v2, v3 ) {\n\n\t\t\treturn ( ( v3.positionScreen.x - v1.positionScreen.x ) *\n\t\t\t\t    ( v2.positionScreen.y - v1.positionScreen.y ) -\n\t\t\t\t    ( v3.positionScreen.y - v1.positionScreen.y ) *\n\t\t\t\t    ( v2.positionScreen.x - v1.positionScreen.x ) ) < 0;\n\n\t\t}\n\n\t\tfunction pushLine( a, b ) {\n\n\t\t\tvar v1 = _vertexPool[ a ];\n\t\t\tvar v2 = _vertexPool[ b ];\n\n\t\t\t// Clip\n\n\t\t\tv1.positionScreen.copy( v1.position ).applyMatrix4( _modelViewProjectionMatrix );\n\t\t\tv2.positionScreen.copy( v2.position ).applyMatrix4( _modelViewProjectionMatrix );\n\n\t\t\tif ( clipLine( v1.positionScreen, v2.positionScreen ) === true ) {\n\n\t\t\t\t// Perform the perspective divide\n\t\t\t\tv1.positionScreen.multiplyScalar( 1 / v1.positionScreen.w );\n\t\t\t\tv2.positionScreen.multiplyScalar( 1 / v2.positionScreen.w );\n\n\t\t\t\t_line = getNextLineInPool();\n\t\t\t\t_line.id = object.id;\n\t\t\t\t_line.v1.copy( v1 );\n\t\t\t\t_line.v2.copy( v2 );\n\t\t\t\t_line.z = Math.max( v1.positionScreen.z, v2.positionScreen.z );\n\t\t\t\t_line.renderOrder = object.renderOrder;\n\n\t\t\t\t_line.material = object.material;\n\n\t\t\t\tif ( object.material.vertexColors === THREE.VertexColors ) {\n\n\t\t\t\t\t_line.vertexColors[ 0 ].fromArray( colors, a * 3 );\n\t\t\t\t\t_line.vertexColors[ 1 ].fromArray( colors, b * 3 );\n\n\t\t\t\t}\n\n\t\t\t\t_renderData.elements.push( _line );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfunction pushTriangle( a, b, c ) {\n\n\t\t\tvar v1 = _vertexPool[ a ];\n\t\t\tvar v2 = _vertexPool[ b ];\n\t\t\tvar v3 = _vertexPool[ c ];\n\n\t\t\tif ( checkTriangleVisibility( v1, v2, v3 ) === false ) return;\n\n\t\t\tif ( material.side === THREE.DoubleSide || checkBackfaceCulling( v1, v2, v3 ) === true ) {\n\n\t\t\t\t_face = getNextFaceInPool();\n\n\t\t\t\t_face.id = object.id;\n\t\t\t\t_face.v1.copy( v1 );\n\t\t\t\t_face.v2.copy( v2 );\n\t\t\t\t_face.v3.copy( v3 );\n\t\t\t\t_face.z = ( v1.positionScreen.z + v2.positionScreen.z + v3.positionScreen.z ) / 3;\n\t\t\t\t_face.renderOrder = object.renderOrder;\n\n\t\t\t\t// use first vertex normal as face normal\n\n\t\t\t\t_face.normalModel.fromArray( normals, a * 3 );\n\t\t\t\t_face.normalModel.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t\tfor ( var i = 0; i < 3; i ++ ) {\n\n\t\t\t\t\tvar normal = _face.vertexNormalsModel[ i ];\n\t\t\t\t\tnormal.fromArray( normals, arguments[ i ] * 3 );\n\t\t\t\t\tnormal.applyMatrix3( normalMatrix ).normalize();\n\n\t\t\t\t\tvar uv = _face.uvs[ i ];\n\t\t\t\t\tuv.fromArray( uvs, arguments[ i ] * 2 );\n\n\t\t\t\t}\n\n\t\t\t\t_face.vertexNormalsLength = 3;\n\n\t\t\t\t_face.material = object.material;\n\n\t\t\t\t_renderData.elements.push( _face );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn {\n\t\t\tsetObject: setObject,\n\t\t\tprojectVertex: projectVertex,\n\t\t\tcheckTriangleVisibility: checkTriangleVisibility,\n\t\t\tcheckBackfaceCulling: checkBackfaceCulling,\n\t\t\tpushVertex: pushVertex,\n\t\t\tpushNormal: pushNormal,\n\t\t\tpushColor: pushColor,\n\t\t\tpushUv: pushUv,\n\t\t\tpushLine: pushLine,\n\t\t\tpushTriangle: pushTriangle\n\t\t};\n\n\t};\n\n\tvar renderList = new RenderList();\n\n\tfunction projectObject( object ) {\n\n\t\tif ( object.visible === false ) return;\n\n\t\tif ( object instanceof THREE.Light ) {\n\n\t\t\t_renderData.lights.push( object );\n\n\t\t} else if ( object instanceof THREE.Mesh || object instanceof THREE.Line || object instanceof THREE.Points ) {\n\n\t\t\tif ( object.material.visible === false ) return;\n\t\t\tif ( object.frustumCulled === true && _frustum.intersectsObject( object ) === false ) return;\n\n\t\t\taddObject( object );\n\n\t\t} else if ( object instanceof THREE.Sprite ) {\n\n\t\t\tif ( object.material.visible === false ) return;\n\t\t\tif ( object.frustumCulled === true && _frustum.intersectsSprite( object ) === false ) return;\n\n\t\t\taddObject( object );\n\n\t\t}\n\n\t\tvar children = object.children;\n\n\t\tfor ( var i = 0, l = children.length; i < l; i ++ ) {\n\n\t\t\tprojectObject( children[ i ] );\n\n\t\t}\n\n\t}\n\n\tfunction addObject( object ) {\n\n\t\t_object = getNextObjectInPool();\n\t\t_object.id = object.id;\n\t\t_object.object = object;\n\n\t\t_vector3.setFromMatrixPosition( object.matrixWorld );\n\t\t_vector3.applyMatrix4( _viewProjectionMatrix );\n\t\t_object.z = _vector3.z;\n\t\t_object.renderOrder = object.renderOrder;\n\n\t\t_renderData.objects.push( _object );\n\n\t}\n\n\tthis.projectScene = function ( scene, camera, sortObjects, sortElements ) {\n\n\t\t_faceCount = 0;\n\t\t_lineCount = 0;\n\t\t_spriteCount = 0;\n\n\t\t_renderData.elements.length = 0;\n\n\t\tif ( scene.autoUpdate === true ) scene.updateMatrixWorld();\n\t\tif ( camera.parent === null ) camera.updateMatrixWorld();\n\n\t\t_viewMatrix.copy( camera.matrixWorldInverse );\n\t\t_viewProjectionMatrix.multiplyMatrices( camera.projectionMatrix, _viewMatrix );\n\n\t\t_frustum.setFromMatrix( _viewProjectionMatrix );\n\n\t\t//\n\n\t\t_objectCount = 0;\n\n\t\t_renderData.objects.length = 0;\n\t\t_renderData.lights.length = 0;\n\n\t\tprojectObject( scene );\n\n\t\tif ( sortObjects === true ) {\n\n\t\t\t_renderData.objects.sort( painterSort );\n\n\t\t}\n\n\t\t//\n\n\t\tvar objects = _renderData.objects;\n\n\t\tfor ( var o = 0, ol = objects.length; o < ol; o ++ ) {\n\n\t\t\tvar object = objects[ o ].object;\n\t\t\tvar geometry = object.geometry;\n\n\t\t\trenderList.setObject( object );\n\n\t\t\t_modelMatrix = object.matrixWorld;\n\n\t\t\t_vertexCount = 0;\n\n\t\t\tif ( object instanceof THREE.Mesh ) {\n\n\t\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\n\n\t\t\t\t\tvar attributes = geometry.attributes;\n\t\t\t\t\tvar groups = geometry.groups;\n\n\t\t\t\t\tif ( attributes.position === undefined ) continue;\n\n\t\t\t\t\tvar positions = attributes.position.array;\n\n\t\t\t\t\tfor ( var i = 0, l = positions.length; i < l; i += 3 ) {\n\n\t\t\t\t\t\trenderList.pushVertex( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.normal !== undefined ) {\n\n\t\t\t\t\t\tvar normals = attributes.normal.array;\n\n\t\t\t\t\t\tfor ( var i = 0, l = normals.length; i < l; i += 3 ) {\n\n\t\t\t\t\t\t\trenderList.pushNormal( normals[ i ], normals[ i + 1 ], normals[ i + 2 ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( attributes.uv !== undefined ) {\n\n\t\t\t\t\t\tvar uvs = attributes.uv.array;\n\n\t\t\t\t\t\tfor ( var i = 0, l = uvs.length; i < l; i += 2 ) {\n\n\t\t\t\t\t\t\trenderList.pushUv( uvs[ i ], uvs[ i + 1 ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( geometry.index !== null ) {\n\n\t\t\t\t\t\tvar indices = geometry.index.array;\n\n\t\t\t\t\t\tif ( groups.length > 0 ) {\n\n\t\t\t\t\t\t\tfor ( var g = 0; g < groups.length; g ++ ) {\n\n\t\t\t\t\t\t\t\tvar group = groups[ g ];\n\n\t\t\t\t\t\t\t\tfor ( var i = group.start, l = group.start + group.count; i < l; i += 3 ) {\n\n\t\t\t\t\t\t\t\t\trenderList.pushTriangle( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\n\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i += 3 ) {\n\n\t\t\t\t\t\t\t\trenderList.pushTriangle( indices[ i ], indices[ i + 1 ], indices[ i + 2 ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tfor ( var i = 0, l = positions.length / 3; i < l; i += 3 ) {\n\n\t\t\t\t\t\t\trenderList.pushTriangle( i, i + 1, i + 2 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( geometry instanceof THREE.Geometry ) {\n\n\t\t\t\t\tvar vertices = geometry.vertices;\n\t\t\t\t\tvar faces = geometry.faces;\n\t\t\t\t\tvar faceVertexUvs = geometry.faceVertexUvs[ 0 ];\n\n\t\t\t\t\t_normalMatrix.getNormalMatrix( _modelMatrix );\n\n\t\t\t\t\tvar material = object.material;\n\n\t\t\t\t\tvar isMultiMaterial = Array.isArray( material );\n\n\t\t\t\t\tfor ( var v = 0, vl = vertices.length; v < vl; v ++ ) {\n\n\t\t\t\t\t\tvar vertex = vertices[ v ];\n\n\t\t\t\t\t\t_vector3.copy( vertex );\n\n\t\t\t\t\t\tif ( material.morphTargets === true ) {\n\n\t\t\t\t\t\t\tvar morphTargets = geometry.morphTargets;\n\t\t\t\t\t\t\tvar morphInfluences = object.morphTargetInfluences;\n\n\t\t\t\t\t\t\tfor ( var t = 0, tl = morphTargets.length; t < tl; t ++ ) {\n\n\t\t\t\t\t\t\t\tvar influence = morphInfluences[ t ];\n\n\t\t\t\t\t\t\t\tif ( influence === 0 ) continue;\n\n\t\t\t\t\t\t\t\tvar target = morphTargets[ t ];\n\t\t\t\t\t\t\t\tvar targetVertex = target.vertices[ v ];\n\n\t\t\t\t\t\t\t\t_vector3.x += ( targetVertex.x - vertex.x ) * influence;\n\t\t\t\t\t\t\t\t_vector3.y += ( targetVertex.y - vertex.y ) * influence;\n\t\t\t\t\t\t\t\t_vector3.z += ( targetVertex.z - vertex.z ) * influence;\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\trenderList.pushVertex( _vector3.x, _vector3.y, _vector3.z );\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfor ( var f = 0, fl = faces.length; f < fl; f ++ ) {\n\n\t\t\t\t\t\tvar face = faces[ f ];\n\n\t\t\t\t\t\tmaterial = isMultiMaterial === true\n\t\t\t\t\t\t\t ? object.material[ face.materialIndex ]\n\t\t\t\t\t\t\t : object.material;\n\n\t\t\t\t\t\tif ( material === undefined ) continue;\n\n\t\t\t\t\t\tvar side = material.side;\n\n\t\t\t\t\t\tvar v1 = _vertexPool[ face.a ];\n\t\t\t\t\t\tvar v2 = _vertexPool[ face.b ];\n\t\t\t\t\t\tvar v3 = _vertexPool[ face.c ];\n\n\t\t\t\t\t\tif ( renderList.checkTriangleVisibility( v1, v2, v3 ) === false ) continue;\n\n\t\t\t\t\t\tvar visible = renderList.checkBackfaceCulling( v1, v2, v3 );\n\n\t\t\t\t\t\tif ( side !== THREE.DoubleSide ) {\n\n\t\t\t\t\t\t\tif ( side === THREE.FrontSide && visible === false ) continue;\n\t\t\t\t\t\t\tif ( side === THREE.BackSide && visible === true ) continue;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_face = getNextFaceInPool();\n\n\t\t\t\t\t\t_face.id = object.id;\n\t\t\t\t\t\t_face.v1.copy( v1 );\n\t\t\t\t\t\t_face.v2.copy( v2 );\n\t\t\t\t\t\t_face.v3.copy( v3 );\n\n\t\t\t\t\t\t_face.normalModel.copy( face.normal );\n\n\t\t\t\t\t\tif ( visible === false && ( side === THREE.BackSide || side === THREE.DoubleSide ) ) {\n\n\t\t\t\t\t\t\t_face.normalModel.negate();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_face.normalModel.applyMatrix3( _normalMatrix ).normalize();\n\n\t\t\t\t\t\tvar faceVertexNormals = face.vertexNormals;\n\n\t\t\t\t\t\tfor ( var n = 0, nl = Math.min( faceVertexNormals.length, 3 ); n < nl; n ++ ) {\n\n\t\t\t\t\t\t\tvar normalModel = _face.vertexNormalsModel[ n ];\n\t\t\t\t\t\t\tnormalModel.copy( faceVertexNormals[ n ] );\n\n\t\t\t\t\t\t\tif ( visible === false && ( side === THREE.BackSide || side === THREE.DoubleSide ) ) {\n\n\t\t\t\t\t\t\t\tnormalModel.negate();\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tnormalModel.applyMatrix3( _normalMatrix ).normalize();\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_face.vertexNormalsLength = faceVertexNormals.length;\n\n\t\t\t\t\t\tvar vertexUvs = faceVertexUvs[ f ];\n\n\t\t\t\t\t\tif ( vertexUvs !== undefined ) {\n\n\t\t\t\t\t\t\tfor ( var u = 0; u < 3; u ++ ) {\n\n\t\t\t\t\t\t\t\t_face.uvs[ u ].copy( vertexUvs[ u ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t_face.color = face.color;\n\t\t\t\t\t\t_face.material = material;\n\n\t\t\t\t\t\t_face.z = ( v1.positionScreen.z + v2.positionScreen.z + v3.positionScreen.z ) / 3;\n\t\t\t\t\t\t_face.renderOrder = object.renderOrder;\n\n\t\t\t\t\t\t_renderData.elements.push( _face );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( object instanceof THREE.Line ) {\n\n\t\t\t\t_modelViewProjectionMatrix.multiplyMatrices( _viewProjectionMatrix, _modelMatrix );\n\n\t\t\t\tif ( geometry instanceof THREE.BufferGeometry ) {\n\n\t\t\t\t\tvar attributes = geometry.attributes;\n\n\t\t\t\t\tif ( attributes.position !== undefined ) {\n\n\t\t\t\t\t\tvar positions = attributes.position.array;\n\n\t\t\t\t\t\tfor ( var i = 0, l = positions.length; i < l; i += 3 ) {\n\n\t\t\t\t\t\t\trenderList.pushVertex( positions[ i ], positions[ i + 1 ], positions[ i + 2 ] );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( attributes.color !== undefined ) {\n\n\t\t\t\t\t\t\tvar colors = attributes.color.array;\n\n\t\t\t\t\t\t\tfor ( var i = 0, l = colors.length; i < l; i += 3 ) {\n\n\t\t\t\t\t\t\t\trenderList.pushColor( colors[ i ], colors[ i + 1 ], colors[ i + 2 ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ( geometry.index !== null ) {\n\n\t\t\t\t\t\t\tvar indices = geometry.index.array;\n\n\t\t\t\t\t\t\tfor ( var i = 0, l = indices.length; i < l; i += 2 ) {\n\n\t\t\t\t\t\t\t\trenderList.pushLine( indices[ i ], indices[ i + 1 ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t} else {\n\n\t\t\t\t\t\t\tvar step = object instanceof THREE.LineSegments ? 2 : 1;\n\n\t\t\t\t\t\t\tfor ( var i = 0, l = ( positions.length / 3 ) - 1; i < l; i += step ) {\n\n\t\t\t\t\t\t\t\trenderList.pushLine( i, i + 1 );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( geometry instanceof THREE.Geometry ) {\n\n\t\t\t\t\tvar vertices = object.geometry.vertices;\n\n\t\t\t\t\tif ( vertices.length === 0 ) continue;\n\n\t\t\t\t\tv1 = getNextVertexInPool();\n\t\t\t\t\tv1.positionScreen.copy( vertices[ 0 ] ).applyMatrix4( _modelViewProjectionMatrix );\n\n\t\t\t\t\tvar step = object instanceof THREE.LineSegments ? 2 : 1;\n\n\t\t\t\t\tfor ( var v = 1, vl = vertices.length; v < vl; v ++ ) {\n\n\t\t\t\t\t\tv1 = getNextVertexInPool();\n\t\t\t\t\t\tv1.positionScreen.copy( vertices[ v ] ).applyMatrix4( _modelViewProjectionMatrix );\n\n\t\t\t\t\t\tif ( ( v + 1 ) % step > 0 ) continue;\n\n\t\t\t\t\t\tv2 = _vertexPool[ _vertexCount - 2 ];\n\n\t\t\t\t\t\t_clippedVertex1PositionScreen.copy( v1.positionScreen );\n\t\t\t\t\t\t_clippedVertex2PositionScreen.copy( v2.positionScreen );\n\n\t\t\t\t\t\tif ( clipLine( _clippedVertex1PositionScreen, _clippedVertex2PositionScreen ) === true ) {\n\n\t\t\t\t\t\t\t// Perform the perspective divide\n\t\t\t\t\t\t\t_clippedVertex1PositionScreen.multiplyScalar( 1 / _clippedVertex1PositionScreen.w );\n\t\t\t\t\t\t\t_clippedVertex2PositionScreen.multiplyScalar( 1 / _clippedVertex2PositionScreen.w );\n\n\t\t\t\t\t\t\t_line = getNextLineInPool();\n\n\t\t\t\t\t\t\t_line.id = object.id;\n\t\t\t\t\t\t\t_line.v1.positionScreen.copy( _clippedVertex1PositionScreen );\n\t\t\t\t\t\t\t_line.v2.positionScreen.copy( _clippedVertex2PositionScreen );\n\n\t\t\t\t\t\t\t_line.z = Math.max( _clippedVertex1PositionScreen.z, _clippedVertex2PositionScreen.z );\n\t\t\t\t\t\t\t_line.renderOrder = object.renderOrder;\n\n\t\t\t\t\t\t\t_line.material = object.material;\n\n\t\t\t\t\t\t\tif ( object.material.vertexColors === THREE.VertexColors ) {\n\n\t\t\t\t\t\t\t\t_line.vertexColors[ 0 ].copy( object.geometry.colors[ v ] );\n\t\t\t\t\t\t\t\t_line.vertexColors[ 1 ].copy( object.geometry.colors[ v - 1 ] );\n\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t_renderData.elements.push( _line );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( object instanceof THREE.Points ) {\n\n\t\t\t\t_modelViewProjectionMatrix.multiplyMatrices( _viewProjectionMatrix, _modelMatrix );\n\n\t\t\t\tif ( geometry instanceof THREE.Geometry ) {\n\n\t\t\t\t\tvar vertices = object.geometry.vertices;\n\n\t\t\t\t\tfor ( var v = 0, vl = vertices.length; v < vl; v ++ ) {\n\n\t\t\t\t\t\tvar vertex = vertices[ v ];\n\n\t\t\t\t\t\t_vector4.set( vertex.x, vertex.y, vertex.z, 1 );\n\t\t\t\t\t\t_vector4.applyMatrix4( _modelViewProjectionMatrix );\n\n\t\t\t\t\t\tpushPoint( _vector4, object, camera );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( geometry instanceof THREE.BufferGeometry ) {\n\n\t\t\t\t\tvar attributes = geometry.attributes;\n\n\t\t\t\t\tif ( attributes.position !== undefined ) {\n\n\t\t\t\t\t\tvar positions = attributes.position.array;\n\n\t\t\t\t\t\tfor ( var i = 0, l = positions.length; i < l; i += 3 ) {\n\n\t\t\t\t\t\t\t_vector4.set( positions[ i ], positions[ i + 1 ], positions[ i + 2 ], 1 );\n\t\t\t\t\t\t\t_vector4.applyMatrix4( _modelViewProjectionMatrix );\n\n\t\t\t\t\t\t\tpushPoint( _vector4, object, camera );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t} else if ( object instanceof THREE.Sprite ) {\n\n\t\t\t\t_vector4.set( _modelMatrix.elements[ 12 ], _modelMatrix.elements[ 13 ], _modelMatrix.elements[ 14 ], 1 );\n\t\t\t\t_vector4.applyMatrix4( _viewProjectionMatrix );\n\n\t\t\t\tpushPoint( _vector4, object, camera );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( sortElements === true ) {\n\n\t\t\t_renderData.elements.sort( painterSort );\n\n\t\t}\n\n\t\treturn _renderData;\n\n\t};\n\n\tfunction pushPoint( _vector4, object, camera ) {\n\n\t\tvar invW = 1 / _vector4.w;\n\n\t\t_vector4.z *= invW;\n\n\t\tif ( _vector4.z >= - 1 && _vector4.z <= 1 ) {\n\n\t\t\t_sprite = getNextSpriteInPool();\n\t\t\t_sprite.id = object.id;\n\t\t\t_sprite.x = _vector4.x * invW;\n\t\t\t_sprite.y = _vector4.y * invW;\n\t\t\t_sprite.z = _vector4.z;\n\t\t\t_sprite.renderOrder = object.renderOrder;\n\t\t\t_sprite.object = object;\n\n\t\t\t_sprite.rotation = object.rotation;\n\n\t\t\t_sprite.scale.x = object.scale.x * Math.abs( _sprite.x - ( _vector4.x + camera.projectionMatrix.elements[ 0 ] ) / ( _vector4.w + camera.projectionMatrix.elements[ 12 ] ) );\n\t\t\t_sprite.scale.y = object.scale.y * Math.abs( _sprite.y - ( _vector4.y + camera.projectionMatrix.elements[ 5 ] ) / ( _vector4.w + camera.projectionMatrix.elements[ 13 ] ) );\n\n\t\t\t_sprite.material = object.material;\n\n\t\t\t_renderData.elements.push( _sprite );\n\n\t\t}\n\n\t}\n\n\t// Pools\n\n\tfunction getNextObjectInPool() {\n\n\t\tif ( _objectCount === _objectPoolLength ) {\n\n\t\t\tvar object = new THREE.RenderableObject();\n\t\t\t_objectPool.push( object );\n\t\t\t_objectPoolLength ++;\n\t\t\t_objectCount ++;\n\t\t\treturn object;\n\n\t\t}\n\n\t\treturn _objectPool[ _objectCount ++ ];\n\n\t}\n\n\tfunction getNextVertexInPool() {\n\n\t\tif ( _vertexCount === _vertexPoolLength ) {\n\n\t\t\tvar vertex = new THREE.RenderableVertex();\n\t\t\t_vertexPool.push( vertex );\n\t\t\t_vertexPoolLength ++;\n\t\t\t_vertexCount ++;\n\t\t\treturn vertex;\n\n\t\t}\n\n\t\treturn _vertexPool[ _vertexCount ++ ];\n\n\t}\n\n\tfunction getNextFaceInPool() {\n\n\t\tif ( _faceCount === _facePoolLength ) {\n\n\t\t\tvar face = new THREE.RenderableFace();\n\t\t\t_facePool.push( face );\n\t\t\t_facePoolLength ++;\n\t\t\t_faceCount ++;\n\t\t\treturn face;\n\n\t\t}\n\n\t\treturn _facePool[ _faceCount ++ ];\n\n\n\t}\n\n\tfunction getNextLineInPool() {\n\n\t\tif ( _lineCount === _linePoolLength ) {\n\n\t\t\tvar line = new THREE.RenderableLine();\n\t\t\t_linePool.push( line );\n\t\t\t_linePoolLength ++;\n\t\t\t_lineCount ++;\n\t\t\treturn line;\n\n\t\t}\n\n\t\treturn _linePool[ _lineCount ++ ];\n\n\t}\n\n\tfunction getNextSpriteInPool() {\n\n\t\tif ( _spriteCount === _spritePoolLength ) {\n\n\t\t\tvar sprite = new THREE.RenderableSprite();\n\t\t\t_spritePool.push( sprite );\n\t\t\t_spritePoolLength ++;\n\t\t\t_spriteCount ++;\n\t\t\treturn sprite;\n\n\t\t}\n\n\t\treturn _spritePool[ _spriteCount ++ ];\n\n\t}\n\n\t//\n\n\tfunction painterSort( a, b ) {\n\n\t\tif ( a.renderOrder !== b.renderOrder ) {\n\n\t\t\treturn a.renderOrder - b.renderOrder;\n\n\t\t} else if ( a.z !== b.z ) {\n\n\t\t\treturn b.z - a.z;\n\n\t\t} else if ( a.id !== b.id ) {\n\n\t\t\treturn a.id - b.id;\n\n\t\t} else {\n\n\t\t\treturn 0;\n\n\t\t}\n\n\t}\n\n\tfunction clipLine( s1, s2 ) {\n\n\t\tvar alpha1 = 0, alpha2 = 1,\n\n\t\t// Calculate the boundary coordinate of each vertex for the near and far clip planes,\n\t\t// Z = -1 and Z = +1, respectively.\n\n\t\t\tbc1near = s1.z + s1.w,\n\t\t\tbc2near = s2.z + s2.w,\n\t\t\tbc1far = - s1.z + s1.w,\n\t\t\tbc2far = - s2.z + s2.w;\n\n\t\tif ( bc1near >= 0 && bc2near >= 0 && bc1far >= 0 && bc2far >= 0 ) {\n\n\t\t\t// Both vertices lie entirely within all clip planes.\n\t\t\treturn true;\n\n\t\t} else if ( ( bc1near < 0 && bc2near < 0 ) || ( bc1far < 0 && bc2far < 0 ) ) {\n\n\t\t\t// Both vertices lie entirely outside one of the clip planes.\n\t\t\treturn false;\n\n\t\t} else {\n\n\t\t\t// The line segment spans at least one clip plane.\n\n\t\t\tif ( bc1near < 0 ) {\n\n\t\t\t\t// v1 lies outside the near plane, v2 inside\n\t\t\t\talpha1 = Math.max( alpha1, bc1near / ( bc1near - bc2near ) );\n\n\t\t\t} else if ( bc2near < 0 ) {\n\n\t\t\t\t// v2 lies outside the near plane, v1 inside\n\t\t\t\talpha2 = Math.min( alpha2, bc1near / ( bc1near - bc2near ) );\n\n\t\t\t}\n\n\t\t\tif ( bc1far < 0 ) {\n\n\t\t\t\t// v1 lies outside the far plane, v2 inside\n\t\t\t\talpha1 = Math.max( alpha1, bc1far / ( bc1far - bc2far ) );\n\n\t\t\t} else if ( bc2far < 0 ) {\n\n\t\t\t\t// v2 lies outside the far plane, v2 inside\n\t\t\t\talpha2 = Math.min( alpha2, bc1far / ( bc1far - bc2far ) );\n\n\t\t\t}\n\n\t\t\tif ( alpha2 < alpha1 ) {\n\n\t\t\t\t// The line segment spans two boundaries, but is outside both of them.\n\t\t\t\t// (This can't happen when we're only clipping against just near/far but good\n\t\t\t\t//  to leave the check here for future usage if other clip planes are added.)\n\t\t\t\treturn false;\n\n\t\t\t} else {\n\n\t\t\t\t// Update the s1 and s2 vertices to match the clipped line segment.\n\t\t\t\ts1.lerp( s2, alpha1 );\n\t\t\t\ts2.lerp( s1, 1 - alpha2 );\n\n\t\t\t\treturn true;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n};\n"]}